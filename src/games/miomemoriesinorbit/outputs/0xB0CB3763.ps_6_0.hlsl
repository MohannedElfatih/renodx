#include "../shared.h"

struct Lod_params {
  struct Lod_brush_params {
    float4 brush_uv[4];
    float base_radius;
    float radius_variation;
    float radius_random;
    float blur;
    float alpha;
    float stretch;
  } brushes;
  struct Lod_noise_params {
    float chaos;
    float freq;
    float brightness;
    float saturation;
    float hue;
  } noise;
  struct Lod_outlines_params {
    float2 thickness;
    float2 softness;
    float2 displacement;
    float2 attenuation;
    float lighting_threshold;
    float lighting_threshold_softness;
    float2 lighting_dark;
    float2 lighting_bright;
    float2 discretion;
    float2 alpha;
  } outlines;
};

struct Frame_constants {
  float3 cam_world_pos;
  float time;
  float2 inv_near_dim;
  float proj_scale;
  uint flags;
  float2 half_vp_dim;
  int2 vp_dim;
  float2 vp_texel_size;
  int2 mouse_pos;
  int2 inspected_pix;
  int2 hi_z_0_dim;
  int supersampling;
  int debug_patches;
  int use_patches;
  int emissive;
  float3 target;
  uint frame_number;
  uint shot_frame_number;
  float dt;
  float4 view_to_world[4];
  float4 world_to_view[4];
  float4 view_ndc[4];
  float4 world_ndc[4];
  float4 prev_world_ndc[4];
  float4 ndc_world[4];
  float4 ndc_to_prev_ndc[4];
  float4 prev_ndc_to_ndc[4];
  float4 view_world_z0;
  float4 pix_to_fog_eq;
  float3 mio_view;
  float3 mio_hair_outline_color;
  float mio_foliage_velocity;
  int show_wireframe;
  int ao;
  int glitch;
  int no_vertex_color;
  float paper_mult;
  int hatching;
  int mio_halo;
  int vol_temporal;
  int heart_attack_active;
  int heart_attack_secondary_target;
  int triangular_dissolve_enabled;
  int color_correct;
  float starfield_effect_amount;
  float starfield_fade_amount;
  float3 starfield_center_view;
  float starfield_glow_amount;
  float starfield_pulse_t;
  float death_anim_t;
  float3 game_plane_world_origin;
  float3 game_plane_world_normal;
  float3 game_plane_world_u;
  float3 game_plane_world_v;
  float4 game_plane_transform[4];
  float4 hatching_xf[4];
  float4 paper_xf[4];
  float2 game_plane_blend;
  float heart_attack_t;
  float heart_attack_duration;
  float heart_attack_pulse;
  float heart_attack_outline_distance;
  float heart_attack_dissolve_distance;
  float3 heart_attack_dissolve_color;
  float heart_attack_dissolve_base;
  float heart_attack_dissolve_mult;
  float3 heart_attack_dissolve_world_center;
  float heart_attack_vertical_dissolve;
  float triangular_dissolve_base_amount;
  float triangular_dissolve_amount;
  float flashback_lut;
  float evil_mio;
  float dead_mio;
  float godlike_mio;
  float khlia_pulse_t;
  float khlia__pulse_t;
  float khlia_pulse_period;
  float3 khlia_world_pos;
  float skydome_rotation_offset;
  float hatch_ambiant_mul;
  float hatch_ambiant_add;
  float glitch_scale;
  uint max_contours;
  uint max_contour_loops;
  int death_screen;
  float death_screen_t;
  int poetic_death_screen;
  float poetic_death_screen_t;
  float tremor_pulse_t;
  int invert;
  float surface_fade;
  struct Postprocess_params {
    struct AO_params {
      float3 color;
      float intensity;
    } ao;
    struct Fog_params {
      float bloom_factor;
      float space;
      float outline_density;
      float outline_attenuation;
    } fog;
    struct Ambient_light_params {
      int undercoat_grad;
      float3 color;
      float intensity;
      float gameplay_intensity;
      float gameplay_width;
      float directional_intensity;
      float directional_shadows;
      float undercoat_noise_freq;
      float undercoat_noise_amplitude;
      float undercoat_noise_threshold;
      float undercoating;
    } ambient_light;
    struct Vignette_params {
      float intensity;
      float rounded;
      float3 color;
      float golden_intensity;
      float golden_color;
    } vignette;
    struct Bloom_params {
      float intensity;
      float threshold_low;
      float threshold_high;
    } bloom;
    struct Mio_params {
      float light_intensity;
      float light_radius;
      float3 light_color;
      float spec_intensity;
      float3 halo_color;
      float halo_intensity;
    } mio;
    struct Particles_params {
      uint count;
      float cam_near;
      float cam_far;
      float fadeoff_near;
      float2 lifetime;
      float fadein_duration;
      float fadeoff_duration;
      float2 alpha;
      float2 scale;
      float2 speed;
      int gradient;
      float circle_attenuation;
    } particles;
    struct Chroma_aberration_params {
      float intensity;
    } chroma_aberration;
    struct Fade_params {
      float intensity;
      float3 color;
    } fade;
    struct Dof_params {
      float plane_01;
      float plane_01_softness;
      float plane_12;
      float plane_12_softness;
      float foreground;
      float foreground_softness;
    } dof;
    Lod_params lod_foreground;
    Lod_params lod_game;
    Lod_params lod_midground;
    Lod_params lod_background;
  } params;
};


Texture2D<float4> tex : register(t0);

Texture2D<float> depth_tex : register(t1);

Texture2D<float2> distortion : register(t4);

Texture2D<float> paper_tex : register(t5);

Texture2D<float3> bloom_tex : register(t7);

Texture2D<float3> color_correct_lut : register(t8);

cbuffer frame_consts : register(b0) {
  Frame_constants frame_consts : packoffset(c000.x);
};

SamplerState sampler_nearest : register(s0);

SamplerState sampler_bilinear : register(s1);

SamplerState sampler_bilinear_wrap : register(s2);

float4 main(
  noperspective float4 SV_Position : SV_Position,
  linear float2 O_Uv : O_Uv
) : SV_Target {
  float4 SV_Target;
  float _16 = float((int)(frame_consts.vp_dim.x));
  float _17 = float((int)(frame_consts.vp_dim.y));
  float2 _18 = distortion.SampleLevel(sampler_nearest, float2(O_Uv.x, O_Uv.y), 0.0f);
  float _21 = _17 / _16;
  float _26 = saturate((_18.x * _21) + O_Uv.x);
  float _27 = saturate((_18.y * _21) + O_Uv.y);
  float4 _28 = tex.SampleLevel(sampler_nearest, float2(_26, _27), 0.0f);
  float3 _32 = bloom_tex.SampleLevel(sampler_bilinear, float2(_26, _27), 0.0f);
  float _47 = max((((1.0f - (_28.y * 0.7152000069618225f)) - (_28.x * 0.2125999927520752f)) - (_28.z * 0.0722000002861023f)), 0.0010000000474974513f);
  float _51 = (_28.x / _47) + (frame_consts.params.bloom.intensity * _32.x);
  float _52 = (_28.y / _47) + (frame_consts.params.bloom.intensity * _32.y);
  float _53 = (_28.z / _47) + (frame_consts.params.bloom.intensity * _32.z);
  float _59 = (((_51 * 0.2125999927520752f) + 1.0f) + (_52 * 0.7152000069618225f)) + (_53 * 0.0722000002861023f);
  float _63 = saturate(_51 / _59);
  float _64 = saturate(_52 / _59);
  float _65 = saturate(_53 / _59);
  uint2 _66; color_correct_lut.GetDimensions(_66.x, _66.y);
  float _79;
  float _90;
  float _101;
  if (!(!(_63 <= 0.0031308000907301903f))) {
    _79 = (_63 * 12.920000076293945f);
  } else {
    _79 = (((pow(_63, 0.4166666567325592f)) * 1.0549999475479126f) + -0.054999999701976776f);
  }
  if (!(!(_64 <= 0.0031308000907301903f))) {
    _90 = (_64 * 12.920000076293945f);
  } else {
    _90 = (((pow(_64, 0.4166666567325592f)) * 1.0549999475479126f) + -0.054999999701976776f);
  }
  if (!(!(_65 <= 0.0031308000907301903f))) {
    _101 = (_65 * 12.920000076293945f);
  } else {
    _101 = (((pow(_65, 0.4166666567325592f)) * 1.0549999475479126f) + -0.054999999701976776f);
  }
  float _104 = float((uint)(_66.y + -1u));
  float _107 = _101 * _104;
  float _108 = frac(_107);
  float _110 = float((uint)_66.y);
  float _112 = (_79 * _104) + 0.5f;
  float _115 = float((uint)_66.x);
  float _117 = (lerp(_90, 1.0f, _104)) / _110;
  float3 _118 = color_correct_lut.SampleLevel(sampler_bilinear, float2((((ceil(_107) * _110) + _112) / _115), _117), 0.0f);
  float3 _126 = color_correct_lut.SampleLevel(sampler_bilinear, float2((((floor(_107) * _110) + _112) / _115), _117), 0.0f);
  float _136 = ((_118.x - _126.x) * _108) + _126.x;
  float _137 = ((_118.y - _126.y) * _108) + _126.y;
  float _138 = ((_118.z - _126.z) * _108) + _126.z;
  float _144 = depth_tex.SampleLevel(sampler_nearest, float2(_26, _27), 0.0f);
  float _148 = 10000.0f / ((_144.x * 19999.5f) + 0.5f);
  float _153 = (_148 * ((_26 * 2.0f) + -1.0f)) * frame_consts.inv_near_dim.x;
  float _155 = (_148 * (((1.0f - _27) * 2.0f) + -1.0f)) * frame_consts.inv_near_dim.y;
  float _156 = -0.0f - _148;
  float _180 = mad((frame_consts.paper_xf[2].z), _156, mad((frame_consts.paper_xf[1].z), _155, (_153 * (frame_consts.paper_xf[0].z))));
  float _192 = exp2(round(log2(max(5.0f, (-0.0f - (_180 - frame_consts.game_plane_blend.x)))) * 10.0f) * 0.10000000149011612f);
  float _194 = min((1.0f / _192), 0.20000000298023224f);
  float _195 = frame_consts.game_plane_blend.x - _192;
  float _202 = paper_tex.SampleLevel(sampler_bilinear_wrap, float2((((_195 * (mad((frame_consts.paper_xf[2].x), _156, mad((frame_consts.paper_xf[1].x), _155, (_153 * (frame_consts.paper_xf[0].x)))) / _180)) + (frame_consts.paper_xf[3].x)) * _194), (((_195 * (mad((frame_consts.paper_xf[2].y), _156, mad((frame_consts.paper_xf[1].y), _155, (_153 * (frame_consts.paper_xf[0].y)))) / _180)) + (frame_consts.paper_xf[3].y)) * _194)), 0.0f);
  float _207 = (1.0f - _202.x) * frame_consts.paper_mult;
  float _222 = _16 / _17;
  float _234 = exp2(log2(saturate((frame_consts.params.vignette.intensity * abs(_26 + -0.5f)) * (((_222 + -1.0f) * frame_consts.params.vignette.rounded) + 1.0f))) * 5.0f);
  float _235 = exp2(log2(saturate(frame_consts.params.vignette.intensity * abs(_27 + -0.5f))) * 5.0f);
  float _241 = exp2(log2(saturate(1.0f - dot(float2(_234, _235), float2(_234, _235)))) * 6.0f);
  float _246 = 1.0f - _241;
  float _248 = 1.0f - (_246 * 0.8500000238418579f);
  float _255 = (_248 * ((_136 - (_207 * _136)) - frame_consts.params.vignette.color.x)) + frame_consts.params.vignette.color.x;
  float _256 = (_248 * ((_137 - (_207 * _137)) - frame_consts.params.vignette.color.y)) + frame_consts.params.vignette.color.y;
  float _257 = (_248 * ((_138 - (_207 * _138)) - frame_consts.params.vignette.color.z)) + frame_consts.params.vignette.color.z;
  float _261 = _26 * _16;
  float _262 = _27 * _17;
  float _263 = _262 + _261;
  float _269 = frac(_263 * 0.0033333334140479565f) + -0.5f;
  float _270 = frac((_262 - _261) * 0.0033333334140479565f) + -0.5f;
  float _276 = saturate(sqrt((_270 * _270) + (_269 * _269)) * 2.0f);
  float _287 = saturate((sin((_263 * 0.01666666753590107f) - (frame_consts.time * 0.8500000238418579f)) * 1.2500001192092896f) + -0.25000008940696716f);
  float _292 = ((_287 * _287) * 0.2199999988079071f) * (3.0f - (_287 * 2.0f));
  float _293 = _292 + 0.9777389168739319f;
  float _294 = ((_276 * 0.13274884223937988f) + 0.7175776362419128f) + _292;
  float _295 = ((_276 * 0.3335757553577423f) + 0.30871906876564026f) + _292;
  float _300 = (_26 * 1080.0f) * _222;
  float _301 = _27 * 1080.0f;
  float _302 = _300 * 0.04444444552063942f;
  float _303 = _27 * 27.712812423706055f;
  float _305 = ceil(_302 - _303);
  float _308 = floor(_27 * 55.42562484741211f) + 1.0f;
  float _311 = ceil((-0.0f - _303) - _302);
  float _313 = (_308 + _305) + _311;
  float _315 = (_313 * 22.5f) + -33.75f;
  float _316 = _305 - _311;
  float _318 = _316 * 11.25f;
  float _324 = (((_308 * 0.5773502588272095f) - (_305 * 0.28867512941360474f)) - (_311 * 0.28867512941360474f)) * 22.5f;
  float _327 = _315 + _318;
  float _328 = _324 + (19.485570907592773f - (_313 * 12.990381240844727f));
  float _331 = ((_313 * 25.980762481689453f) + -38.97114181518555f) + _324;
  float _332 = _318 - _315;
  float _333 = _327 - _300;
  float _334 = _328 - _301;
  float _337 = _318 - _300;
  float _338 = _331 - _301;
  float _343 = _334 * _334;
  float _350 = _332 - _300;
  float _354 = _328 * 2.5f;
  float _355 = frame_consts.time * 1.5f;
  float _359 = _328 * 0.004444444552063942f;
  float _360 = frame_consts.time * 0.15000000596046448f;
  float _361 = (_327 * 0.04444444552063942f) - _360;
  float _362 = _359 - _360;
  float _363 = frame_consts.time * 0.02500000037252903f;
  float _364 = dot(float3(_361, _362, _363), float3(0.3333333432674408f, 0.3333333432674408f, 0.3333333432674408f));
  float _368 = floor(_364 + _361);
  float _369 = floor(_364 + _362);
  float _370 = floor(_364 + _363);
  float _374 = dot(float3(_368, _369, _370), float3(0.1666666716337204f, 0.1666666716337204f, 0.1666666716337204f));
  float _375 = _374 + (_361 - _368);
  float _376 = _374 + (_362 - _369);
  float _377 = (_363 - _370) + _374;
  float _381 = select((_375 < _376), 0.0f, 1.0f);
  float _382 = select((_376 < _377), 0.0f, 1.0f);
  float _383 = select((_377 < _375), 0.0f, 1.0f);
  float _384 = 1.0f - _381;
  float _385 = 1.0f - _382;
  float _386 = 1.0f - _383;
  float _387 = min(_381, _386);
  float _388 = min(_382, _384);
  float _389 = min(_383, _385);
  float _390 = max(_381, _386);
  float _391 = max(_382, _384);
  float _392 = max(_383, _385);
  float _396 = (_375 - _387) + 0.1666666716337204f;
  float _397 = (_376 - _388) + 0.1666666716337204f;
  float _398 = (_377 - _389) + 0.1666666716337204f;
  float _402 = (_375 - _390) + 0.3333333432674408f;
  float _403 = (_376 - _391) + 0.3333333432674408f;
  float _404 = (_377 - _392) + 0.3333333432674408f;
  float _405 = _375 + -0.5f;
  float _406 = _376 + -0.5f;
  float _407 = _377 + -0.5f;
  float _417 = _368 - (floor(_368 * 0.0034602077212184668f) * 289.0f);
  float _418 = _369 - (floor(_369 * 0.0034602077212184668f) * 289.0f);
  float _419 = _370 - (floor(_370 * 0.0034602077212184668f) * 289.0f);
  float _420 = _419 + _389;
  float _421 = _419 + _392;
  float _422 = _419 + 1.0f;
  float _431 = ((_419 * 34.0f) + 1.0f) * _419;
  float _432 = ((_420 * 34.0f) + 1.0f) * _420;
  float _433 = ((_421 * 34.0f) + 1.0f) * _421;
  float _434 = ((_422 * 34.0f) + 1.0f) * _422;
  float _448 = (_431 - (floor(_431 * 0.0034602077212184668f) * 289.0f)) + _418;
  float _451 = ((_418 + _388) - (floor(_432 * 0.0034602077212184668f) * 289.0f)) + _432;
  float _454 = ((_418 + _391) - (floor(_433 * 0.0034602077212184668f) * 289.0f)) + _433;
  float _457 = ((_418 + 1.0f) - (floor(_434 * 0.0034602077212184668f) * 289.0f)) + _434;
  float _466 = ((_448 * 34.0f) + 1.0f) * _448;
  float _467 = ((_451 * 34.0f) + 1.0f) * _451;
  float _468 = ((_454 * 34.0f) + 1.0f) * _454;
  float _469 = ((_457 * 34.0f) + 1.0f) * _457;
  float _483 = (_466 - (floor(_466 * 0.0034602077212184668f) * 289.0f)) + _417;
  float _486 = ((_417 + _387) - (floor(_467 * 0.0034602077212184668f) * 289.0f)) + _467;
  float _489 = ((_417 + _390) - (floor(_468 * 0.0034602077212184668f) * 289.0f)) + _468;
  float _492 = ((_417 + 1.0f) - (floor(_469 * 0.0034602077212184668f) * 289.0f)) + _469;
  float _501 = ((_483 * 34.0f) + 1.0f) * _483;
  float _502 = ((_486 * 34.0f) + 1.0f) * _486;
  float _503 = ((_489 * 34.0f) + 1.0f) * _489;
  float _504 = ((_492 * 34.0f) + 1.0f) * _492;
  float _517 = _501 - (floor(_501 * 0.0034602077212184668f) * 289.0f);
  float _518 = _502 - (floor(_502 * 0.0034602077212184668f) * 289.0f);
  float _519 = _503 - (floor(_503 * 0.0034602077212184668f) * 289.0f);
  float _520 = _504 - (floor(_504 * 0.0034602077212184668f) * 289.0f);
  float _533 = _517 - (floor(_517 * 0.020408164709806442f) * 49.0f);
  float _534 = _518 - (floor(_518 * 0.020408164709806442f) * 49.0f);
  float _535 = _519 - (floor(_519 * 0.020408164709806442f) * 49.0f);
  float _536 = _520 - (floor(_520 * 0.020408164709806442f) * 49.0f);
  float _541 = floor(_533 * 0.1428571492433548f);
  float _542 = floor(_534 * 0.1428571492433548f);
  float _543 = floor(_535 * 0.1428571492433548f);
  float _544 = floor(_536 * 0.1428571492433548f);
  float _561 = (_541 * 0.2857142984867096f) + -0.9285714030265808f;
  float _562 = (_542 * 0.2857142984867096f) + -0.9285714030265808f;
  float _563 = (_543 * 0.2857142984867096f) + -0.9285714030265808f;
  float _564 = (_544 * 0.2857142984867096f) + -0.9285714030265808f;
  float _569 = (floor(_533 - (_541 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _570 = (floor(_534 - (_542 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _571 = (floor(_535 - (_543 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _572 = (floor(_536 - (_544 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _585 = (1.0f - abs(_561)) - abs(_569);
  float _586 = (1.0f - abs(_562)) - abs(_570);
  float _587 = (1.0f - abs(_563)) - abs(_571);
  float _588 = (1.0f - abs(_564)) - abs(_572);
  float _617 = select((_585 > 0.0f), -0.0f, -1.0f);
  float _618 = select((_586 > 0.0f), -0.0f, -1.0f);
  float _619 = select((_587 > 0.0f), -0.0f, -1.0f);
  float _620 = select((_588 > 0.0f), -0.0f, -1.0f);
  float _625 = (((floor(_561) * 2.0f) + 1.0f) * _617) + _561;
  float _626 = (((floor(_569) * 2.0f) + 1.0f) * _617) + _569;
  float _627 = (((floor(_562) * 2.0f) + 1.0f) * _618) + _562;
  float _628 = (((floor(_570) * 2.0f) + 1.0f) * _618) + _570;
  float _633 = (((floor(_563) * 2.0f) + 1.0f) * _619) + _563;
  float _634 = (((floor(_571) * 2.0f) + 1.0f) * _619) + _571;
  float _635 = (((floor(_564) * 2.0f) + 1.0f) * _620) + _564;
  float _636 = (((floor(_572) * 2.0f) + 1.0f) * _620) + _572;
  float _645 = 1.7928400039672852f - (dot(float3(_625, _626, _585), float3(_625, _626, _585)) * 0.8537350296974182f);
  float _646 = 1.7928400039672852f - (dot(float3(_627, _628, _586), float3(_627, _628, _586)) * 0.8537350296974182f);
  float _647 = 1.7928400039672852f - (dot(float3(_633, _634, _587), float3(_633, _634, _587)) * 0.8537350296974182f);
  float _648 = 1.7928400039672852f - (dot(float3(_635, _636, _588), float3(_635, _636, _588)) * 0.8537350296974182f);
  float _669 = max((0.6000000238418579f - dot(float3(_375, _376, _377), float3(_375, _376, _377))), 0.0f);
  float _670 = max((0.6000000238418579f - dot(float3(_396, _397, _398), float3(_396, _397, _398))), 0.0f);
  float _671 = max((0.6000000238418579f - dot(float3(_402, _403, _404), float3(_402, _403, _404))), 0.0f);
  float _672 = max((0.6000000238418579f - dot(float3(_405, _406, _407), float3(_405, _406, _407))), 0.0f);
  float _673 = _669 * _669;
  float _674 = _670 * _670;
  float _675 = _671 * _671;
  float _676 = _672 * _672;
  float _691 = saturate((((sin(_354 - _355) * 0.15000000596046448f) + 0.050000011920928955f) + (dot(float4((_673 * _673), (_674 * _674), (_675 * _675), (_676 * _676)), float4(dot(float3((_645 * _625), (_645 * _626), (_645 * _585)), float3(_375, _376, _377)), dot(float3((_646 * _627), (_646 * _628), (_646 * _586)), float3(_396, _397, _398)), dot(float3((_647 * _633), (_647 * _634), (_647 * _587)), float3(_402, _403, _404)), dot(float3((_648 * _635), (_648 * _636), (_648 * _588)), float3(_405, _406, _407)))) * 21.0f)) * 4.0f);
  float _695 = (_691 * _691) * (3.0f - (_691 * 2.0f));
  float _697 = (_695 * 0.6499999761581421f) + 0.3499999940395355f;
  float _702 = (_316 * 0.5f) - _360;
  float _703 = (_331 * 0.004444444552063942f) - _360;
  float _704 = dot(float3(_702, _703, _363), float3(0.3333333432674408f, 0.3333333432674408f, 0.3333333432674408f));
  float _708 = floor(_704 + _702);
  float _709 = floor(_704 + _703);
  float _710 = floor(_704 + _363);
  float _714 = dot(float3(_708, _709, _710), float3(0.1666666716337204f, 0.1666666716337204f, 0.1666666716337204f));
  float _715 = _714 + (_702 - _708);
  float _716 = _714 + (_703 - _709);
  float _717 = (_363 - _710) + _714;
  float _721 = select((_715 < _716), 0.0f, 1.0f);
  float _722 = select((_716 < _717), 0.0f, 1.0f);
  float _723 = select((_717 < _715), 0.0f, 1.0f);
  float _724 = 1.0f - _721;
  float _725 = 1.0f - _722;
  float _726 = 1.0f - _723;
  float _727 = min(_721, _726);
  float _728 = min(_722, _724);
  float _729 = min(_723, _725);
  float _730 = max(_721, _726);
  float _731 = max(_722, _724);
  float _732 = max(_723, _725);
  float _736 = (_715 - _727) + 0.1666666716337204f;
  float _737 = (_716 - _728) + 0.1666666716337204f;
  float _738 = (_717 - _729) + 0.1666666716337204f;
  float _742 = (_715 - _730) + 0.3333333432674408f;
  float _743 = (_716 - _731) + 0.3333333432674408f;
  float _744 = (_717 - _732) + 0.3333333432674408f;
  float _745 = _715 + -0.5f;
  float _746 = _716 + -0.5f;
  float _747 = _717 + -0.5f;
  float _757 = _708 - (floor(_708 * 0.0034602077212184668f) * 289.0f);
  float _758 = _709 - (floor(_709 * 0.0034602077212184668f) * 289.0f);
  float _759 = _710 - (floor(_710 * 0.0034602077212184668f) * 289.0f);
  float _760 = _759 + _729;
  float _761 = _759 + _732;
  float _762 = _759 + 1.0f;
  float _771 = ((_759 * 34.0f) + 1.0f) * _759;
  float _772 = ((_760 * 34.0f) + 1.0f) * _760;
  float _773 = ((_761 * 34.0f) + 1.0f) * _761;
  float _774 = ((_762 * 34.0f) + 1.0f) * _762;
  float _788 = (_771 - (floor(_771 * 0.0034602077212184668f) * 289.0f)) + _758;
  float _791 = ((_758 + _728) - (floor(_772 * 0.0034602077212184668f) * 289.0f)) + _772;
  float _794 = ((_758 + _731) - (floor(_773 * 0.0034602077212184668f) * 289.0f)) + _773;
  float _797 = ((_758 + 1.0f) - (floor(_774 * 0.0034602077212184668f) * 289.0f)) + _774;
  float _806 = ((_788 * 34.0f) + 1.0f) * _788;
  float _807 = ((_791 * 34.0f) + 1.0f) * _791;
  float _808 = ((_794 * 34.0f) + 1.0f) * _794;
  float _809 = ((_797 * 34.0f) + 1.0f) * _797;
  float _823 = (_806 - (floor(_806 * 0.0034602077212184668f) * 289.0f)) + _757;
  float _826 = ((_757 + _727) - (floor(_807 * 0.0034602077212184668f) * 289.0f)) + _807;
  float _829 = ((_757 + _730) - (floor(_808 * 0.0034602077212184668f) * 289.0f)) + _808;
  float _832 = ((_757 + 1.0f) - (floor(_809 * 0.0034602077212184668f) * 289.0f)) + _809;
  float _841 = ((_823 * 34.0f) + 1.0f) * _823;
  float _842 = ((_826 * 34.0f) + 1.0f) * _826;
  float _843 = ((_829 * 34.0f) + 1.0f) * _829;
  float _844 = ((_832 * 34.0f) + 1.0f) * _832;
  float _857 = _841 - (floor(_841 * 0.0034602077212184668f) * 289.0f);
  float _858 = _842 - (floor(_842 * 0.0034602077212184668f) * 289.0f);
  float _859 = _843 - (floor(_843 * 0.0034602077212184668f) * 289.0f);
  float _860 = _844 - (floor(_844 * 0.0034602077212184668f) * 289.0f);
  float _873 = _857 - (floor(_857 * 0.020408164709806442f) * 49.0f);
  float _874 = _858 - (floor(_858 * 0.020408164709806442f) * 49.0f);
  float _875 = _859 - (floor(_859 * 0.020408164709806442f) * 49.0f);
  float _876 = _860 - (floor(_860 * 0.020408164709806442f) * 49.0f);
  float _881 = floor(_873 * 0.1428571492433548f);
  float _882 = floor(_874 * 0.1428571492433548f);
  float _883 = floor(_875 * 0.1428571492433548f);
  float _884 = floor(_876 * 0.1428571492433548f);
  float _901 = (_881 * 0.2857142984867096f) + -0.9285714030265808f;
  float _902 = (_882 * 0.2857142984867096f) + -0.9285714030265808f;
  float _903 = (_883 * 0.2857142984867096f) + -0.9285714030265808f;
  float _904 = (_884 * 0.2857142984867096f) + -0.9285714030265808f;
  float _909 = (floor(_873 - (_881 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _910 = (floor(_874 - (_882 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _911 = (floor(_875 - (_883 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _912 = (floor(_876 - (_884 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _925 = (1.0f - abs(_901)) - abs(_909);
  float _926 = (1.0f - abs(_902)) - abs(_910);
  float _927 = (1.0f - abs(_903)) - abs(_911);
  float _928 = (1.0f - abs(_904)) - abs(_912);
  float _957 = select((_925 > 0.0f), -0.0f, -1.0f);
  float _958 = select((_926 > 0.0f), -0.0f, -1.0f);
  float _959 = select((_927 > 0.0f), -0.0f, -1.0f);
  float _960 = select((_928 > 0.0f), -0.0f, -1.0f);
  float _965 = (((floor(_901) * 2.0f) + 1.0f) * _957) + _901;
  float _966 = (((floor(_909) * 2.0f) + 1.0f) * _957) + _909;
  float _967 = (((floor(_902) * 2.0f) + 1.0f) * _958) + _902;
  float _968 = (((floor(_910) * 2.0f) + 1.0f) * _958) + _910;
  float _973 = (((floor(_903) * 2.0f) + 1.0f) * _959) + _903;
  float _974 = (((floor(_911) * 2.0f) + 1.0f) * _959) + _911;
  float _975 = (((floor(_904) * 2.0f) + 1.0f) * _960) + _904;
  float _976 = (((floor(_912) * 2.0f) + 1.0f) * _960) + _912;
  float _985 = 1.7928400039672852f - (dot(float3(_965, _966, _925), float3(_965, _966, _925)) * 0.8537350296974182f);
  float _986 = 1.7928400039672852f - (dot(float3(_967, _968, _926), float3(_967, _968, _926)) * 0.8537350296974182f);
  float _987 = 1.7928400039672852f - (dot(float3(_973, _974, _927), float3(_973, _974, _927)) * 0.8537350296974182f);
  float _988 = 1.7928400039672852f - (dot(float3(_975, _976, _928), float3(_975, _976, _928)) * 0.8537350296974182f);
  float _1009 = max((0.6000000238418579f - dot(float3(_715, _716, _717), float3(_715, _716, _717))), 0.0f);
  float _1010 = max((0.6000000238418579f - dot(float3(_736, _737, _738), float3(_736, _737, _738))), 0.0f);
  float _1011 = max((0.6000000238418579f - dot(float3(_742, _743, _744), float3(_742, _743, _744))), 0.0f);
  float _1012 = max((0.6000000238418579f - dot(float3(_745, _746, _747), float3(_745, _746, _747))), 0.0f);
  float _1013 = _1009 * _1009;
  float _1014 = _1010 * _1010;
  float _1015 = _1011 * _1011;
  float _1016 = _1012 * _1012;
  float _1031 = saturate((((sin((_331 * 2.5f) - _355) * 0.15000000596046448f) + 0.050000011920928955f) + (dot(float4((_1013 * _1013), (_1014 * _1014), (_1015 * _1015), (_1016 * _1016)), float4(dot(float3((_985 * _965), (_985 * _966), (_985 * _925)), float3(_715, _716, _717)), dot(float3((_986 * _967), (_986 * _968), (_986 * _926)), float3(_736, _737, _738)), dot(float3((_987 * _973), (_987 * _974), (_987 * _927)), float3(_742, _743, _744)), dot(float3((_988 * _975), (_988 * _976), (_988 * _928)), float3(_745, _746, _747)))) * 21.0f)) * 4.0f);
  float _1035 = (_1031 * _1031) * (3.0f - (_1031 * 2.0f));
  float _1037 = (_1035 * 0.6499999761581421f) + 0.3499999940395355f;
  float _1044 = frame_consts.time * 0.15000000596046448f;
  float _1045 = (_332 * 0.04444444552063942f) - _1044;
  float _1046 = _359 - _1044;
  float _1047 = frame_consts.time * 0.02500000037252903f;
  float _1048 = dot(float3(_1045, _1046, _1047), float3(0.3333333432674408f, 0.3333333432674408f, 0.3333333432674408f));
  float _1052 = floor(_1045 + _1048);
  float _1053 = floor(_1046 + _1048);
  float _1054 = floor(_1047 + _1048);
  float _1058 = dot(float3(_1052, _1053, _1054), float3(0.1666666716337204f, 0.1666666716337204f, 0.1666666716337204f));
  float _1059 = _1058 + (_1045 - _1052);
  float _1060 = _1058 + (_1046 - _1053);
  float _1061 = (_1047 - _1054) + _1058;
  float _1065 = select((_1059 < _1060), 0.0f, 1.0f);
  float _1066 = select((_1060 < _1061), 0.0f, 1.0f);
  float _1067 = select((_1061 < _1059), 0.0f, 1.0f);
  float _1068 = 1.0f - _1065;
  float _1069 = 1.0f - _1066;
  float _1070 = 1.0f - _1067;
  float _1071 = min(_1065, _1070);
  float _1072 = min(_1066, _1068);
  float _1073 = min(_1067, _1069);
  float _1074 = max(_1065, _1070);
  float _1075 = max(_1066, _1068);
  float _1076 = max(_1067, _1069);
  float _1080 = (_1059 - _1071) + 0.1666666716337204f;
  float _1081 = (_1060 - _1072) + 0.1666666716337204f;
  float _1082 = (_1061 - _1073) + 0.1666666716337204f;
  float _1086 = (_1059 - _1074) + 0.3333333432674408f;
  float _1087 = (_1060 - _1075) + 0.3333333432674408f;
  float _1088 = (_1061 - _1076) + 0.3333333432674408f;
  float _1089 = _1059 + -0.5f;
  float _1090 = _1060 + -0.5f;
  float _1091 = _1061 + -0.5f;
  float _1101 = _1052 - (floor(_1052 * 0.0034602077212184668f) * 289.0f);
  float _1102 = _1053 - (floor(_1053 * 0.0034602077212184668f) * 289.0f);
  float _1103 = _1054 - (floor(_1054 * 0.0034602077212184668f) * 289.0f);
  float _1104 = _1103 + _1073;
  float _1105 = _1103 + _1076;
  float _1106 = _1103 + 1.0f;
  float _1115 = ((_1103 * 34.0f) + 1.0f) * _1103;
  float _1116 = ((_1104 * 34.0f) + 1.0f) * _1104;
  float _1117 = ((_1105 * 34.0f) + 1.0f) * _1105;
  float _1118 = ((_1106 * 34.0f) + 1.0f) * _1106;
  float _1132 = (_1115 - (floor(_1115 * 0.0034602077212184668f) * 289.0f)) + _1102;
  float _1135 = ((_1102 + _1072) - (floor(_1116 * 0.0034602077212184668f) * 289.0f)) + _1116;
  float _1138 = ((_1102 + _1075) - (floor(_1117 * 0.0034602077212184668f) * 289.0f)) + _1117;
  float _1141 = ((_1102 + 1.0f) - (floor(_1118 * 0.0034602077212184668f) * 289.0f)) + _1118;
  float _1150 = ((_1132 * 34.0f) + 1.0f) * _1132;
  float _1151 = ((_1135 * 34.0f) + 1.0f) * _1135;
  float _1152 = ((_1138 * 34.0f) + 1.0f) * _1138;
  float _1153 = ((_1141 * 34.0f) + 1.0f) * _1141;
  float _1167 = (_1150 - (floor(_1150 * 0.0034602077212184668f) * 289.0f)) + _1101;
  float _1170 = ((_1101 + _1071) - (floor(_1151 * 0.0034602077212184668f) * 289.0f)) + _1151;
  float _1173 = ((_1101 + _1074) - (floor(_1152 * 0.0034602077212184668f) * 289.0f)) + _1152;
  float _1176 = ((_1101 + 1.0f) - (floor(_1153 * 0.0034602077212184668f) * 289.0f)) + _1153;
  float _1185 = ((_1167 * 34.0f) + 1.0f) * _1167;
  float _1186 = ((_1170 * 34.0f) + 1.0f) * _1170;
  float _1187 = ((_1173 * 34.0f) + 1.0f) * _1173;
  float _1188 = ((_1176 * 34.0f) + 1.0f) * _1176;
  float _1201 = _1185 - (floor(_1185 * 0.0034602077212184668f) * 289.0f);
  float _1202 = _1186 - (floor(_1186 * 0.0034602077212184668f) * 289.0f);
  float _1203 = _1187 - (floor(_1187 * 0.0034602077212184668f) * 289.0f);
  float _1204 = _1188 - (floor(_1188 * 0.0034602077212184668f) * 289.0f);
  float _1217 = _1201 - (floor(_1201 * 0.020408164709806442f) * 49.0f);
  float _1218 = _1202 - (floor(_1202 * 0.020408164709806442f) * 49.0f);
  float _1219 = _1203 - (floor(_1203 * 0.020408164709806442f) * 49.0f);
  float _1220 = _1204 - (floor(_1204 * 0.020408164709806442f) * 49.0f);
  float _1225 = floor(_1217 * 0.1428571492433548f);
  float _1226 = floor(_1218 * 0.1428571492433548f);
  float _1227 = floor(_1219 * 0.1428571492433548f);
  float _1228 = floor(_1220 * 0.1428571492433548f);
  float _1245 = (_1225 * 0.2857142984867096f) + -0.9285714030265808f;
  float _1246 = (_1226 * 0.2857142984867096f) + -0.9285714030265808f;
  float _1247 = (_1227 * 0.2857142984867096f) + -0.9285714030265808f;
  float _1248 = (_1228 * 0.2857142984867096f) + -0.9285714030265808f;
  float _1253 = (floor(_1217 - (_1225 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _1254 = (floor(_1218 - (_1226 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _1255 = (floor(_1219 - (_1227 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _1256 = (floor(_1220 - (_1228 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _1269 = (1.0f - abs(_1245)) - abs(_1253);
  float _1270 = (1.0f - abs(_1246)) - abs(_1254);
  float _1271 = (1.0f - abs(_1247)) - abs(_1255);
  float _1272 = (1.0f - abs(_1248)) - abs(_1256);
  float _1301 = select((_1269 > 0.0f), -0.0f, -1.0f);
  float _1302 = select((_1270 > 0.0f), -0.0f, -1.0f);
  float _1303 = select((_1271 > 0.0f), -0.0f, -1.0f);
  float _1304 = select((_1272 > 0.0f), -0.0f, -1.0f);
  float _1309 = (((floor(_1245) * 2.0f) + 1.0f) * _1301) + _1245;
  float _1310 = (((floor(_1253) * 2.0f) + 1.0f) * _1301) + _1253;
  float _1311 = (((floor(_1246) * 2.0f) + 1.0f) * _1302) + _1246;
  float _1312 = (((floor(_1254) * 2.0f) + 1.0f) * _1302) + _1254;
  float _1317 = (((floor(_1247) * 2.0f) + 1.0f) * _1303) + _1247;
  float _1318 = (((floor(_1255) * 2.0f) + 1.0f) * _1303) + _1255;
  float _1319 = (((floor(_1248) * 2.0f) + 1.0f) * _1304) + _1248;
  float _1320 = (((floor(_1256) * 2.0f) + 1.0f) * _1304) + _1256;
  float _1329 = 1.7928400039672852f - (dot(float3(_1309, _1310, _1269), float3(_1309, _1310, _1269)) * 0.8537350296974182f);
  float _1330 = 1.7928400039672852f - (dot(float3(_1311, _1312, _1270), float3(_1311, _1312, _1270)) * 0.8537350296974182f);
  float _1331 = 1.7928400039672852f - (dot(float3(_1317, _1318, _1271), float3(_1317, _1318, _1271)) * 0.8537350296974182f);
  float _1332 = 1.7928400039672852f - (dot(float3(_1319, _1320, _1272), float3(_1319, _1320, _1272)) * 0.8537350296974182f);
  float _1353 = max((0.6000000238418579f - dot(float3(_1059, _1060, _1061), float3(_1059, _1060, _1061))), 0.0f);
  float _1354 = max((0.6000000238418579f - dot(float3(_1080, _1081, _1082), float3(_1080, _1081, _1082))), 0.0f);
  float _1355 = max((0.6000000238418579f - dot(float3(_1086, _1087, _1088), float3(_1086, _1087, _1088))), 0.0f);
  float _1356 = max((0.6000000238418579f - dot(float3(_1089, _1090, _1091), float3(_1089, _1090, _1091))), 0.0f);
  float _1357 = _1353 * _1353;
  float _1358 = _1354 * _1354;
  float _1359 = _1355 * _1355;
  float _1360 = _1356 * _1356;
  float _1375 = saturate((((sin(_354 - (frame_consts.time * 1.5f)) * 0.15000000596046448f) + 0.050000011920928955f) + (dot(float4((_1357 * _1357), (_1358 * _1358), (_1359 * _1359), (_1360 * _1360)), float4(dot(float3((_1329 * _1309), (_1329 * _1310), (_1329 * _1269)), float3(_1059, _1060, _1061)), dot(float3((_1330 * _1311), (_1330 * _1312), (_1330 * _1270)), float3(_1080, _1081, _1082)), dot(float3((_1331 * _1317), (_1331 * _1318), (_1331 * _1271)), float3(_1086, _1087, _1088)), dot(float3((_1332 * _1319), (_1332 * _1320), (_1332 * _1272)), float3(_1089, _1090, _1091)))) * 21.0f)) * 4.0f);
  float _1379 = (_1375 * _1375) * (3.0f - (_1375 * 2.0f));
  float _1381 = (_1379 * 0.6499999761581421f) + 0.3499999940395355f;
  float _1403 = saturate(_697);
  float _1404 = saturate(_1037);
  float _1426 = (((_241 * 1.2000000476837158f) * _246) * frame_consts.params.vignette.golden_intensity) * ((((saturate(11.0f - (sqrt((_338 * _338) + (_337 * _337)) / ((_1035 * 0.039000000804662704f) + 0.08100000768899918f))) * _1037) + (saturate(11.0f - (sqrt((_333 * _333) + _343) / ((_695 * 0.039000000804662704f) + 0.08100000768899918f))) * _697)) + (saturate(11.0f - (sqrt((_350 * _350) + _343) / ((_1379 * 0.039000000804662704f) + 0.08100000768899918f))) * _1381)) + (((((saturate(1.0f - (abs(_334) * 0.8333333134651184f)) * _1403) + (saturate(1.0f - (abs(dot(float2(_337, _338), float2(-0.8660253882408142f, 0.5f))) * 0.8333333134651184f)) * _1404)) * saturate(_1381)) + ((_1403 * saturate(1.0f - (abs(dot(float2(_333, _334), float2(0.8660253882408142f, 0.5f))) * 0.8333333134651184f))) * _1404)) * 0.5f));
  SV_Target.x = ((_1426 * ((_293 * _293) - _255)) + _255);
  SV_Target.y = ((_1426 * ((_294 * _294) - _256)) + _256);
  SV_Target.z = ((_1426 * ((_295 * _295) - _257)) + _257);
  if (RENODX_TONE_MAP_TYPE) {
    SV_Target.rgb = renodx::draw::ToneMapPass(_28.rgb, SV_Target.rgb);
  } else {
    SV_Target.rgb = saturate(SV_Target.rgb);
  }
  SV_Target.rgb = renodx::draw::RenderIntermediatePass(SV_Target.rgb);

  SV_Target.w = 1.0f;
  return SV_Target;
}
