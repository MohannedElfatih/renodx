#include "../shared.h"

struct Lod_params {
  struct Lod_brush_params {
    float4 brush_uv[4];
    float base_radius;
    float radius_variation;
    float radius_random;
    float blur;
    float alpha;
    float stretch;
  } brushes;
  struct Lod_noise_params {
    float chaos;
    float freq;
    float brightness;
    float saturation;
    float hue;
  } noise;
  struct Lod_outlines_params {
    float2 thickness;
    float2 softness;
    float2 displacement;
    float2 attenuation;
    float lighting_threshold;
    float lighting_threshold_softness;
    float2 lighting_dark;
    float2 lighting_bright;
    float2 discretion;
    float2 alpha;
  } outlines;
};

struct Frame_constants {
  float3 cam_world_pos;
  float time;
  float2 inv_near_dim;
  float proj_scale;
  uint flags;
  float2 half_vp_dim;
  int2 vp_dim;
  float2 vp_texel_size;
  int2 mouse_pos;
  int2 inspected_pix;
  int2 hi_z_0_dim;
  int supersampling;
  int debug_patches;
  int use_patches;
  int emissive;
  float3 target;
  uint frame_number;
  uint shot_frame_number;
  float dt;
  float4 view_to_world[4];
  float4 world_to_view[4];
  float4 view_ndc[4];
  float4 world_ndc[4];
  float4 prev_world_ndc[4];
  float4 ndc_world[4];
  float4 ndc_to_prev_ndc[4];
  float4 prev_ndc_to_ndc[4];
  float4 view_world_z0;
  float4 pix_to_fog_eq;
  float3 mio_view;
  float3 mio_hair_outline_color;
  float mio_foliage_velocity;
  int show_wireframe;
  int ao;
  int glitch;
  int no_vertex_color;
  float paper_mult;
  int hatching;
  int mio_halo;
  int vol_temporal;
  int heart_attack_active;
  int heart_attack_secondary_target;
  int triangular_dissolve_enabled;
  int color_correct;
  float starfield_effect_amount;
  float starfield_fade_amount;
  float3 starfield_center_view;
  float starfield_glow_amount;
  float starfield_pulse_t;
  float death_anim_t;
  float3 game_plane_world_origin;
  float3 game_plane_world_normal;
  float3 game_plane_world_u;
  float3 game_plane_world_v;
  float4 game_plane_transform[4];
  float4 hatching_xf[4];
  float4 paper_xf[4];
  float2 game_plane_blend;
  float heart_attack_t;
  float heart_attack_duration;
  float heart_attack_pulse;
  float heart_attack_outline_distance;
  float heart_attack_dissolve_distance;
  float3 heart_attack_dissolve_color;
  float heart_attack_dissolve_base;
  float heart_attack_dissolve_mult;
  float3 heart_attack_dissolve_world_center;
  float heart_attack_vertical_dissolve;
  float triangular_dissolve_base_amount;
  float triangular_dissolve_amount;
  float flashback_lut;
  float evil_mio;
  float dead_mio;
  float godlike_mio;
  float khlia_pulse_t;
  float khlia__pulse_t;
  float khlia_pulse_period;
  float3 khlia_world_pos;
  float skydome_rotation_offset;
  float hatch_ambiant_mul;
  float hatch_ambiant_add;
  float glitch_scale;
  uint max_contours;
  uint max_contour_loops;
  int death_screen;
  float death_screen_t;
  int poetic_death_screen;
  float poetic_death_screen_t;
  float tremor_pulse_t;
  int invert;
  float surface_fade;
  struct Postprocess_params {
    struct AO_params {
      float3 color;
      float intensity;
    } ao;
    struct Fog_params {
      float bloom_factor;
      float space;
      float outline_density;
      float outline_attenuation;
    } fog;
    struct Ambient_light_params {
      int undercoat_grad;
      float3 color;
      float intensity;
      float gameplay_intensity;
      float gameplay_width;
      float directional_intensity;
      float directional_shadows;
      float undercoat_noise_freq;
      float undercoat_noise_amplitude;
      float undercoat_noise_threshold;
      float undercoating;
    } ambient_light;
    struct Vignette_params {
      float intensity;
      float rounded;
      float3 color;
      float golden_intensity;
      float golden_color;
    } vignette;
    struct Bloom_params {
      float intensity;
      float threshold_low;
      float threshold_high;
    } bloom;
    struct Mio_params {
      float light_intensity;
      float light_radius;
      float3 light_color;
      float spec_intensity;
      float3 halo_color;
      float halo_intensity;
    } mio;
    struct Particles_params {
      uint count;
      float cam_near;
      float cam_far;
      float fadeoff_near;
      float2 lifetime;
      float fadein_duration;
      float fadeoff_duration;
      float2 alpha;
      float2 scale;
      float2 speed;
      int gradient;
      float circle_attenuation;
    } particles;
    struct Chroma_aberration_params {
      float intensity;
    } chroma_aberration;
    struct Fade_params {
      float intensity;
      float3 color;
    } fade;
    struct Dof_params {
      float plane_01;
      float plane_01_softness;
      float plane_12;
      float plane_12_softness;
      float foreground;
      float foreground_softness;
    } dof;
    Lod_params lod_foreground;
    Lod_params lod_game;
    Lod_params lod_midground;
    Lod_params lod_background;
  } params;
};


Texture2D<float4> tex : register(t0);

Texture2D<float> depth_tex : register(t1);

Texture2D<float2> distortion : register(t4);

Texture2D<float> paper_tex : register(t5);

Texture2D<float3> bloom_tex : register(t7);

Texture2D<float3> color_correct_lut : register(t8);

cbuffer frame_consts : register(b0) {
  Frame_constants frame_consts : packoffset(c000.x);
};

SamplerState sampler_nearest : register(s0);

SamplerState sampler_bilinear : register(s1);

SamplerState sampler_bilinear_wrap : register(s2);

float4 main(
  noperspective float4 SV_Position : SV_Position,
  linear float2 O_Uv : O_Uv
) : SV_Target {
  float4 SV_Target;
  float _16 = float((int)(frame_consts.vp_dim.x));
  float _17 = float((int)(frame_consts.vp_dim.y));
  float2 _18 = distortion.SampleLevel(sampler_nearest, float2(O_Uv.x, O_Uv.y), 0.0f);
  float _21 = _17 / _16;
  float _26 = saturate((_18.x * _21) + O_Uv.x);
  float _27 = saturate((_18.y * _21) + O_Uv.y);
  float4 _28 = tex.SampleLevel(sampler_nearest, float2(_26, _27), 0.0f);
  float3 _32 = bloom_tex.SampleLevel(sampler_bilinear, float2(_26, _27), 0.0f);
  float _47 = max((((1.0f - (_28.y * 0.7152000069618225f)) - (_28.x * 0.2125999927520752f)) - (_28.z * 0.0722000002861023f)), 0.0010000000474974513f);
  float _51 = (_28.x / _47) + (frame_consts.params.bloom.intensity * _32.x);
  float _52 = (_28.y / _47) + (frame_consts.params.bloom.intensity * _32.y);
  float _53 = (_28.z / _47) + (frame_consts.params.bloom.intensity * _32.z);
  float _59 = (((_51 * 0.2125999927520752f) + 1.0f) + (_52 * 0.7152000069618225f)) + (_53 * 0.0722000002861023f);
  float _63 = saturate(_51 / _59);
  float _64 = saturate(_52 / _59);
  float _65 = saturate(_53 / _59);
  uint2 _66; color_correct_lut.GetDimensions(_66.x, _66.y);
  float _79;
  float _90;
  float _101;
  if (!(!(_63 <= 0.0031308000907301903f))) {
    _79 = (_63 * 12.920000076293945f);
  } else {
    _79 = (((pow(_63, 0.4166666567325592f)) * 1.0549999475479126f) + -0.054999999701976776f);
  }
  if (!(!(_64 <= 0.0031308000907301903f))) {
    _90 = (_64 * 12.920000076293945f);
  } else {
    _90 = (((pow(_64, 0.4166666567325592f)) * 1.0549999475479126f) + -0.054999999701976776f);
  }
  if (!(!(_65 <= 0.0031308000907301903f))) {
    _101 = (_65 * 12.920000076293945f);
  } else {
    _101 = (((pow(_65, 0.4166666567325592f)) * 1.0549999475479126f) + -0.054999999701976776f);
  }
  float _104 = float((uint)(_66.y + -1u));
  float _107 = _101 * _104;
  float _108 = frac(_107);
  float _110 = float((uint)_66.y);
  float _112 = (_79 * _104) + 0.5f;
  float _115 = float((uint)_66.x);
  float _117 = (lerp(_90, 1.0f, _104)) / _110;
  float3 _118 = color_correct_lut.SampleLevel(sampler_bilinear, float2((((ceil(_107) * _110) + _112) / _115), _117), 0.0f);
  float3 _126 = color_correct_lut.SampleLevel(sampler_bilinear, float2((((floor(_107) * _110) + _112) / _115), _117), 0.0f);
  float _136 = ((_118.x - _126.x) * _108) + _126.x;
  float _137 = ((_118.y - _126.y) * _108) + _126.y;
  float _138 = ((_118.z - _126.z) * _108) + _126.z;
  float _144 = depth_tex.SampleLevel(sampler_nearest, float2(_26, _27), 0.0f);
  float _148 = 10000.0f / ((_144.x * 19999.5f) + 0.5f);
  float _153 = (_148 * ((_26 * 2.0f) + -1.0f)) * frame_consts.inv_near_dim.x;
  float _155 = (_148 * (((1.0f - _27) * 2.0f) + -1.0f)) * frame_consts.inv_near_dim.y;
  float _156 = -0.0f - _148;
  float _180 = mad((frame_consts.paper_xf[2].z), _156, mad((frame_consts.paper_xf[1].z), _155, (_153 * (frame_consts.paper_xf[0].z))));
  float _181 = mad((frame_consts.paper_xf[2].x), _156, mad((frame_consts.paper_xf[1].x), _155, (_153 * (frame_consts.paper_xf[0].x)))) / _180;
  float _182 = mad((frame_consts.paper_xf[2].y), _156, mad((frame_consts.paper_xf[1].y), _155, (_153 * (frame_consts.paper_xf[0].y)))) / _180;
  float _194 = exp2(round(log2(max(5.0f, (-0.0f - (_180 - frame_consts.game_plane_blend.x)))) * 10.0f) * 0.10000000149011612f);
  float _196 = min((1.0f / _194), 0.20000000298023224f);
  float _197 = frame_consts.game_plane_blend.x - _194;
  float _204 = frame_consts.game_plane_blend.x + 10.0f;
  float _212 = exp2(round(log2(max(5.0f, (-0.0f - (_180 - _204)))) * 10.0f) * 0.10000000149011612f);
  float _214 = min((1.0f / _212), 0.20000000298023224f);
  float _215 = _204 - _212;
  float _222 = paper_tex.SampleLevel(sampler_bilinear_wrap, float2((((_197 * _181) + (frame_consts.paper_xf[3].x)) * _196), (((_197 * _182) + (frame_consts.paper_xf[3].y)) * _196)), 0.0f);
  float _225 = paper_tex.SampleLevel(sampler_bilinear_wrap, float2((((_215 * _181) + (frame_consts.paper_xf[3].x)) * _214), (((_215 * _182) + (frame_consts.paper_xf[3].y)) * _214)), 0.0f);
  float _232 = ((1.0f - (_222.x * (1.0f - frame_consts.game_plane_blend.y))) - (_225.x * frame_consts.game_plane_blend.y)) * frame_consts.paper_mult;
  float _247 = _16 / _17;
  float _259 = exp2(log2(saturate((frame_consts.params.vignette.intensity * abs(_26 + -0.5f)) * (((_247 + -1.0f) * frame_consts.params.vignette.rounded) + 1.0f))) * 5.0f);
  float _260 = exp2(log2(saturate(frame_consts.params.vignette.intensity * abs(_27 + -0.5f))) * 5.0f);
  float _266 = exp2(log2(saturate(1.0f - dot(float2(_259, _260), float2(_259, _260)))) * 6.0f);
  float _271 = 1.0f - _266;
  float _273 = 1.0f - (_271 * 0.8500000238418579f);
  float _280 = (_273 * ((_136 - (_232 * _136)) - frame_consts.params.vignette.color.x)) + frame_consts.params.vignette.color.x;
  float _281 = (_273 * ((_137 - (_232 * _137)) - frame_consts.params.vignette.color.y)) + frame_consts.params.vignette.color.y;
  float _282 = (_273 * ((_138 - (_232 * _138)) - frame_consts.params.vignette.color.z)) + frame_consts.params.vignette.color.z;
  float _286 = _26 * _16;
  float _287 = _27 * _17;
  float _288 = _287 + _286;
  float _294 = frac(_288 * 0.0033333334140479565f) + -0.5f;
  float _295 = frac((_287 - _286) * 0.0033333334140479565f) + -0.5f;
  float _301 = saturate(sqrt((_295 * _295) + (_294 * _294)) * 2.0f);
  float _312 = saturate((sin((_288 * 0.01666666753590107f) - (frame_consts.time * 0.8500000238418579f)) * 1.2500001192092896f) + -0.25000008940696716f);
  float _317 = ((_312 * _312) * 0.2199999988079071f) * (3.0f - (_312 * 2.0f));
  float _318 = _317 + 0.9777389168739319f;
  float _319 = ((_301 * 0.13274884223937988f) + 0.7175776362419128f) + _317;
  float _320 = ((_301 * 0.3335757553577423f) + 0.30871906876564026f) + _317;
  float _325 = (_26 * 1080.0f) * _247;
  float _326 = _27 * 1080.0f;
  float _327 = _325 * 0.04444444552063942f;
  float _328 = _27 * 27.712812423706055f;
  float _330 = ceil(_327 - _328);
  float _333 = floor(_27 * 55.42562484741211f) + 1.0f;
  float _336 = ceil((-0.0f - _328) - _327);
  float _338 = (_333 + _330) + _336;
  float _340 = (_338 * 22.5f) + -33.75f;
  float _341 = _330 - _336;
  float _343 = _341 * 11.25f;
  float _349 = (((_333 * 0.5773502588272095f) - (_330 * 0.28867512941360474f)) - (_336 * 0.28867512941360474f)) * 22.5f;
  float _352 = _340 + _343;
  float _353 = _349 + (19.485570907592773f - (_338 * 12.990381240844727f));
  float _356 = ((_338 * 25.980762481689453f) + -38.97114181518555f) + _349;
  float _357 = _343 - _340;
  float _358 = _352 - _325;
  float _359 = _353 - _326;
  float _362 = _343 - _325;
  float _363 = _356 - _326;
  float _368 = _359 * _359;
  float _375 = _357 - _325;
  float _379 = _353 * 2.5f;
  float _380 = frame_consts.time * 1.5f;
  float _384 = _353 * 0.004444444552063942f;
  float _385 = frame_consts.time * 0.15000000596046448f;
  float _386 = (_352 * 0.04444444552063942f) - _385;
  float _387 = _384 - _385;
  float _388 = frame_consts.time * 0.02500000037252903f;
  float _389 = dot(float3(_386, _387, _388), float3(0.3333333432674408f, 0.3333333432674408f, 0.3333333432674408f));
  float _393 = floor(_389 + _386);
  float _394 = floor(_389 + _387);
  float _395 = floor(_389 + _388);
  float _399 = dot(float3(_393, _394, _395), float3(0.1666666716337204f, 0.1666666716337204f, 0.1666666716337204f));
  float _400 = _399 + (_386 - _393);
  float _401 = _399 + (_387 - _394);
  float _402 = (_388 - _395) + _399;
  float _406 = select((_400 < _401), 0.0f, 1.0f);
  float _407 = select((_401 < _402), 0.0f, 1.0f);
  float _408 = select((_402 < _400), 0.0f, 1.0f);
  float _409 = 1.0f - _406;
  float _410 = 1.0f - _407;
  float _411 = 1.0f - _408;
  float _412 = min(_406, _411);
  float _413 = min(_407, _409);
  float _414 = min(_408, _410);
  float _415 = max(_406, _411);
  float _416 = max(_407, _409);
  float _417 = max(_408, _410);
  float _421 = (_400 - _412) + 0.1666666716337204f;
  float _422 = (_401 - _413) + 0.1666666716337204f;
  float _423 = (_402 - _414) + 0.1666666716337204f;
  float _427 = (_400 - _415) + 0.3333333432674408f;
  float _428 = (_401 - _416) + 0.3333333432674408f;
  float _429 = (_402 - _417) + 0.3333333432674408f;
  float _430 = _400 + -0.5f;
  float _431 = _401 + -0.5f;
  float _432 = _402 + -0.5f;
  float _442 = _393 - (floor(_393 * 0.0034602077212184668f) * 289.0f);
  float _443 = _394 - (floor(_394 * 0.0034602077212184668f) * 289.0f);
  float _444 = _395 - (floor(_395 * 0.0034602077212184668f) * 289.0f);
  float _445 = _444 + _414;
  float _446 = _444 + _417;
  float _447 = _444 + 1.0f;
  float _456 = ((_444 * 34.0f) + 1.0f) * _444;
  float _457 = ((_445 * 34.0f) + 1.0f) * _445;
  float _458 = ((_446 * 34.0f) + 1.0f) * _446;
  float _459 = ((_447 * 34.0f) + 1.0f) * _447;
  float _473 = (_456 - (floor(_456 * 0.0034602077212184668f) * 289.0f)) + _443;
  float _476 = ((_443 + _413) - (floor(_457 * 0.0034602077212184668f) * 289.0f)) + _457;
  float _479 = ((_443 + _416) - (floor(_458 * 0.0034602077212184668f) * 289.0f)) + _458;
  float _482 = ((_443 + 1.0f) - (floor(_459 * 0.0034602077212184668f) * 289.0f)) + _459;
  float _491 = ((_473 * 34.0f) + 1.0f) * _473;
  float _492 = ((_476 * 34.0f) + 1.0f) * _476;
  float _493 = ((_479 * 34.0f) + 1.0f) * _479;
  float _494 = ((_482 * 34.0f) + 1.0f) * _482;
  float _508 = (_491 - (floor(_491 * 0.0034602077212184668f) * 289.0f)) + _442;
  float _511 = ((_442 + _412) - (floor(_492 * 0.0034602077212184668f) * 289.0f)) + _492;
  float _514 = ((_442 + _415) - (floor(_493 * 0.0034602077212184668f) * 289.0f)) + _493;
  float _517 = ((_442 + 1.0f) - (floor(_494 * 0.0034602077212184668f) * 289.0f)) + _494;
  float _526 = ((_508 * 34.0f) + 1.0f) * _508;
  float _527 = ((_511 * 34.0f) + 1.0f) * _511;
  float _528 = ((_514 * 34.0f) + 1.0f) * _514;
  float _529 = ((_517 * 34.0f) + 1.0f) * _517;
  float _542 = _526 - (floor(_526 * 0.0034602077212184668f) * 289.0f);
  float _543 = _527 - (floor(_527 * 0.0034602077212184668f) * 289.0f);
  float _544 = _528 - (floor(_528 * 0.0034602077212184668f) * 289.0f);
  float _545 = _529 - (floor(_529 * 0.0034602077212184668f) * 289.0f);
  float _558 = _542 - (floor(_542 * 0.020408164709806442f) * 49.0f);
  float _559 = _543 - (floor(_543 * 0.020408164709806442f) * 49.0f);
  float _560 = _544 - (floor(_544 * 0.020408164709806442f) * 49.0f);
  float _561 = _545 - (floor(_545 * 0.020408164709806442f) * 49.0f);
  float _566 = floor(_558 * 0.1428571492433548f);
  float _567 = floor(_559 * 0.1428571492433548f);
  float _568 = floor(_560 * 0.1428571492433548f);
  float _569 = floor(_561 * 0.1428571492433548f);
  float _586 = (_566 * 0.2857142984867096f) + -0.9285714030265808f;
  float _587 = (_567 * 0.2857142984867096f) + -0.9285714030265808f;
  float _588 = (_568 * 0.2857142984867096f) + -0.9285714030265808f;
  float _589 = (_569 * 0.2857142984867096f) + -0.9285714030265808f;
  float _594 = (floor(_558 - (_566 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _595 = (floor(_559 - (_567 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _596 = (floor(_560 - (_568 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _597 = (floor(_561 - (_569 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _610 = (1.0f - abs(_586)) - abs(_594);
  float _611 = (1.0f - abs(_587)) - abs(_595);
  float _612 = (1.0f - abs(_588)) - abs(_596);
  float _613 = (1.0f - abs(_589)) - abs(_597);
  float _642 = select((_610 > 0.0f), -0.0f, -1.0f);
  float _643 = select((_611 > 0.0f), -0.0f, -1.0f);
  float _644 = select((_612 > 0.0f), -0.0f, -1.0f);
  float _645 = select((_613 > 0.0f), -0.0f, -1.0f);
  float _650 = (((floor(_586) * 2.0f) + 1.0f) * _642) + _586;
  float _651 = (((floor(_594) * 2.0f) + 1.0f) * _642) + _594;
  float _652 = (((floor(_587) * 2.0f) + 1.0f) * _643) + _587;
  float _653 = (((floor(_595) * 2.0f) + 1.0f) * _643) + _595;
  float _658 = (((floor(_588) * 2.0f) + 1.0f) * _644) + _588;
  float _659 = (((floor(_596) * 2.0f) + 1.0f) * _644) + _596;
  float _660 = (((floor(_589) * 2.0f) + 1.0f) * _645) + _589;
  float _661 = (((floor(_597) * 2.0f) + 1.0f) * _645) + _597;
  float _670 = 1.7928400039672852f - (dot(float3(_650, _651, _610), float3(_650, _651, _610)) * 0.8537350296974182f);
  float _671 = 1.7928400039672852f - (dot(float3(_652, _653, _611), float3(_652, _653, _611)) * 0.8537350296974182f);
  float _672 = 1.7928400039672852f - (dot(float3(_658, _659, _612), float3(_658, _659, _612)) * 0.8537350296974182f);
  float _673 = 1.7928400039672852f - (dot(float3(_660, _661, _613), float3(_660, _661, _613)) * 0.8537350296974182f);
  float _694 = max((0.6000000238418579f - dot(float3(_400, _401, _402), float3(_400, _401, _402))), 0.0f);
  float _695 = max((0.6000000238418579f - dot(float3(_421, _422, _423), float3(_421, _422, _423))), 0.0f);
  float _696 = max((0.6000000238418579f - dot(float3(_427, _428, _429), float3(_427, _428, _429))), 0.0f);
  float _697 = max((0.6000000238418579f - dot(float3(_430, _431, _432), float3(_430, _431, _432))), 0.0f);
  float _698 = _694 * _694;
  float _699 = _695 * _695;
  float _700 = _696 * _696;
  float _701 = _697 * _697;
  float _716 = saturate((((sin(_379 - _380) * 0.15000000596046448f) + 0.050000011920928955f) + (dot(float4((_698 * _698), (_699 * _699), (_700 * _700), (_701 * _701)), float4(dot(float3((_670 * _650), (_670 * _651), (_670 * _610)), float3(_400, _401, _402)), dot(float3((_671 * _652), (_671 * _653), (_671 * _611)), float3(_421, _422, _423)), dot(float3((_672 * _658), (_672 * _659), (_672 * _612)), float3(_427, _428, _429)), dot(float3((_673 * _660), (_673 * _661), (_673 * _613)), float3(_430, _431, _432)))) * 21.0f)) * 4.0f);
  float _720 = (_716 * _716) * (3.0f - (_716 * 2.0f));
  float _722 = (_720 * 0.6499999761581421f) + 0.3499999940395355f;
  float _727 = (_341 * 0.5f) - _385;
  float _728 = (_356 * 0.004444444552063942f) - _385;
  float _729 = dot(float3(_727, _728, _388), float3(0.3333333432674408f, 0.3333333432674408f, 0.3333333432674408f));
  float _733 = floor(_729 + _727);
  float _734 = floor(_729 + _728);
  float _735 = floor(_729 + _388);
  float _739 = dot(float3(_733, _734, _735), float3(0.1666666716337204f, 0.1666666716337204f, 0.1666666716337204f));
  float _740 = _739 + (_727 - _733);
  float _741 = _739 + (_728 - _734);
  float _742 = (_388 - _735) + _739;
  float _746 = select((_740 < _741), 0.0f, 1.0f);
  float _747 = select((_741 < _742), 0.0f, 1.0f);
  float _748 = select((_742 < _740), 0.0f, 1.0f);
  float _749 = 1.0f - _746;
  float _750 = 1.0f - _747;
  float _751 = 1.0f - _748;
  float _752 = min(_746, _751);
  float _753 = min(_747, _749);
  float _754 = min(_748, _750);
  float _755 = max(_746, _751);
  float _756 = max(_747, _749);
  float _757 = max(_748, _750);
  float _761 = (_740 - _752) + 0.1666666716337204f;
  float _762 = (_741 - _753) + 0.1666666716337204f;
  float _763 = (_742 - _754) + 0.1666666716337204f;
  float _767 = (_740 - _755) + 0.3333333432674408f;
  float _768 = (_741 - _756) + 0.3333333432674408f;
  float _769 = (_742 - _757) + 0.3333333432674408f;
  float _770 = _740 + -0.5f;
  float _771 = _741 + -0.5f;
  float _772 = _742 + -0.5f;
  float _782 = _733 - (floor(_733 * 0.0034602077212184668f) * 289.0f);
  float _783 = _734 - (floor(_734 * 0.0034602077212184668f) * 289.0f);
  float _784 = _735 - (floor(_735 * 0.0034602077212184668f) * 289.0f);
  float _785 = _784 + _754;
  float _786 = _784 + _757;
  float _787 = _784 + 1.0f;
  float _796 = ((_784 * 34.0f) + 1.0f) * _784;
  float _797 = ((_785 * 34.0f) + 1.0f) * _785;
  float _798 = ((_786 * 34.0f) + 1.0f) * _786;
  float _799 = ((_787 * 34.0f) + 1.0f) * _787;
  float _813 = (_796 - (floor(_796 * 0.0034602077212184668f) * 289.0f)) + _783;
  float _816 = ((_783 + _753) - (floor(_797 * 0.0034602077212184668f) * 289.0f)) + _797;
  float _819 = ((_783 + _756) - (floor(_798 * 0.0034602077212184668f) * 289.0f)) + _798;
  float _822 = ((_783 + 1.0f) - (floor(_799 * 0.0034602077212184668f) * 289.0f)) + _799;
  float _831 = ((_813 * 34.0f) + 1.0f) * _813;
  float _832 = ((_816 * 34.0f) + 1.0f) * _816;
  float _833 = ((_819 * 34.0f) + 1.0f) * _819;
  float _834 = ((_822 * 34.0f) + 1.0f) * _822;
  float _848 = (_831 - (floor(_831 * 0.0034602077212184668f) * 289.0f)) + _782;
  float _851 = ((_782 + _752) - (floor(_832 * 0.0034602077212184668f) * 289.0f)) + _832;
  float _854 = ((_782 + _755) - (floor(_833 * 0.0034602077212184668f) * 289.0f)) + _833;
  float _857 = ((_782 + 1.0f) - (floor(_834 * 0.0034602077212184668f) * 289.0f)) + _834;
  float _866 = ((_848 * 34.0f) + 1.0f) * _848;
  float _867 = ((_851 * 34.0f) + 1.0f) * _851;
  float _868 = ((_854 * 34.0f) + 1.0f) * _854;
  float _869 = ((_857 * 34.0f) + 1.0f) * _857;
  float _882 = _866 - (floor(_866 * 0.0034602077212184668f) * 289.0f);
  float _883 = _867 - (floor(_867 * 0.0034602077212184668f) * 289.0f);
  float _884 = _868 - (floor(_868 * 0.0034602077212184668f) * 289.0f);
  float _885 = _869 - (floor(_869 * 0.0034602077212184668f) * 289.0f);
  float _898 = _882 - (floor(_882 * 0.020408164709806442f) * 49.0f);
  float _899 = _883 - (floor(_883 * 0.020408164709806442f) * 49.0f);
  float _900 = _884 - (floor(_884 * 0.020408164709806442f) * 49.0f);
  float _901 = _885 - (floor(_885 * 0.020408164709806442f) * 49.0f);
  float _906 = floor(_898 * 0.1428571492433548f);
  float _907 = floor(_899 * 0.1428571492433548f);
  float _908 = floor(_900 * 0.1428571492433548f);
  float _909 = floor(_901 * 0.1428571492433548f);
  float _926 = (_906 * 0.2857142984867096f) + -0.9285714030265808f;
  float _927 = (_907 * 0.2857142984867096f) + -0.9285714030265808f;
  float _928 = (_908 * 0.2857142984867096f) + -0.9285714030265808f;
  float _929 = (_909 * 0.2857142984867096f) + -0.9285714030265808f;
  float _934 = (floor(_898 - (_906 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _935 = (floor(_899 - (_907 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _936 = (floor(_900 - (_908 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _937 = (floor(_901 - (_909 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _950 = (1.0f - abs(_926)) - abs(_934);
  float _951 = (1.0f - abs(_927)) - abs(_935);
  float _952 = (1.0f - abs(_928)) - abs(_936);
  float _953 = (1.0f - abs(_929)) - abs(_937);
  float _982 = select((_950 > 0.0f), -0.0f, -1.0f);
  float _983 = select((_951 > 0.0f), -0.0f, -1.0f);
  float _984 = select((_952 > 0.0f), -0.0f, -1.0f);
  float _985 = select((_953 > 0.0f), -0.0f, -1.0f);
  float _990 = (((floor(_926) * 2.0f) + 1.0f) * _982) + _926;
  float _991 = (((floor(_934) * 2.0f) + 1.0f) * _982) + _934;
  float _992 = (((floor(_927) * 2.0f) + 1.0f) * _983) + _927;
  float _993 = (((floor(_935) * 2.0f) + 1.0f) * _983) + _935;
  float _998 = (((floor(_928) * 2.0f) + 1.0f) * _984) + _928;
  float _999 = (((floor(_936) * 2.0f) + 1.0f) * _984) + _936;
  float _1000 = (((floor(_929) * 2.0f) + 1.0f) * _985) + _929;
  float _1001 = (((floor(_937) * 2.0f) + 1.0f) * _985) + _937;
  float _1010 = 1.7928400039672852f - (dot(float3(_990, _991, _950), float3(_990, _991, _950)) * 0.8537350296974182f);
  float _1011 = 1.7928400039672852f - (dot(float3(_992, _993, _951), float3(_992, _993, _951)) * 0.8537350296974182f);
  float _1012 = 1.7928400039672852f - (dot(float3(_998, _999, _952), float3(_998, _999, _952)) * 0.8537350296974182f);
  float _1013 = 1.7928400039672852f - (dot(float3(_1000, _1001, _953), float3(_1000, _1001, _953)) * 0.8537350296974182f);
  float _1034 = max((0.6000000238418579f - dot(float3(_740, _741, _742), float3(_740, _741, _742))), 0.0f);
  float _1035 = max((0.6000000238418579f - dot(float3(_761, _762, _763), float3(_761, _762, _763))), 0.0f);
  float _1036 = max((0.6000000238418579f - dot(float3(_767, _768, _769), float3(_767, _768, _769))), 0.0f);
  float _1037 = max((0.6000000238418579f - dot(float3(_770, _771, _772), float3(_770, _771, _772))), 0.0f);
  float _1038 = _1034 * _1034;
  float _1039 = _1035 * _1035;
  float _1040 = _1036 * _1036;
  float _1041 = _1037 * _1037;
  float _1056 = saturate((((sin((_356 * 2.5f) - _380) * 0.15000000596046448f) + 0.050000011920928955f) + (dot(float4((_1038 * _1038), (_1039 * _1039), (_1040 * _1040), (_1041 * _1041)), float4(dot(float3((_1010 * _990), (_1010 * _991), (_1010 * _950)), float3(_740, _741, _742)), dot(float3((_1011 * _992), (_1011 * _993), (_1011 * _951)), float3(_761, _762, _763)), dot(float3((_1012 * _998), (_1012 * _999), (_1012 * _952)), float3(_767, _768, _769)), dot(float3((_1013 * _1000), (_1013 * _1001), (_1013 * _953)), float3(_770, _771, _772)))) * 21.0f)) * 4.0f);
  float _1060 = (_1056 * _1056) * (3.0f - (_1056 * 2.0f));
  float _1062 = (_1060 * 0.6499999761581421f) + 0.3499999940395355f;
  float _1069 = frame_consts.time * 0.15000000596046448f;
  float _1070 = (_357 * 0.04444444552063942f) - _1069;
  float _1071 = _384 - _1069;
  float _1072 = frame_consts.time * 0.02500000037252903f;
  float _1073 = dot(float3(_1070, _1071, _1072), float3(0.3333333432674408f, 0.3333333432674408f, 0.3333333432674408f));
  float _1077 = floor(_1070 + _1073);
  float _1078 = floor(_1071 + _1073);
  float _1079 = floor(_1072 + _1073);
  float _1083 = dot(float3(_1077, _1078, _1079), float3(0.1666666716337204f, 0.1666666716337204f, 0.1666666716337204f));
  float _1084 = _1083 + (_1070 - _1077);
  float _1085 = _1083 + (_1071 - _1078);
  float _1086 = (_1072 - _1079) + _1083;
  float _1090 = select((_1084 < _1085), 0.0f, 1.0f);
  float _1091 = select((_1085 < _1086), 0.0f, 1.0f);
  float _1092 = select((_1086 < _1084), 0.0f, 1.0f);
  float _1093 = 1.0f - _1090;
  float _1094 = 1.0f - _1091;
  float _1095 = 1.0f - _1092;
  float _1096 = min(_1090, _1095);
  float _1097 = min(_1091, _1093);
  float _1098 = min(_1092, _1094);
  float _1099 = max(_1090, _1095);
  float _1100 = max(_1091, _1093);
  float _1101 = max(_1092, _1094);
  float _1105 = (_1084 - _1096) + 0.1666666716337204f;
  float _1106 = (_1085 - _1097) + 0.1666666716337204f;
  float _1107 = (_1086 - _1098) + 0.1666666716337204f;
  float _1111 = (_1084 - _1099) + 0.3333333432674408f;
  float _1112 = (_1085 - _1100) + 0.3333333432674408f;
  float _1113 = (_1086 - _1101) + 0.3333333432674408f;
  float _1114 = _1084 + -0.5f;
  float _1115 = _1085 + -0.5f;
  float _1116 = _1086 + -0.5f;
  float _1126 = _1077 - (floor(_1077 * 0.0034602077212184668f) * 289.0f);
  float _1127 = _1078 - (floor(_1078 * 0.0034602077212184668f) * 289.0f);
  float _1128 = _1079 - (floor(_1079 * 0.0034602077212184668f) * 289.0f);
  float _1129 = _1128 + _1098;
  float _1130 = _1128 + _1101;
  float _1131 = _1128 + 1.0f;
  float _1140 = ((_1128 * 34.0f) + 1.0f) * _1128;
  float _1141 = ((_1129 * 34.0f) + 1.0f) * _1129;
  float _1142 = ((_1130 * 34.0f) + 1.0f) * _1130;
  float _1143 = ((_1131 * 34.0f) + 1.0f) * _1131;
  float _1157 = (_1140 - (floor(_1140 * 0.0034602077212184668f) * 289.0f)) + _1127;
  float _1160 = ((_1127 + _1097) - (floor(_1141 * 0.0034602077212184668f) * 289.0f)) + _1141;
  float _1163 = ((_1127 + _1100) - (floor(_1142 * 0.0034602077212184668f) * 289.0f)) + _1142;
  float _1166 = ((_1127 + 1.0f) - (floor(_1143 * 0.0034602077212184668f) * 289.0f)) + _1143;
  float _1175 = ((_1157 * 34.0f) + 1.0f) * _1157;
  float _1176 = ((_1160 * 34.0f) + 1.0f) * _1160;
  float _1177 = ((_1163 * 34.0f) + 1.0f) * _1163;
  float _1178 = ((_1166 * 34.0f) + 1.0f) * _1166;
  float _1192 = (_1175 - (floor(_1175 * 0.0034602077212184668f) * 289.0f)) + _1126;
  float _1195 = ((_1126 + _1096) - (floor(_1176 * 0.0034602077212184668f) * 289.0f)) + _1176;
  float _1198 = ((_1126 + _1099) - (floor(_1177 * 0.0034602077212184668f) * 289.0f)) + _1177;
  float _1201 = ((_1126 + 1.0f) - (floor(_1178 * 0.0034602077212184668f) * 289.0f)) + _1178;
  float _1210 = ((_1192 * 34.0f) + 1.0f) * _1192;
  float _1211 = ((_1195 * 34.0f) + 1.0f) * _1195;
  float _1212 = ((_1198 * 34.0f) + 1.0f) * _1198;
  float _1213 = ((_1201 * 34.0f) + 1.0f) * _1201;
  float _1226 = _1210 - (floor(_1210 * 0.0034602077212184668f) * 289.0f);
  float _1227 = _1211 - (floor(_1211 * 0.0034602077212184668f) * 289.0f);
  float _1228 = _1212 - (floor(_1212 * 0.0034602077212184668f) * 289.0f);
  float _1229 = _1213 - (floor(_1213 * 0.0034602077212184668f) * 289.0f);
  float _1242 = _1226 - (floor(_1226 * 0.020408164709806442f) * 49.0f);
  float _1243 = _1227 - (floor(_1227 * 0.020408164709806442f) * 49.0f);
  float _1244 = _1228 - (floor(_1228 * 0.020408164709806442f) * 49.0f);
  float _1245 = _1229 - (floor(_1229 * 0.020408164709806442f) * 49.0f);
  float _1250 = floor(_1242 * 0.1428571492433548f);
  float _1251 = floor(_1243 * 0.1428571492433548f);
  float _1252 = floor(_1244 * 0.1428571492433548f);
  float _1253 = floor(_1245 * 0.1428571492433548f);
  float _1270 = (_1250 * 0.2857142984867096f) + -0.9285714030265808f;
  float _1271 = (_1251 * 0.2857142984867096f) + -0.9285714030265808f;
  float _1272 = (_1252 * 0.2857142984867096f) + -0.9285714030265808f;
  float _1273 = (_1253 * 0.2857142984867096f) + -0.9285714030265808f;
  float _1278 = (floor(_1242 - (_1250 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _1279 = (floor(_1243 - (_1251 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _1280 = (floor(_1244 - (_1252 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _1281 = (floor(_1245 - (_1253 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _1294 = (1.0f - abs(_1270)) - abs(_1278);
  float _1295 = (1.0f - abs(_1271)) - abs(_1279);
  float _1296 = (1.0f - abs(_1272)) - abs(_1280);
  float _1297 = (1.0f - abs(_1273)) - abs(_1281);
  float _1326 = select((_1294 > 0.0f), -0.0f, -1.0f);
  float _1327 = select((_1295 > 0.0f), -0.0f, -1.0f);
  float _1328 = select((_1296 > 0.0f), -0.0f, -1.0f);
  float _1329 = select((_1297 > 0.0f), -0.0f, -1.0f);
  float _1334 = (((floor(_1270) * 2.0f) + 1.0f) * _1326) + _1270;
  float _1335 = (((floor(_1278) * 2.0f) + 1.0f) * _1326) + _1278;
  float _1336 = (((floor(_1271) * 2.0f) + 1.0f) * _1327) + _1271;
  float _1337 = (((floor(_1279) * 2.0f) + 1.0f) * _1327) + _1279;
  float _1342 = (((floor(_1272) * 2.0f) + 1.0f) * _1328) + _1272;
  float _1343 = (((floor(_1280) * 2.0f) + 1.0f) * _1328) + _1280;
  float _1344 = (((floor(_1273) * 2.0f) + 1.0f) * _1329) + _1273;
  float _1345 = (((floor(_1281) * 2.0f) + 1.0f) * _1329) + _1281;
  float _1354 = 1.7928400039672852f - (dot(float3(_1334, _1335, _1294), float3(_1334, _1335, _1294)) * 0.8537350296974182f);
  float _1355 = 1.7928400039672852f - (dot(float3(_1336, _1337, _1295), float3(_1336, _1337, _1295)) * 0.8537350296974182f);
  float _1356 = 1.7928400039672852f - (dot(float3(_1342, _1343, _1296), float3(_1342, _1343, _1296)) * 0.8537350296974182f);
  float _1357 = 1.7928400039672852f - (dot(float3(_1344, _1345, _1297), float3(_1344, _1345, _1297)) * 0.8537350296974182f);
  float _1378 = max((0.6000000238418579f - dot(float3(_1084, _1085, _1086), float3(_1084, _1085, _1086))), 0.0f);
  float _1379 = max((0.6000000238418579f - dot(float3(_1105, _1106, _1107), float3(_1105, _1106, _1107))), 0.0f);
  float _1380 = max((0.6000000238418579f - dot(float3(_1111, _1112, _1113), float3(_1111, _1112, _1113))), 0.0f);
  float _1381 = max((0.6000000238418579f - dot(float3(_1114, _1115, _1116), float3(_1114, _1115, _1116))), 0.0f);
  float _1382 = _1378 * _1378;
  float _1383 = _1379 * _1379;
  float _1384 = _1380 * _1380;
  float _1385 = _1381 * _1381;
  float _1400 = saturate((((sin(_379 - (frame_consts.time * 1.5f)) * 0.15000000596046448f) + 0.050000011920928955f) + (dot(float4((_1382 * _1382), (_1383 * _1383), (_1384 * _1384), (_1385 * _1385)), float4(dot(float3((_1354 * _1334), (_1354 * _1335), (_1354 * _1294)), float3(_1084, _1085, _1086)), dot(float3((_1355 * _1336), (_1355 * _1337), (_1355 * _1295)), float3(_1105, _1106, _1107)), dot(float3((_1356 * _1342), (_1356 * _1343), (_1356 * _1296)), float3(_1111, _1112, _1113)), dot(float3((_1357 * _1344), (_1357 * _1345), (_1357 * _1297)), float3(_1114, _1115, _1116)))) * 21.0f)) * 4.0f);
  float _1404 = (_1400 * _1400) * (3.0f - (_1400 * 2.0f));
  float _1406 = (_1404 * 0.6499999761581421f) + 0.3499999940395355f;
  float _1428 = saturate(_722);
  float _1429 = saturate(_1062);
  float _1451 = (((_266 * 1.2000000476837158f) * _271) * frame_consts.params.vignette.golden_intensity) * ((((saturate(11.0f - (sqrt((_363 * _363) + (_362 * _362)) / ((_1060 * 0.039000000804662704f) + 0.08100000768899918f))) * _1062) + (saturate(11.0f - (sqrt((_358 * _358) + _368) / ((_720 * 0.039000000804662704f) + 0.08100000768899918f))) * _722)) + (saturate(11.0f - (sqrt((_375 * _375) + _368) / ((_1404 * 0.039000000804662704f) + 0.08100000768899918f))) * _1406)) + (((((saturate(1.0f - (abs(_359) * 0.8333333134651184f)) * _1428) + (saturate(1.0f - (abs(dot(float2(_362, _363), float2(-0.8660253882408142f, 0.5f))) * 0.8333333134651184f)) * _1429)) * saturate(_1406)) + ((_1428 * saturate(1.0f - (abs(dot(float2(_358, _359), float2(0.8660253882408142f, 0.5f))) * 0.8333333134651184f))) * _1429)) * 0.5f));
  SV_Target.x = ((_1451 * ((_318 * _318) - _280)) + _280);
  SV_Target.y = ((_1451 * ((_319 * _319) - _281)) + _281);
  SV_Target.z = ((_1451 * ((_320 * _320) - _282)) + _282);
  if (RENODX_TONE_MAP_TYPE) {
    SV_Target.rgb = renodx::draw::ToneMapPass(_28.rgb, SV_Target.rgb);
  } else {
    SV_Target.rgb = saturate(SV_Target.rgb);
  }
  SV_Target.rgb = renodx::draw::RenderIntermediatePass(SV_Target.rgb);

  SV_Target.w = 1.0f;
  return SV_Target;
}
