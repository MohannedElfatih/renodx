#include "../shared.h"

struct Lod_params {
  struct Lod_brush_params {
    float4 brush_uv[4];
    float base_radius;
    float radius_variation;
    float radius_random;
    float blur;
    float alpha;
    float stretch;
  } brushes;
  struct Lod_noise_params {
    float chaos;
    float freq;
    float brightness;
    float saturation;
    float hue;
  } noise;
  struct Lod_outlines_params {
    float2 thickness;
    float2 softness;
    float2 displacement;
    float2 attenuation;
    float lighting_threshold;
    float lighting_threshold_softness;
    float2 lighting_dark;
    float2 lighting_bright;
    float2 discretion;
    float2 alpha;
  } outlines;
};

struct Frame_constants {
  float3 cam_world_pos;
  float time;
  float2 inv_near_dim;
  float proj_scale;
  uint flags;
  float2 half_vp_dim;
  int2 vp_dim;
  float2 vp_texel_size;
  int2 mouse_pos;
  int2 inspected_pix;
  int2 hi_z_0_dim;
  int supersampling;
  int debug_patches;
  int use_patches;
  int emissive;
  float3 target;
  uint frame_number;
  uint shot_frame_number;
  float dt;
  float4 view_to_world[4];
  float4 world_to_view[4];
  float4 view_ndc[4];
  float4 world_ndc[4];
  float4 prev_world_ndc[4];
  float4 ndc_world[4];
  float4 ndc_to_prev_ndc[4];
  float4 prev_ndc_to_ndc[4];
  float4 view_world_z0;
  float4 pix_to_fog_eq;
  float3 mio_view;
  float3 mio_hair_outline_color;
  float mio_foliage_velocity;
  int show_wireframe;
  int ao;
  int glitch;
  int no_vertex_color;
  float paper_mult;
  int hatching;
  int mio_halo;
  int vol_temporal;
  int heart_attack_active;
  int heart_attack_secondary_target;
  int triangular_dissolve_enabled;
  int color_correct;
  float starfield_effect_amount;
  float starfield_fade_amount;
  float3 starfield_center_view;
  float starfield_glow_amount;
  float starfield_pulse_t;
  float death_anim_t;
  float3 game_plane_world_origin;
  float3 game_plane_world_normal;
  float3 game_plane_world_u;
  float3 game_plane_world_v;
  float4 game_plane_transform[4];
  float4 hatching_xf[4];
  float4 paper_xf[4];
  float2 game_plane_blend;
  float heart_attack_t;
  float heart_attack_duration;
  float heart_attack_pulse;
  float heart_attack_outline_distance;
  float heart_attack_dissolve_distance;
  float3 heart_attack_dissolve_color;
  float heart_attack_dissolve_base;
  float heart_attack_dissolve_mult;
  float3 heart_attack_dissolve_world_center;
  float heart_attack_vertical_dissolve;
  float triangular_dissolve_base_amount;
  float triangular_dissolve_amount;
  float flashback_lut;
  float evil_mio;
  float dead_mio;
  float godlike_mio;
  float khlia_pulse_t;
  float khlia__pulse_t;
  float khlia_pulse_period;
  float3 khlia_world_pos;
  float skydome_rotation_offset;
  float hatch_ambiant_mul;
  float hatch_ambiant_add;
  float glitch_scale;
  uint max_contours;
  uint max_contour_loops;
  int death_screen;
  float death_screen_t;
  int poetic_death_screen;
  float poetic_death_screen_t;
  float tremor_pulse_t;
  int invert;
  float surface_fade;
  struct Postprocess_params {
    struct AO_params {
      float3 color;
      float intensity;
    } ao;
    struct Fog_params {
      float bloom_factor;
      float space;
      float outline_density;
      float outline_attenuation;
    } fog;
    struct Ambient_light_params {
      int undercoat_grad;
      float3 color;
      float intensity;
      float gameplay_intensity;
      float gameplay_width;
      float directional_intensity;
      float directional_shadows;
      float undercoat_noise_freq;
      float undercoat_noise_amplitude;
      float undercoat_noise_threshold;
      float undercoating;
    } ambient_light;
    struct Vignette_params {
      float intensity;
      float rounded;
      float3 color;
      float golden_intensity;
      float golden_color;
    } vignette;
    struct Bloom_params {
      float intensity;
      float threshold_low;
      float threshold_high;
    } bloom;
    struct Mio_params {
      float light_intensity;
      float light_radius;
      float3 light_color;
      float spec_intensity;
      float3 halo_color;
      float halo_intensity;
    } mio;
    struct Particles_params {
      uint count;
      float cam_near;
      float cam_far;
      float fadeoff_near;
      float2 lifetime;
      float fadein_duration;
      float fadeoff_duration;
      float2 alpha;
      float2 scale;
      float2 speed;
      int gradient;
      float circle_attenuation;
    } particles;
    struct Chroma_aberration_params {
      float intensity;
    } chroma_aberration;
    struct Fade_params {
      float intensity;
      float3 color;
    } fade;
    struct Dof_params {
      float plane_01;
      float plane_01_softness;
      float plane_12;
      float plane_12_softness;
      float foreground;
      float foreground_softness;
    } dof;
    Lod_params lod_foreground;
    Lod_params lod_game;
    Lod_params lod_midground;
    Lod_params lod_background;
  } params;
};


Texture2D<float4> tex : register(t0);

Texture2D<float> depth_tex : register(t1);

Texture2D<float2> distortion : register(t4);

Texture2D<float> paper_tex : register(t5);

Texture2D<float3> bloom_tex : register(t7);

Texture2D<float3> color_correct_lut : register(t8);

cbuffer frame_consts : register(b0) {
  Frame_constants frame_consts : packoffset(c000.x);
};

SamplerState sampler_nearest : register(s0);

SamplerState sampler_bilinear : register(s1);

SamplerState sampler_bilinear_wrap : register(s2);

float4 main(
  noperspective float4 SV_Position : SV_Position,
  linear float2 O_Uv : O_Uv
) : SV_Target {
  float4 SV_Target;
  float _16 = float((int)(frame_consts.vp_dim.x));
  float _17 = float((int)(frame_consts.vp_dim.y));
  float2 _18 = distortion.SampleLevel(sampler_nearest, float2(O_Uv.x, O_Uv.y), 0.0f);
  float _21 = _17 / _16;
  float _26 = saturate((_18.x * _21) + O_Uv.x);
  float _27 = saturate((_18.y * _21) + O_Uv.y);
  float4 _28 = tex.SampleLevel(sampler_nearest, float2(_26, _27), 0.0f);
  float3 _32 = bloom_tex.SampleLevel(sampler_bilinear, float2(_26, _27), 0.0f);
  float _47 = max((((1.0f - (_28.y * 0.7152000069618225f)) - (_28.x * 0.2125999927520752f)) - (_28.z * 0.0722000002861023f)), 0.0010000000474974513f);
  float _51 = (_28.x / _47) + (frame_consts.params.bloom.intensity * _32.x);
  float _52 = (_28.y / _47) + (frame_consts.params.bloom.intensity * _32.y);
  float _53 = (_28.z / _47) + (frame_consts.params.bloom.intensity * _32.z);
  float _59 = (((_51 * 0.2125999927520752f) + 1.0f) + (_52 * 0.7152000069618225f)) + (_53 * 0.0722000002861023f);
  float _63 = saturate(_51 / _59);
  float _64 = saturate(_52 / _59);
  float _65 = saturate(_53 / _59);
  uint2 _66; color_correct_lut.GetDimensions(_66.x, _66.y);
  float _79;
  float _90;
  float _101;
  if (!(!(_63 <= 0.0031308000907301903f))) {
    _79 = (_63 * 12.920000076293945f);
  } else {
    _79 = (((pow(_63, 0.4166666567325592f)) * 1.0549999475479126f) + -0.054999999701976776f);
  }
  if (!(!(_64 <= 0.0031308000907301903f))) {
    _90 = (_64 * 12.920000076293945f);
  } else {
    _90 = (((pow(_64, 0.4166666567325592f)) * 1.0549999475479126f) + -0.054999999701976776f);
  }
  if (!(!(_65 <= 0.0031308000907301903f))) {
    _101 = (_65 * 12.920000076293945f);
  } else {
    _101 = (((pow(_65, 0.4166666567325592f)) * 1.0549999475479126f) + -0.054999999701976776f);
  }
  float _104 = float((uint)(_66.y + -1u));
  float _107 = _101 * _104;
  float _108 = frac(_107);
  float _110 = float((uint)_66.y);
  float _112 = (_79 * _104) + 0.5f;
  float _115 = float((uint)_66.x);
  float _117 = (lerp(_90, 1.0f, _104)) / _110;
  float3 _118 = color_correct_lut.SampleLevel(sampler_bilinear, float2((((ceil(_107) * _110) + _112) / _115), _117), 0.0f);
  float3 _126 = color_correct_lut.SampleLevel(sampler_bilinear, float2((((floor(_107) * _110) + _112) / _115), _117), 0.0f);
  float _136 = ((_118.x - _126.x) * _108) + _126.x;
  float _137 = ((_118.y - _126.y) * _108) + _126.y;
  float _138 = ((_118.z - _126.z) * _108) + _126.z;
  float _144 = depth_tex.SampleLevel(sampler_nearest, float2(_26, _27), 0.0f);
  float _148 = 10000.0f / ((_144.x * 19999.5f) + 0.5f);
  float _153 = (_148 * ((_26 * 2.0f) + -1.0f)) * frame_consts.inv_near_dim.x;
  float _155 = (_148 * (((1.0f - _27) * 2.0f) + -1.0f)) * frame_consts.inv_near_dim.y;
  float _156 = -0.0f - _148;
  float _180 = mad((frame_consts.paper_xf[2].z), _156, mad((frame_consts.paper_xf[1].z), _155, (_153 * (frame_consts.paper_xf[0].z))));
  float _181 = mad((frame_consts.paper_xf[2].x), _156, mad((frame_consts.paper_xf[1].x), _155, (_153 * (frame_consts.paper_xf[0].x)))) / _180;
  float _182 = mad((frame_consts.paper_xf[2].y), _156, mad((frame_consts.paper_xf[1].y), _155, (_153 * (frame_consts.paper_xf[0].y)))) / _180;
  float _189 = log2(max(5.0f, (-0.0f - (_180 - frame_consts.game_plane_blend.x)))) * 10.0f;
  float _190 = floor(_189);
  float _191 = _189 - _190;
  float _193 = exp2(_190 * 0.10000000149011612f);
  float _194 = 1.0f / _193;
  float _195 = min(_194, 0.20000000298023224f);
  float _197 = min((_194 * 0.9330329895019531f), 0.20000000298023224f);
  float _198 = frame_consts.game_plane_blend.x - _193;
  float _204 = frame_consts.game_plane_blend.x - (_193 * 1.0717734098434448f);
  float _214 = paper_tex.SampleLevel(sampler_bilinear_wrap, float2((((_198 * _181) + (frame_consts.paper_xf[3].x)) * _195), (((_198 * _182) + (frame_consts.paper_xf[3].y)) * _195)), 0.0f);
  float _217 = paper_tex.SampleLevel(sampler_bilinear_wrap, float2((((_204 * _181) + (frame_consts.paper_xf[3].x)) * _197), (((_204 * _182) + (frame_consts.paper_xf[3].y)) * _197)), 0.0f);
  float _224 = ((1.0f - (_214.x * (1.0f - _191))) - (_217.x * _191)) * frame_consts.paper_mult;
  float _239 = _16 / _17;
  float _251 = exp2(log2(saturate((frame_consts.params.vignette.intensity * abs(_26 + -0.5f)) * (((_239 + -1.0f) * frame_consts.params.vignette.rounded) + 1.0f))) * 5.0f);
  float _252 = exp2(log2(saturate(frame_consts.params.vignette.intensity * abs(_27 + -0.5f))) * 5.0f);
  float _258 = exp2(log2(saturate(1.0f - dot(float2(_251, _252), float2(_251, _252)))) * 6.0f);
  float _263 = 1.0f - _258;
  float _265 = 1.0f - (_263 * 0.8500000238418579f);
  float _272 = (_265 * ((_136 - (_224 * _136)) - frame_consts.params.vignette.color.x)) + frame_consts.params.vignette.color.x;
  float _273 = (_265 * ((_137 - (_224 * _137)) - frame_consts.params.vignette.color.y)) + frame_consts.params.vignette.color.y;
  float _274 = (_265 * ((_138 - (_224 * _138)) - frame_consts.params.vignette.color.z)) + frame_consts.params.vignette.color.z;
  float _278 = _26 * _16;
  float _279 = _27 * _17;
  float _280 = _279 + _278;
  float _286 = frac(_280 * 0.0033333334140479565f) + -0.5f;
  float _287 = frac((_279 - _278) * 0.0033333334140479565f) + -0.5f;
  float _293 = saturate(sqrt((_287 * _287) + (_286 * _286)) * 2.0f);
  float _304 = saturate((sin((_280 * 0.01666666753590107f) - (frame_consts.time * 0.8500000238418579f)) * 1.2500001192092896f) + -0.25000008940696716f);
  float _309 = ((_304 * _304) * 0.2199999988079071f) * (3.0f - (_304 * 2.0f));
  float _310 = _309 + 0.9777389168739319f;
  float _311 = ((_293 * 0.13274884223937988f) + 0.7175776362419128f) + _309;
  float _312 = ((_293 * 0.3335757553577423f) + 0.30871906876564026f) + _309;
  float _317 = (_26 * 1080.0f) * _239;
  float _318 = _27 * 1080.0f;
  float _319 = _317 * 0.04444444552063942f;
  float _320 = _27 * 27.712812423706055f;
  float _322 = ceil(_319 - _320);
  float _325 = floor(_27 * 55.42562484741211f) + 1.0f;
  float _328 = ceil((-0.0f - _320) - _319);
  float _330 = (_325 + _322) + _328;
  float _332 = (_330 * 22.5f) + -33.75f;
  float _333 = _322 - _328;
  float _335 = _333 * 11.25f;
  float _341 = (((_325 * 0.5773502588272095f) - (_322 * 0.28867512941360474f)) - (_328 * 0.28867512941360474f)) * 22.5f;
  float _344 = _332 + _335;
  float _345 = _341 + (19.485570907592773f - (_330 * 12.990381240844727f));
  float _348 = ((_330 * 25.980762481689453f) + -38.97114181518555f) + _341;
  float _349 = _335 - _332;
  float _350 = _344 - _317;
  float _351 = _345 - _318;
  float _354 = _335 - _317;
  float _355 = _348 - _318;
  float _360 = _351 * _351;
  float _367 = _349 - _317;
  float _371 = _345 * 2.5f;
  float _372 = frame_consts.time * 1.5f;
  float _376 = _345 * 0.004444444552063942f;
  float _377 = frame_consts.time * 0.15000000596046448f;
  float _378 = (_344 * 0.04444444552063942f) - _377;
  float _379 = _376 - _377;
  float _380 = frame_consts.time * 0.02500000037252903f;
  float _381 = dot(float3(_378, _379, _380), float3(0.3333333432674408f, 0.3333333432674408f, 0.3333333432674408f));
  float _385 = floor(_381 + _378);
  float _386 = floor(_381 + _379);
  float _387 = floor(_381 + _380);
  float _391 = dot(float3(_385, _386, _387), float3(0.1666666716337204f, 0.1666666716337204f, 0.1666666716337204f));
  float _392 = _391 + (_378 - _385);
  float _393 = _391 + (_379 - _386);
  float _394 = (_380 - _387) + _391;
  float _398 = select((_392 < _393), 0.0f, 1.0f);
  float _399 = select((_393 < _394), 0.0f, 1.0f);
  float _400 = select((_394 < _392), 0.0f, 1.0f);
  float _401 = 1.0f - _398;
  float _402 = 1.0f - _399;
  float _403 = 1.0f - _400;
  float _404 = min(_398, _403);
  float _405 = min(_399, _401);
  float _406 = min(_400, _402);
  float _407 = max(_398, _403);
  float _408 = max(_399, _401);
  float _409 = max(_400, _402);
  float _413 = (_392 - _404) + 0.1666666716337204f;
  float _414 = (_393 - _405) + 0.1666666716337204f;
  float _415 = (_394 - _406) + 0.1666666716337204f;
  float _419 = (_392 - _407) + 0.3333333432674408f;
  float _420 = (_393 - _408) + 0.3333333432674408f;
  float _421 = (_394 - _409) + 0.3333333432674408f;
  float _422 = _392 + -0.5f;
  float _423 = _393 + -0.5f;
  float _424 = _394 + -0.5f;
  float _434 = _385 - (floor(_385 * 0.0034602077212184668f) * 289.0f);
  float _435 = _386 - (floor(_386 * 0.0034602077212184668f) * 289.0f);
  float _436 = _387 - (floor(_387 * 0.0034602077212184668f) * 289.0f);
  float _437 = _436 + _406;
  float _438 = _436 + _409;
  float _439 = _436 + 1.0f;
  float _448 = ((_436 * 34.0f) + 1.0f) * _436;
  float _449 = ((_437 * 34.0f) + 1.0f) * _437;
  float _450 = ((_438 * 34.0f) + 1.0f) * _438;
  float _451 = ((_439 * 34.0f) + 1.0f) * _439;
  float _465 = (_448 - (floor(_448 * 0.0034602077212184668f) * 289.0f)) + _435;
  float _468 = ((_435 + _405) - (floor(_449 * 0.0034602077212184668f) * 289.0f)) + _449;
  float _471 = ((_435 + _408) - (floor(_450 * 0.0034602077212184668f) * 289.0f)) + _450;
  float _474 = ((_435 + 1.0f) - (floor(_451 * 0.0034602077212184668f) * 289.0f)) + _451;
  float _483 = ((_465 * 34.0f) + 1.0f) * _465;
  float _484 = ((_468 * 34.0f) + 1.0f) * _468;
  float _485 = ((_471 * 34.0f) + 1.0f) * _471;
  float _486 = ((_474 * 34.0f) + 1.0f) * _474;
  float _500 = (_483 - (floor(_483 * 0.0034602077212184668f) * 289.0f)) + _434;
  float _503 = ((_434 + _404) - (floor(_484 * 0.0034602077212184668f) * 289.0f)) + _484;
  float _506 = ((_434 + _407) - (floor(_485 * 0.0034602077212184668f) * 289.0f)) + _485;
  float _509 = ((_434 + 1.0f) - (floor(_486 * 0.0034602077212184668f) * 289.0f)) + _486;
  float _518 = ((_500 * 34.0f) + 1.0f) * _500;
  float _519 = ((_503 * 34.0f) + 1.0f) * _503;
  float _520 = ((_506 * 34.0f) + 1.0f) * _506;
  float _521 = ((_509 * 34.0f) + 1.0f) * _509;
  float _534 = _518 - (floor(_518 * 0.0034602077212184668f) * 289.0f);
  float _535 = _519 - (floor(_519 * 0.0034602077212184668f) * 289.0f);
  float _536 = _520 - (floor(_520 * 0.0034602077212184668f) * 289.0f);
  float _537 = _521 - (floor(_521 * 0.0034602077212184668f) * 289.0f);
  float _550 = _534 - (floor(_534 * 0.020408164709806442f) * 49.0f);
  float _551 = _535 - (floor(_535 * 0.020408164709806442f) * 49.0f);
  float _552 = _536 - (floor(_536 * 0.020408164709806442f) * 49.0f);
  float _553 = _537 - (floor(_537 * 0.020408164709806442f) * 49.0f);
  float _558 = floor(_550 * 0.1428571492433548f);
  float _559 = floor(_551 * 0.1428571492433548f);
  float _560 = floor(_552 * 0.1428571492433548f);
  float _561 = floor(_553 * 0.1428571492433548f);
  float _578 = (_558 * 0.2857142984867096f) + -0.9285714030265808f;
  float _579 = (_559 * 0.2857142984867096f) + -0.9285714030265808f;
  float _580 = (_560 * 0.2857142984867096f) + -0.9285714030265808f;
  float _581 = (_561 * 0.2857142984867096f) + -0.9285714030265808f;
  float _586 = (floor(_550 - (_558 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _587 = (floor(_551 - (_559 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _588 = (floor(_552 - (_560 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _589 = (floor(_553 - (_561 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _602 = (1.0f - abs(_578)) - abs(_586);
  float _603 = (1.0f - abs(_579)) - abs(_587);
  float _604 = (1.0f - abs(_580)) - abs(_588);
  float _605 = (1.0f - abs(_581)) - abs(_589);
  float _634 = select((_602 > 0.0f), -0.0f, -1.0f);
  float _635 = select((_603 > 0.0f), -0.0f, -1.0f);
  float _636 = select((_604 > 0.0f), -0.0f, -1.0f);
  float _637 = select((_605 > 0.0f), -0.0f, -1.0f);
  float _642 = (((floor(_578) * 2.0f) + 1.0f) * _634) + _578;
  float _643 = (((floor(_586) * 2.0f) + 1.0f) * _634) + _586;
  float _644 = (((floor(_579) * 2.0f) + 1.0f) * _635) + _579;
  float _645 = (((floor(_587) * 2.0f) + 1.0f) * _635) + _587;
  float _650 = (((floor(_580) * 2.0f) + 1.0f) * _636) + _580;
  float _651 = (((floor(_588) * 2.0f) + 1.0f) * _636) + _588;
  float _652 = (((floor(_581) * 2.0f) + 1.0f) * _637) + _581;
  float _653 = (((floor(_589) * 2.0f) + 1.0f) * _637) + _589;
  float _662 = 1.7928400039672852f - (dot(float3(_642, _643, _602), float3(_642, _643, _602)) * 0.8537350296974182f);
  float _663 = 1.7928400039672852f - (dot(float3(_644, _645, _603), float3(_644, _645, _603)) * 0.8537350296974182f);
  float _664 = 1.7928400039672852f - (dot(float3(_650, _651, _604), float3(_650, _651, _604)) * 0.8537350296974182f);
  float _665 = 1.7928400039672852f - (dot(float3(_652, _653, _605), float3(_652, _653, _605)) * 0.8537350296974182f);
  float _686 = max((0.6000000238418579f - dot(float3(_392, _393, _394), float3(_392, _393, _394))), 0.0f);
  float _687 = max((0.6000000238418579f - dot(float3(_413, _414, _415), float3(_413, _414, _415))), 0.0f);
  float _688 = max((0.6000000238418579f - dot(float3(_419, _420, _421), float3(_419, _420, _421))), 0.0f);
  float _689 = max((0.6000000238418579f - dot(float3(_422, _423, _424), float3(_422, _423, _424))), 0.0f);
  float _690 = _686 * _686;
  float _691 = _687 * _687;
  float _692 = _688 * _688;
  float _693 = _689 * _689;
  float _708 = saturate((((sin(_371 - _372) * 0.15000000596046448f) + 0.050000011920928955f) + (dot(float4((_690 * _690), (_691 * _691), (_692 * _692), (_693 * _693)), float4(dot(float3((_662 * _642), (_662 * _643), (_662 * _602)), float3(_392, _393, _394)), dot(float3((_663 * _644), (_663 * _645), (_663 * _603)), float3(_413, _414, _415)), dot(float3((_664 * _650), (_664 * _651), (_664 * _604)), float3(_419, _420, _421)), dot(float3((_665 * _652), (_665 * _653), (_665 * _605)), float3(_422, _423, _424)))) * 21.0f)) * 4.0f);
  float _712 = (_708 * _708) * (3.0f - (_708 * 2.0f));
  float _714 = (_712 * 0.6499999761581421f) + 0.3499999940395355f;
  float _719 = (_333 * 0.5f) - _377;
  float _720 = (_348 * 0.004444444552063942f) - _377;
  float _721 = dot(float3(_719, _720, _380), float3(0.3333333432674408f, 0.3333333432674408f, 0.3333333432674408f));
  float _725 = floor(_721 + _719);
  float _726 = floor(_721 + _720);
  float _727 = floor(_721 + _380);
  float _731 = dot(float3(_725, _726, _727), float3(0.1666666716337204f, 0.1666666716337204f, 0.1666666716337204f));
  float _732 = _731 + (_719 - _725);
  float _733 = _731 + (_720 - _726);
  float _734 = (_380 - _727) + _731;
  float _738 = select((_732 < _733), 0.0f, 1.0f);
  float _739 = select((_733 < _734), 0.0f, 1.0f);
  float _740 = select((_734 < _732), 0.0f, 1.0f);
  float _741 = 1.0f - _738;
  float _742 = 1.0f - _739;
  float _743 = 1.0f - _740;
  float _744 = min(_738, _743);
  float _745 = min(_739, _741);
  float _746 = min(_740, _742);
  float _747 = max(_738, _743);
  float _748 = max(_739, _741);
  float _749 = max(_740, _742);
  float _753 = (_732 - _744) + 0.1666666716337204f;
  float _754 = (_733 - _745) + 0.1666666716337204f;
  float _755 = (_734 - _746) + 0.1666666716337204f;
  float _759 = (_732 - _747) + 0.3333333432674408f;
  float _760 = (_733 - _748) + 0.3333333432674408f;
  float _761 = (_734 - _749) + 0.3333333432674408f;
  float _762 = _732 + -0.5f;
  float _763 = _733 + -0.5f;
  float _764 = _734 + -0.5f;
  float _774 = _725 - (floor(_725 * 0.0034602077212184668f) * 289.0f);
  float _775 = _726 - (floor(_726 * 0.0034602077212184668f) * 289.0f);
  float _776 = _727 - (floor(_727 * 0.0034602077212184668f) * 289.0f);
  float _777 = _776 + _746;
  float _778 = _776 + _749;
  float _779 = _776 + 1.0f;
  float _788 = ((_776 * 34.0f) + 1.0f) * _776;
  float _789 = ((_777 * 34.0f) + 1.0f) * _777;
  float _790 = ((_778 * 34.0f) + 1.0f) * _778;
  float _791 = ((_779 * 34.0f) + 1.0f) * _779;
  float _805 = (_788 - (floor(_788 * 0.0034602077212184668f) * 289.0f)) + _775;
  float _808 = ((_775 + _745) - (floor(_789 * 0.0034602077212184668f) * 289.0f)) + _789;
  float _811 = ((_775 + _748) - (floor(_790 * 0.0034602077212184668f) * 289.0f)) + _790;
  float _814 = ((_775 + 1.0f) - (floor(_791 * 0.0034602077212184668f) * 289.0f)) + _791;
  float _823 = ((_805 * 34.0f) + 1.0f) * _805;
  float _824 = ((_808 * 34.0f) + 1.0f) * _808;
  float _825 = ((_811 * 34.0f) + 1.0f) * _811;
  float _826 = ((_814 * 34.0f) + 1.0f) * _814;
  float _840 = (_823 - (floor(_823 * 0.0034602077212184668f) * 289.0f)) + _774;
  float _843 = ((_774 + _744) - (floor(_824 * 0.0034602077212184668f) * 289.0f)) + _824;
  float _846 = ((_774 + _747) - (floor(_825 * 0.0034602077212184668f) * 289.0f)) + _825;
  float _849 = ((_774 + 1.0f) - (floor(_826 * 0.0034602077212184668f) * 289.0f)) + _826;
  float _858 = ((_840 * 34.0f) + 1.0f) * _840;
  float _859 = ((_843 * 34.0f) + 1.0f) * _843;
  float _860 = ((_846 * 34.0f) + 1.0f) * _846;
  float _861 = ((_849 * 34.0f) + 1.0f) * _849;
  float _874 = _858 - (floor(_858 * 0.0034602077212184668f) * 289.0f);
  float _875 = _859 - (floor(_859 * 0.0034602077212184668f) * 289.0f);
  float _876 = _860 - (floor(_860 * 0.0034602077212184668f) * 289.0f);
  float _877 = _861 - (floor(_861 * 0.0034602077212184668f) * 289.0f);
  float _890 = _874 - (floor(_874 * 0.020408164709806442f) * 49.0f);
  float _891 = _875 - (floor(_875 * 0.020408164709806442f) * 49.0f);
  float _892 = _876 - (floor(_876 * 0.020408164709806442f) * 49.0f);
  float _893 = _877 - (floor(_877 * 0.020408164709806442f) * 49.0f);
  float _898 = floor(_890 * 0.1428571492433548f);
  float _899 = floor(_891 * 0.1428571492433548f);
  float _900 = floor(_892 * 0.1428571492433548f);
  float _901 = floor(_893 * 0.1428571492433548f);
  float _918 = (_898 * 0.2857142984867096f) + -0.9285714030265808f;
  float _919 = (_899 * 0.2857142984867096f) + -0.9285714030265808f;
  float _920 = (_900 * 0.2857142984867096f) + -0.9285714030265808f;
  float _921 = (_901 * 0.2857142984867096f) + -0.9285714030265808f;
  float _926 = (floor(_890 - (_898 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _927 = (floor(_891 - (_899 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _928 = (floor(_892 - (_900 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _929 = (floor(_893 - (_901 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _942 = (1.0f - abs(_918)) - abs(_926);
  float _943 = (1.0f - abs(_919)) - abs(_927);
  float _944 = (1.0f - abs(_920)) - abs(_928);
  float _945 = (1.0f - abs(_921)) - abs(_929);
  float _974 = select((_942 > 0.0f), -0.0f, -1.0f);
  float _975 = select((_943 > 0.0f), -0.0f, -1.0f);
  float _976 = select((_944 > 0.0f), -0.0f, -1.0f);
  float _977 = select((_945 > 0.0f), -0.0f, -1.0f);
  float _982 = (((floor(_918) * 2.0f) + 1.0f) * _974) + _918;
  float _983 = (((floor(_926) * 2.0f) + 1.0f) * _974) + _926;
  float _984 = (((floor(_919) * 2.0f) + 1.0f) * _975) + _919;
  float _985 = (((floor(_927) * 2.0f) + 1.0f) * _975) + _927;
  float _990 = (((floor(_920) * 2.0f) + 1.0f) * _976) + _920;
  float _991 = (((floor(_928) * 2.0f) + 1.0f) * _976) + _928;
  float _992 = (((floor(_921) * 2.0f) + 1.0f) * _977) + _921;
  float _993 = (((floor(_929) * 2.0f) + 1.0f) * _977) + _929;
  float _1002 = 1.7928400039672852f - (dot(float3(_982, _983, _942), float3(_982, _983, _942)) * 0.8537350296974182f);
  float _1003 = 1.7928400039672852f - (dot(float3(_984, _985, _943), float3(_984, _985, _943)) * 0.8537350296974182f);
  float _1004 = 1.7928400039672852f - (dot(float3(_990, _991, _944), float3(_990, _991, _944)) * 0.8537350296974182f);
  float _1005 = 1.7928400039672852f - (dot(float3(_992, _993, _945), float3(_992, _993, _945)) * 0.8537350296974182f);
  float _1026 = max((0.6000000238418579f - dot(float3(_732, _733, _734), float3(_732, _733, _734))), 0.0f);
  float _1027 = max((0.6000000238418579f - dot(float3(_753, _754, _755), float3(_753, _754, _755))), 0.0f);
  float _1028 = max((0.6000000238418579f - dot(float3(_759, _760, _761), float3(_759, _760, _761))), 0.0f);
  float _1029 = max((0.6000000238418579f - dot(float3(_762, _763, _764), float3(_762, _763, _764))), 0.0f);
  float _1030 = _1026 * _1026;
  float _1031 = _1027 * _1027;
  float _1032 = _1028 * _1028;
  float _1033 = _1029 * _1029;
  float _1048 = saturate((((sin((_348 * 2.5f) - _372) * 0.15000000596046448f) + 0.050000011920928955f) + (dot(float4((_1030 * _1030), (_1031 * _1031), (_1032 * _1032), (_1033 * _1033)), float4(dot(float3((_1002 * _982), (_1002 * _983), (_1002 * _942)), float3(_732, _733, _734)), dot(float3((_1003 * _984), (_1003 * _985), (_1003 * _943)), float3(_753, _754, _755)), dot(float3((_1004 * _990), (_1004 * _991), (_1004 * _944)), float3(_759, _760, _761)), dot(float3((_1005 * _992), (_1005 * _993), (_1005 * _945)), float3(_762, _763, _764)))) * 21.0f)) * 4.0f);
  float _1052 = (_1048 * _1048) * (3.0f - (_1048 * 2.0f));
  float _1054 = (_1052 * 0.6499999761581421f) + 0.3499999940395355f;
  float _1061 = frame_consts.time * 0.15000000596046448f;
  float _1062 = (_349 * 0.04444444552063942f) - _1061;
  float _1063 = _376 - _1061;
  float _1064 = frame_consts.time * 0.02500000037252903f;
  float _1065 = dot(float3(_1062, _1063, _1064), float3(0.3333333432674408f, 0.3333333432674408f, 0.3333333432674408f));
  float _1069 = floor(_1062 + _1065);
  float _1070 = floor(_1063 + _1065);
  float _1071 = floor(_1064 + _1065);
  float _1075 = dot(float3(_1069, _1070, _1071), float3(0.1666666716337204f, 0.1666666716337204f, 0.1666666716337204f));
  float _1076 = _1075 + (_1062 - _1069);
  float _1077 = _1075 + (_1063 - _1070);
  float _1078 = (_1064 - _1071) + _1075;
  float _1082 = select((_1076 < _1077), 0.0f, 1.0f);
  float _1083 = select((_1077 < _1078), 0.0f, 1.0f);
  float _1084 = select((_1078 < _1076), 0.0f, 1.0f);
  float _1085 = 1.0f - _1082;
  float _1086 = 1.0f - _1083;
  float _1087 = 1.0f - _1084;
  float _1088 = min(_1082, _1087);
  float _1089 = min(_1083, _1085);
  float _1090 = min(_1084, _1086);
  float _1091 = max(_1082, _1087);
  float _1092 = max(_1083, _1085);
  float _1093 = max(_1084, _1086);
  float _1097 = (_1076 - _1088) + 0.1666666716337204f;
  float _1098 = (_1077 - _1089) + 0.1666666716337204f;
  float _1099 = (_1078 - _1090) + 0.1666666716337204f;
  float _1103 = (_1076 - _1091) + 0.3333333432674408f;
  float _1104 = (_1077 - _1092) + 0.3333333432674408f;
  float _1105 = (_1078 - _1093) + 0.3333333432674408f;
  float _1106 = _1076 + -0.5f;
  float _1107 = _1077 + -0.5f;
  float _1108 = _1078 + -0.5f;
  float _1118 = _1069 - (floor(_1069 * 0.0034602077212184668f) * 289.0f);
  float _1119 = _1070 - (floor(_1070 * 0.0034602077212184668f) * 289.0f);
  float _1120 = _1071 - (floor(_1071 * 0.0034602077212184668f) * 289.0f);
  float _1121 = _1120 + _1090;
  float _1122 = _1120 + _1093;
  float _1123 = _1120 + 1.0f;
  float _1132 = ((_1120 * 34.0f) + 1.0f) * _1120;
  float _1133 = ((_1121 * 34.0f) + 1.0f) * _1121;
  float _1134 = ((_1122 * 34.0f) + 1.0f) * _1122;
  float _1135 = ((_1123 * 34.0f) + 1.0f) * _1123;
  float _1149 = (_1132 - (floor(_1132 * 0.0034602077212184668f) * 289.0f)) + _1119;
  float _1152 = ((_1119 + _1089) - (floor(_1133 * 0.0034602077212184668f) * 289.0f)) + _1133;
  float _1155 = ((_1119 + _1092) - (floor(_1134 * 0.0034602077212184668f) * 289.0f)) + _1134;
  float _1158 = ((_1119 + 1.0f) - (floor(_1135 * 0.0034602077212184668f) * 289.0f)) + _1135;
  float _1167 = ((_1149 * 34.0f) + 1.0f) * _1149;
  float _1168 = ((_1152 * 34.0f) + 1.0f) * _1152;
  float _1169 = ((_1155 * 34.0f) + 1.0f) * _1155;
  float _1170 = ((_1158 * 34.0f) + 1.0f) * _1158;
  float _1184 = (_1167 - (floor(_1167 * 0.0034602077212184668f) * 289.0f)) + _1118;
  float _1187 = ((_1118 + _1088) - (floor(_1168 * 0.0034602077212184668f) * 289.0f)) + _1168;
  float _1190 = ((_1118 + _1091) - (floor(_1169 * 0.0034602077212184668f) * 289.0f)) + _1169;
  float _1193 = ((_1118 + 1.0f) - (floor(_1170 * 0.0034602077212184668f) * 289.0f)) + _1170;
  float _1202 = ((_1184 * 34.0f) + 1.0f) * _1184;
  float _1203 = ((_1187 * 34.0f) + 1.0f) * _1187;
  float _1204 = ((_1190 * 34.0f) + 1.0f) * _1190;
  float _1205 = ((_1193 * 34.0f) + 1.0f) * _1193;
  float _1218 = _1202 - (floor(_1202 * 0.0034602077212184668f) * 289.0f);
  float _1219 = _1203 - (floor(_1203 * 0.0034602077212184668f) * 289.0f);
  float _1220 = _1204 - (floor(_1204 * 0.0034602077212184668f) * 289.0f);
  float _1221 = _1205 - (floor(_1205 * 0.0034602077212184668f) * 289.0f);
  float _1234 = _1218 - (floor(_1218 * 0.020408164709806442f) * 49.0f);
  float _1235 = _1219 - (floor(_1219 * 0.020408164709806442f) * 49.0f);
  float _1236 = _1220 - (floor(_1220 * 0.020408164709806442f) * 49.0f);
  float _1237 = _1221 - (floor(_1221 * 0.020408164709806442f) * 49.0f);
  float _1242 = floor(_1234 * 0.1428571492433548f);
  float _1243 = floor(_1235 * 0.1428571492433548f);
  float _1244 = floor(_1236 * 0.1428571492433548f);
  float _1245 = floor(_1237 * 0.1428571492433548f);
  float _1262 = (_1242 * 0.2857142984867096f) + -0.9285714030265808f;
  float _1263 = (_1243 * 0.2857142984867096f) + -0.9285714030265808f;
  float _1264 = (_1244 * 0.2857142984867096f) + -0.9285714030265808f;
  float _1265 = (_1245 * 0.2857142984867096f) + -0.9285714030265808f;
  float _1270 = (floor(_1234 - (_1242 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _1271 = (floor(_1235 - (_1243 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _1272 = (floor(_1236 - (_1244 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _1273 = (floor(_1237 - (_1245 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _1286 = (1.0f - abs(_1262)) - abs(_1270);
  float _1287 = (1.0f - abs(_1263)) - abs(_1271);
  float _1288 = (1.0f - abs(_1264)) - abs(_1272);
  float _1289 = (1.0f - abs(_1265)) - abs(_1273);
  float _1318 = select((_1286 > 0.0f), -0.0f, -1.0f);
  float _1319 = select((_1287 > 0.0f), -0.0f, -1.0f);
  float _1320 = select((_1288 > 0.0f), -0.0f, -1.0f);
  float _1321 = select((_1289 > 0.0f), -0.0f, -1.0f);
  float _1326 = (((floor(_1262) * 2.0f) + 1.0f) * _1318) + _1262;
  float _1327 = (((floor(_1270) * 2.0f) + 1.0f) * _1318) + _1270;
  float _1328 = (((floor(_1263) * 2.0f) + 1.0f) * _1319) + _1263;
  float _1329 = (((floor(_1271) * 2.0f) + 1.0f) * _1319) + _1271;
  float _1334 = (((floor(_1264) * 2.0f) + 1.0f) * _1320) + _1264;
  float _1335 = (((floor(_1272) * 2.0f) + 1.0f) * _1320) + _1272;
  float _1336 = (((floor(_1265) * 2.0f) + 1.0f) * _1321) + _1265;
  float _1337 = (((floor(_1273) * 2.0f) + 1.0f) * _1321) + _1273;
  float _1346 = 1.7928400039672852f - (dot(float3(_1326, _1327, _1286), float3(_1326, _1327, _1286)) * 0.8537350296974182f);
  float _1347 = 1.7928400039672852f - (dot(float3(_1328, _1329, _1287), float3(_1328, _1329, _1287)) * 0.8537350296974182f);
  float _1348 = 1.7928400039672852f - (dot(float3(_1334, _1335, _1288), float3(_1334, _1335, _1288)) * 0.8537350296974182f);
  float _1349 = 1.7928400039672852f - (dot(float3(_1336, _1337, _1289), float3(_1336, _1337, _1289)) * 0.8537350296974182f);
  float _1370 = max((0.6000000238418579f - dot(float3(_1076, _1077, _1078), float3(_1076, _1077, _1078))), 0.0f);
  float _1371 = max((0.6000000238418579f - dot(float3(_1097, _1098, _1099), float3(_1097, _1098, _1099))), 0.0f);
  float _1372 = max((0.6000000238418579f - dot(float3(_1103, _1104, _1105), float3(_1103, _1104, _1105))), 0.0f);
  float _1373 = max((0.6000000238418579f - dot(float3(_1106, _1107, _1108), float3(_1106, _1107, _1108))), 0.0f);
  float _1374 = _1370 * _1370;
  float _1375 = _1371 * _1371;
  float _1376 = _1372 * _1372;
  float _1377 = _1373 * _1373;
  float _1392 = saturate((((sin(_371 - (frame_consts.time * 1.5f)) * 0.15000000596046448f) + 0.050000011920928955f) + (dot(float4((_1374 * _1374), (_1375 * _1375), (_1376 * _1376), (_1377 * _1377)), float4(dot(float3((_1346 * _1326), (_1346 * _1327), (_1346 * _1286)), float3(_1076, _1077, _1078)), dot(float3((_1347 * _1328), (_1347 * _1329), (_1347 * _1287)), float3(_1097, _1098, _1099)), dot(float3((_1348 * _1334), (_1348 * _1335), (_1348 * _1288)), float3(_1103, _1104, _1105)), dot(float3((_1349 * _1336), (_1349 * _1337), (_1349 * _1289)), float3(_1106, _1107, _1108)))) * 21.0f)) * 4.0f);
  float _1396 = (_1392 * _1392) * (3.0f - (_1392 * 2.0f));
  float _1398 = (_1396 * 0.6499999761581421f) + 0.3499999940395355f;
  float _1420 = saturate(_714);
  float _1421 = saturate(_1054);
  float _1443 = (((_258 * 1.2000000476837158f) * _263) * frame_consts.params.vignette.golden_intensity) * ((((saturate(11.0f - (sqrt((_355 * _355) + (_354 * _354)) / ((_1052 * 0.039000000804662704f) + 0.08100000768899918f))) * _1054) + (saturate(11.0f - (sqrt((_350 * _350) + _360) / ((_712 * 0.039000000804662704f) + 0.08100000768899918f))) * _714)) + (saturate(11.0f - (sqrt((_367 * _367) + _360) / ((_1396 * 0.039000000804662704f) + 0.08100000768899918f))) * _1398)) + (((((saturate(1.0f - (abs(_351) * 0.8333333134651184f)) * _1420) + (saturate(1.0f - (abs(dot(float2(_354, _355), float2(-0.8660253882408142f, 0.5f))) * 0.8333333134651184f)) * _1421)) * saturate(_1398)) + ((_1420 * saturate(1.0f - (abs(dot(float2(_350, _351), float2(0.8660253882408142f, 0.5f))) * 0.8333333134651184f))) * _1421)) * 0.5f));
  SV_Target.x = ((_1443 * ((_310 * _310) - _272)) + _272);
  SV_Target.y = ((_1443 * ((_311 * _311) - _273)) + _273);
  SV_Target.z = ((_1443 * ((_312 * _312) - _274)) + _274);
  if (RENODX_TONE_MAP_TYPE) {
    SV_Target.rgb = renodx::draw::ToneMapPass(_28.rgb, SV_Target.rgb);
  } else {
    SV_Target.rgb = saturate(SV_Target.rgb);
  }
  SV_Target.rgb = renodx::draw::RenderIntermediatePass(SV_Target.rgb);

  SV_Target.w = 1.0f;
  return SV_Target;
}
