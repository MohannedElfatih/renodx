#include "../shared.h"

struct Lod_params {
  struct Lod_brush_params {
    float4 brush_uv[4];
    float base_radius;
    float radius_variation;
    float radius_random;
    float blur;
    float alpha;
    float stretch;
  } brushes;
  struct Lod_noise_params {
    float chaos;
    float freq;
    float brightness;
    float saturation;
    float hue;
  } noise;
  struct Lod_outlines_params {
    float2 thickness;
    float2 softness;
    float2 displacement;
    float2 attenuation;
    float lighting_threshold;
    float lighting_threshold_softness;
    float2 lighting_dark;
    float2 lighting_bright;
    float2 discretion;
    float2 alpha;
  } outlines;
};

struct Frame_constants {
  float3 cam_world_pos;
  float time;
  float2 inv_near_dim;
  float proj_scale;
  uint flags;
  float2 half_vp_dim;
  int2 vp_dim;
  float2 vp_texel_size;
  int2 mouse_pos;
  int2 inspected_pix;
  int2 hi_z_0_dim;
  int supersampling;
  int debug_patches;
  int use_patches;
  int emissive;
  float3 target;
  uint frame_number;
  uint shot_frame_number;
  float dt;
  float4 view_to_world[4];
  float4 world_to_view[4];
  float4 view_ndc[4];
  float4 world_ndc[4];
  float4 prev_world_ndc[4];
  float4 ndc_world[4];
  float4 ndc_to_prev_ndc[4];
  float4 prev_ndc_to_ndc[4];
  float4 view_world_z0;
  float4 pix_to_fog_eq;
  float3 mio_view;
  float3 mio_hair_outline_color;
  float mio_foliage_velocity;
  int show_wireframe;
  int ao;
  int glitch;
  int no_vertex_color;
  float paper_mult;
  int hatching;
  int mio_halo;
  int vol_temporal;
  int heart_attack_active;
  int heart_attack_secondary_target;
  int triangular_dissolve_enabled;
  int color_correct;
  float starfield_effect_amount;
  float starfield_fade_amount;
  float3 starfield_center_view;
  float starfield_glow_amount;
  float starfield_pulse_t;
  float death_anim_t;
  float3 game_plane_world_origin;
  float3 game_plane_world_normal;
  float3 game_plane_world_u;
  float3 game_plane_world_v;
  float4 game_plane_transform[4];
  float4 hatching_xf[4];
  float4 paper_xf[4];
  float2 game_plane_blend;
  float heart_attack_t;
  float heart_attack_duration;
  float heart_attack_pulse;
  float heart_attack_outline_distance;
  float heart_attack_dissolve_distance;
  float3 heart_attack_dissolve_color;
  float heart_attack_dissolve_base;
  float heart_attack_dissolve_mult;
  float3 heart_attack_dissolve_world_center;
  float heart_attack_vertical_dissolve;
  float triangular_dissolve_base_amount;
  float triangular_dissolve_amount;
  float flashback_lut;
  float evil_mio;
  float dead_mio;
  float godlike_mio;
  float khlia_pulse_t;
  float khlia__pulse_t;
  float khlia_pulse_period;
  float3 khlia_world_pos;
  float skydome_rotation_offset;
  float hatch_ambiant_mul;
  float hatch_ambiant_add;
  float glitch_scale;
  uint max_contours;
  uint max_contour_loops;
  int death_screen;
  float death_screen_t;
  int poetic_death_screen;
  float poetic_death_screen_t;
  float tremor_pulse_t;
  int invert;
  float surface_fade;
  struct Postprocess_params {
    struct AO_params {
      float3 color;
      float intensity;
    } ao;
    struct Fog_params {
      float bloom_factor;
      float space;
      float outline_density;
      float outline_attenuation;
    } fog;
    struct Ambient_light_params {
      int undercoat_grad;
      float3 color;
      float intensity;
      float gameplay_intensity;
      float gameplay_width;
      float directional_intensity;
      float directional_shadows;
      float undercoat_noise_freq;
      float undercoat_noise_amplitude;
      float undercoat_noise_threshold;
      float undercoating;
    } ambient_light;
    struct Vignette_params {
      float intensity;
      float rounded;
      float3 color;
      float golden_intensity;
      float golden_color;
    } vignette;
    struct Bloom_params {
      float intensity;
      float threshold_low;
      float threshold_high;
    } bloom;
    struct Mio_params {
      float light_intensity;
      float light_radius;
      float3 light_color;
      float spec_intensity;
      float3 halo_color;
      float halo_intensity;
    } mio;
    struct Particles_params {
      uint count;
      float cam_near;
      float cam_far;
      float fadeoff_near;
      float2 lifetime;
      float fadein_duration;
      float fadeoff_duration;
      float2 alpha;
      float2 scale;
      float2 speed;
      int gradient;
      float circle_attenuation;
    } particles;
    struct Chroma_aberration_params {
      float intensity;
    } chroma_aberration;
    struct Fade_params {
      float intensity;
      float3 color;
    } fade;
    struct Dof_params {
      float plane_01;
      float plane_01_softness;
      float plane_12;
      float plane_12_softness;
      float foreground;
      float foreground_softness;
    } dof;
    Lod_params lod_foreground;
    Lod_params lod_game;
    Lod_params lod_midground;
    Lod_params lod_background;
  } params;
};


Texture2D<float4> tex : register(t0);

Texture2D<float> depth_tex : register(t1);

Texture2D<float2> distortion : register(t4);

Texture2D<float> paper_tex : register(t5);

Texture2D<float3> bloom_tex : register(t7);

cbuffer frame_consts : register(b0) {
  Frame_constants frame_consts : packoffset(c000.x);
};

SamplerState sampler_nearest : register(s0);

SamplerState sampler_bilinear : register(s1);

SamplerState sampler_bilinear_wrap : register(s2);

float4 main(
  noperspective float4 SV_Position : SV_Position,
  linear float2 O_Uv : O_Uv
) : SV_Target {
  float4 SV_Target;
  float _15 = float((int)(frame_consts.vp_dim.x));
  float _16 = float((int)(frame_consts.vp_dim.y));
  float2 _17 = distortion.SampleLevel(sampler_nearest, float2(O_Uv.x, O_Uv.y), 0.0f);
  float _20 = _16 / _15;
  float _25 = saturate((_17.x * _20) + O_Uv.x);
  float _26 = saturate((_17.y * _20) + O_Uv.y);
  float4 _27 = tex.SampleLevel(sampler_nearest, float2(_25, _26), 0.0f);
  float3 _31 = bloom_tex.SampleLevel(sampler_bilinear, float2(_25, _26), 0.0f);
  float _46 = max((((1.0f - (_27.y * 0.7152000069618225f)) - (_27.x * 0.2125999927520752f)) - (_27.z * 0.0722000002861023f)), 0.0010000000474974513f);
  float _50 = (_27.x / _46) + (frame_consts.params.bloom.intensity * _31.x);
  float _51 = (_27.y / _46) + (frame_consts.params.bloom.intensity * _31.y);
  float _52 = (_27.z / _46) + (frame_consts.params.bloom.intensity * _31.z);
  float _58 = (((_50 * 0.2125999927520752f) + 1.0f) + (_51 * 0.7152000069618225f)) + (_52 * 0.0722000002861023f);
  float _62 = saturate(_50 / _58);
  float _63 = saturate(_51 / _58);
  float _64 = saturate(_52 / _58);
  float _70 = depth_tex.SampleLevel(sampler_nearest, float2(_25, _26), 0.0f);
  float _74 = 10000.0f / ((_70.x * 19999.5f) + 0.5f);
  float _79 = (_74 * ((_25 * 2.0f) + -1.0f)) * frame_consts.inv_near_dim.x;
  float _81 = (_74 * (((1.0f - _26) * 2.0f) + -1.0f)) * frame_consts.inv_near_dim.y;
  float _82 = -0.0f - _74;
  float _106 = mad((frame_consts.paper_xf[2].z), _82, mad((frame_consts.paper_xf[1].z), _81, (_79 * (frame_consts.paper_xf[0].z))));
  float _107 = mad((frame_consts.paper_xf[2].x), _82, mad((frame_consts.paper_xf[1].x), _81, (_79 * (frame_consts.paper_xf[0].x)))) / _106;
  float _108 = mad((frame_consts.paper_xf[2].y), _82, mad((frame_consts.paper_xf[1].y), _81, (_79 * (frame_consts.paper_xf[0].y)))) / _106;
  float _120 = exp2(round(log2(max(5.0f, (-0.0f - (_106 - frame_consts.game_plane_blend.x)))) * 10.0f) * 0.10000000149011612f);
  float _122 = min((1.0f / _120), 0.20000000298023224f);
  float _123 = frame_consts.game_plane_blend.x - _120;
  float _130 = frame_consts.game_plane_blend.x + 10.0f;
  float _138 = exp2(round(log2(max(5.0f, (-0.0f - (_106 - _130)))) * 10.0f) * 0.10000000149011612f);
  float _140 = min((1.0f / _138), 0.20000000298023224f);
  float _141 = _130 - _138;
  float _148 = paper_tex.SampleLevel(sampler_bilinear_wrap, float2((((_123 * _107) + (frame_consts.paper_xf[3].x)) * _122), (((_123 * _108) + (frame_consts.paper_xf[3].y)) * _122)), 0.0f);
  float _151 = paper_tex.SampleLevel(sampler_bilinear_wrap, float2((((_141 * _107) + (frame_consts.paper_xf[3].x)) * _140), (((_141 * _108) + (frame_consts.paper_xf[3].y)) * _140)), 0.0f);
  float _158 = ((1.0f - (_148.x * (1.0f - frame_consts.game_plane_blend.y))) - (_151.x * frame_consts.game_plane_blend.y)) * frame_consts.paper_mult;
  float _173 = _15 / _16;
  float _185 = exp2(log2(saturate((frame_consts.params.vignette.intensity * abs(_25 + -0.5f)) * (((_173 + -1.0f) * frame_consts.params.vignette.rounded) + 1.0f))) * 5.0f);
  float _186 = exp2(log2(saturate(frame_consts.params.vignette.intensity * abs(_26 + -0.5f))) * 5.0f);
  float _192 = exp2(log2(saturate(1.0f - dot(float2(_185, _186), float2(_185, _186)))) * 6.0f);
  float _197 = 1.0f - _192;
  float _199 = 1.0f - (_197 * 0.8500000238418579f);
  float _206 = (_199 * ((_62 - (_158 * _62)) - frame_consts.params.vignette.color.x)) + frame_consts.params.vignette.color.x;
  float _207 = (_199 * ((_63 - (_158 * _63)) - frame_consts.params.vignette.color.y)) + frame_consts.params.vignette.color.y;
  float _208 = (_199 * ((_64 - (_158 * _64)) - frame_consts.params.vignette.color.z)) + frame_consts.params.vignette.color.z;
  float _212 = _25 * _15;
  float _213 = _26 * _16;
  float _214 = _213 + _212;
  float _220 = frac(_214 * 0.0033333334140479565f) + -0.5f;
  float _221 = frac((_213 - _212) * 0.0033333334140479565f) + -0.5f;
  float _227 = saturate(sqrt((_221 * _221) + (_220 * _220)) * 2.0f);
  float _238 = saturate((sin((_214 * 0.01666666753590107f) - (frame_consts.time * 0.8500000238418579f)) * 1.2500001192092896f) + -0.25000008940696716f);
  float _243 = ((_238 * _238) * 0.2199999988079071f) * (3.0f - (_238 * 2.0f));
  float _244 = _243 + 0.9777389168739319f;
  float _245 = ((_227 * 0.13274884223937988f) + 0.7175776362419128f) + _243;
  float _246 = ((_227 * 0.3335757553577423f) + 0.30871906876564026f) + _243;
  float _251 = (_25 * 1080.0f) * _173;
  float _252 = _26 * 1080.0f;
  float _253 = _251 * 0.04444444552063942f;
  float _254 = _26 * 27.712812423706055f;
  float _256 = ceil(_253 - _254);
  float _259 = floor(_26 * 55.42562484741211f) + 1.0f;
  float _262 = ceil((-0.0f - _254) - _253);
  float _264 = (_259 + _256) + _262;
  float _266 = (_264 * 22.5f) + -33.75f;
  float _267 = _256 - _262;
  float _269 = _267 * 11.25f;
  float _275 = (((_259 * 0.5773502588272095f) - (_256 * 0.28867512941360474f)) - (_262 * 0.28867512941360474f)) * 22.5f;
  float _278 = _266 + _269;
  float _279 = _275 + (19.485570907592773f - (_264 * 12.990381240844727f));
  float _282 = ((_264 * 25.980762481689453f) + -38.97114181518555f) + _275;
  float _283 = _269 - _266;
  float _284 = _278 - _251;
  float _285 = _279 - _252;
  float _288 = _269 - _251;
  float _289 = _282 - _252;
  float _294 = _285 * _285;
  float _301 = _283 - _251;
  float _305 = _279 * 2.5f;
  float _306 = frame_consts.time * 1.5f;
  float _310 = _279 * 0.004444444552063942f;
  float _311 = frame_consts.time * 0.15000000596046448f;
  float _312 = (_278 * 0.04444444552063942f) - _311;
  float _313 = _310 - _311;
  float _314 = frame_consts.time * 0.02500000037252903f;
  float _315 = dot(float3(_312, _313, _314), float3(0.3333333432674408f, 0.3333333432674408f, 0.3333333432674408f));
  float _319 = floor(_315 + _312);
  float _320 = floor(_315 + _313);
  float _321 = floor(_315 + _314);
  float _325 = dot(float3(_319, _320, _321), float3(0.1666666716337204f, 0.1666666716337204f, 0.1666666716337204f));
  float _326 = _325 + (_312 - _319);
  float _327 = _325 + (_313 - _320);
  float _328 = (_314 - _321) + _325;
  float _332 = select((_326 < _327), 0.0f, 1.0f);
  float _333 = select((_327 < _328), 0.0f, 1.0f);
  float _334 = select((_328 < _326), 0.0f, 1.0f);
  float _335 = 1.0f - _332;
  float _336 = 1.0f - _333;
  float _337 = 1.0f - _334;
  float _338 = min(_332, _337);
  float _339 = min(_333, _335);
  float _340 = min(_334, _336);
  float _341 = max(_332, _337);
  float _342 = max(_333, _335);
  float _343 = max(_334, _336);
  float _347 = (_326 - _338) + 0.1666666716337204f;
  float _348 = (_327 - _339) + 0.1666666716337204f;
  float _349 = (_328 - _340) + 0.1666666716337204f;
  float _353 = (_326 - _341) + 0.3333333432674408f;
  float _354 = (_327 - _342) + 0.3333333432674408f;
  float _355 = (_328 - _343) + 0.3333333432674408f;
  float _356 = _326 + -0.5f;
  float _357 = _327 + -0.5f;
  float _358 = _328 + -0.5f;
  float _368 = _319 - (floor(_319 * 0.0034602077212184668f) * 289.0f);
  float _369 = _320 - (floor(_320 * 0.0034602077212184668f) * 289.0f);
  float _370 = _321 - (floor(_321 * 0.0034602077212184668f) * 289.0f);
  float _371 = _370 + _340;
  float _372 = _370 + _343;
  float _373 = _370 + 1.0f;
  float _382 = ((_370 * 34.0f) + 1.0f) * _370;
  float _383 = ((_371 * 34.0f) + 1.0f) * _371;
  float _384 = ((_372 * 34.0f) + 1.0f) * _372;
  float _385 = ((_373 * 34.0f) + 1.0f) * _373;
  float _399 = (_382 - (floor(_382 * 0.0034602077212184668f) * 289.0f)) + _369;
  float _402 = ((_369 + _339) - (floor(_383 * 0.0034602077212184668f) * 289.0f)) + _383;
  float _405 = ((_369 + _342) - (floor(_384 * 0.0034602077212184668f) * 289.0f)) + _384;
  float _408 = ((_369 + 1.0f) - (floor(_385 * 0.0034602077212184668f) * 289.0f)) + _385;
  float _417 = ((_399 * 34.0f) + 1.0f) * _399;
  float _418 = ((_402 * 34.0f) + 1.0f) * _402;
  float _419 = ((_405 * 34.0f) + 1.0f) * _405;
  float _420 = ((_408 * 34.0f) + 1.0f) * _408;
  float _434 = (_417 - (floor(_417 * 0.0034602077212184668f) * 289.0f)) + _368;
  float _437 = ((_368 + _338) - (floor(_418 * 0.0034602077212184668f) * 289.0f)) + _418;
  float _440 = ((_368 + _341) - (floor(_419 * 0.0034602077212184668f) * 289.0f)) + _419;
  float _443 = ((_368 + 1.0f) - (floor(_420 * 0.0034602077212184668f) * 289.0f)) + _420;
  float _452 = ((_434 * 34.0f) + 1.0f) * _434;
  float _453 = ((_437 * 34.0f) + 1.0f) * _437;
  float _454 = ((_440 * 34.0f) + 1.0f) * _440;
  float _455 = ((_443 * 34.0f) + 1.0f) * _443;
  float _468 = _452 - (floor(_452 * 0.0034602077212184668f) * 289.0f);
  float _469 = _453 - (floor(_453 * 0.0034602077212184668f) * 289.0f);
  float _470 = _454 - (floor(_454 * 0.0034602077212184668f) * 289.0f);
  float _471 = _455 - (floor(_455 * 0.0034602077212184668f) * 289.0f);
  float _484 = _468 - (floor(_468 * 0.020408164709806442f) * 49.0f);
  float _485 = _469 - (floor(_469 * 0.020408164709806442f) * 49.0f);
  float _486 = _470 - (floor(_470 * 0.020408164709806442f) * 49.0f);
  float _487 = _471 - (floor(_471 * 0.020408164709806442f) * 49.0f);
  float _492 = floor(_484 * 0.1428571492433548f);
  float _493 = floor(_485 * 0.1428571492433548f);
  float _494 = floor(_486 * 0.1428571492433548f);
  float _495 = floor(_487 * 0.1428571492433548f);
  float _512 = (_492 * 0.2857142984867096f) + -0.9285714030265808f;
  float _513 = (_493 * 0.2857142984867096f) + -0.9285714030265808f;
  float _514 = (_494 * 0.2857142984867096f) + -0.9285714030265808f;
  float _515 = (_495 * 0.2857142984867096f) + -0.9285714030265808f;
  float _520 = (floor(_484 - (_492 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _521 = (floor(_485 - (_493 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _522 = (floor(_486 - (_494 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _523 = (floor(_487 - (_495 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _536 = (1.0f - abs(_512)) - abs(_520);
  float _537 = (1.0f - abs(_513)) - abs(_521);
  float _538 = (1.0f - abs(_514)) - abs(_522);
  float _539 = (1.0f - abs(_515)) - abs(_523);
  float _568 = select((_536 > 0.0f), -0.0f, -1.0f);
  float _569 = select((_537 > 0.0f), -0.0f, -1.0f);
  float _570 = select((_538 > 0.0f), -0.0f, -1.0f);
  float _571 = select((_539 > 0.0f), -0.0f, -1.0f);
  float _576 = (((floor(_512) * 2.0f) + 1.0f) * _568) + _512;
  float _577 = (((floor(_520) * 2.0f) + 1.0f) * _568) + _520;
  float _578 = (((floor(_513) * 2.0f) + 1.0f) * _569) + _513;
  float _579 = (((floor(_521) * 2.0f) + 1.0f) * _569) + _521;
  float _584 = (((floor(_514) * 2.0f) + 1.0f) * _570) + _514;
  float _585 = (((floor(_522) * 2.0f) + 1.0f) * _570) + _522;
  float _586 = (((floor(_515) * 2.0f) + 1.0f) * _571) + _515;
  float _587 = (((floor(_523) * 2.0f) + 1.0f) * _571) + _523;
  float _596 = 1.7928400039672852f - (dot(float3(_576, _577, _536), float3(_576, _577, _536)) * 0.8537350296974182f);
  float _597 = 1.7928400039672852f - (dot(float3(_578, _579, _537), float3(_578, _579, _537)) * 0.8537350296974182f);
  float _598 = 1.7928400039672852f - (dot(float3(_584, _585, _538), float3(_584, _585, _538)) * 0.8537350296974182f);
  float _599 = 1.7928400039672852f - (dot(float3(_586, _587, _539), float3(_586, _587, _539)) * 0.8537350296974182f);
  float _620 = max((0.6000000238418579f - dot(float3(_326, _327, _328), float3(_326, _327, _328))), 0.0f);
  float _621 = max((0.6000000238418579f - dot(float3(_347, _348, _349), float3(_347, _348, _349))), 0.0f);
  float _622 = max((0.6000000238418579f - dot(float3(_353, _354, _355), float3(_353, _354, _355))), 0.0f);
  float _623 = max((0.6000000238418579f - dot(float3(_356, _357, _358), float3(_356, _357, _358))), 0.0f);
  float _624 = _620 * _620;
  float _625 = _621 * _621;
  float _626 = _622 * _622;
  float _627 = _623 * _623;
  float _642 = saturate((((sin(_305 - _306) * 0.15000000596046448f) + 0.050000011920928955f) + (dot(float4((_624 * _624), (_625 * _625), (_626 * _626), (_627 * _627)), float4(dot(float3((_596 * _576), (_596 * _577), (_596 * _536)), float3(_326, _327, _328)), dot(float3((_597 * _578), (_597 * _579), (_597 * _537)), float3(_347, _348, _349)), dot(float3((_598 * _584), (_598 * _585), (_598 * _538)), float3(_353, _354, _355)), dot(float3((_599 * _586), (_599 * _587), (_599 * _539)), float3(_356, _357, _358)))) * 21.0f)) * 4.0f);
  float _646 = (_642 * _642) * (3.0f - (_642 * 2.0f));
  float _648 = (_646 * 0.6499999761581421f) + 0.3499999940395355f;
  float _653 = (_267 * 0.5f) - _311;
  float _654 = (_282 * 0.004444444552063942f) - _311;
  float _655 = dot(float3(_653, _654, _314), float3(0.3333333432674408f, 0.3333333432674408f, 0.3333333432674408f));
  float _659 = floor(_655 + _653);
  float _660 = floor(_655 + _654);
  float _661 = floor(_655 + _314);
  float _665 = dot(float3(_659, _660, _661), float3(0.1666666716337204f, 0.1666666716337204f, 0.1666666716337204f));
  float _666 = _665 + (_653 - _659);
  float _667 = _665 + (_654 - _660);
  float _668 = (_314 - _661) + _665;
  float _672 = select((_666 < _667), 0.0f, 1.0f);
  float _673 = select((_667 < _668), 0.0f, 1.0f);
  float _674 = select((_668 < _666), 0.0f, 1.0f);
  float _675 = 1.0f - _672;
  float _676 = 1.0f - _673;
  float _677 = 1.0f - _674;
  float _678 = min(_672, _677);
  float _679 = min(_673, _675);
  float _680 = min(_674, _676);
  float _681 = max(_672, _677);
  float _682 = max(_673, _675);
  float _683 = max(_674, _676);
  float _687 = (_666 - _678) + 0.1666666716337204f;
  float _688 = (_667 - _679) + 0.1666666716337204f;
  float _689 = (_668 - _680) + 0.1666666716337204f;
  float _693 = (_666 - _681) + 0.3333333432674408f;
  float _694 = (_667 - _682) + 0.3333333432674408f;
  float _695 = (_668 - _683) + 0.3333333432674408f;
  float _696 = _666 + -0.5f;
  float _697 = _667 + -0.5f;
  float _698 = _668 + -0.5f;
  float _708 = _659 - (floor(_659 * 0.0034602077212184668f) * 289.0f);
  float _709 = _660 - (floor(_660 * 0.0034602077212184668f) * 289.0f);
  float _710 = _661 - (floor(_661 * 0.0034602077212184668f) * 289.0f);
  float _711 = _710 + _680;
  float _712 = _710 + _683;
  float _713 = _710 + 1.0f;
  float _722 = ((_710 * 34.0f) + 1.0f) * _710;
  float _723 = ((_711 * 34.0f) + 1.0f) * _711;
  float _724 = ((_712 * 34.0f) + 1.0f) * _712;
  float _725 = ((_713 * 34.0f) + 1.0f) * _713;
  float _739 = (_722 - (floor(_722 * 0.0034602077212184668f) * 289.0f)) + _709;
  float _742 = ((_709 + _679) - (floor(_723 * 0.0034602077212184668f) * 289.0f)) + _723;
  float _745 = ((_709 + _682) - (floor(_724 * 0.0034602077212184668f) * 289.0f)) + _724;
  float _748 = ((_709 + 1.0f) - (floor(_725 * 0.0034602077212184668f) * 289.0f)) + _725;
  float _757 = ((_739 * 34.0f) + 1.0f) * _739;
  float _758 = ((_742 * 34.0f) + 1.0f) * _742;
  float _759 = ((_745 * 34.0f) + 1.0f) * _745;
  float _760 = ((_748 * 34.0f) + 1.0f) * _748;
  float _774 = (_757 - (floor(_757 * 0.0034602077212184668f) * 289.0f)) + _708;
  float _777 = ((_708 + _678) - (floor(_758 * 0.0034602077212184668f) * 289.0f)) + _758;
  float _780 = ((_708 + _681) - (floor(_759 * 0.0034602077212184668f) * 289.0f)) + _759;
  float _783 = ((_708 + 1.0f) - (floor(_760 * 0.0034602077212184668f) * 289.0f)) + _760;
  float _792 = ((_774 * 34.0f) + 1.0f) * _774;
  float _793 = ((_777 * 34.0f) + 1.0f) * _777;
  float _794 = ((_780 * 34.0f) + 1.0f) * _780;
  float _795 = ((_783 * 34.0f) + 1.0f) * _783;
  float _808 = _792 - (floor(_792 * 0.0034602077212184668f) * 289.0f);
  float _809 = _793 - (floor(_793 * 0.0034602077212184668f) * 289.0f);
  float _810 = _794 - (floor(_794 * 0.0034602077212184668f) * 289.0f);
  float _811 = _795 - (floor(_795 * 0.0034602077212184668f) * 289.0f);
  float _824 = _808 - (floor(_808 * 0.020408164709806442f) * 49.0f);
  float _825 = _809 - (floor(_809 * 0.020408164709806442f) * 49.0f);
  float _826 = _810 - (floor(_810 * 0.020408164709806442f) * 49.0f);
  float _827 = _811 - (floor(_811 * 0.020408164709806442f) * 49.0f);
  float _832 = floor(_824 * 0.1428571492433548f);
  float _833 = floor(_825 * 0.1428571492433548f);
  float _834 = floor(_826 * 0.1428571492433548f);
  float _835 = floor(_827 * 0.1428571492433548f);
  float _852 = (_832 * 0.2857142984867096f) + -0.9285714030265808f;
  float _853 = (_833 * 0.2857142984867096f) + -0.9285714030265808f;
  float _854 = (_834 * 0.2857142984867096f) + -0.9285714030265808f;
  float _855 = (_835 * 0.2857142984867096f) + -0.9285714030265808f;
  float _860 = (floor(_824 - (_832 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _861 = (floor(_825 - (_833 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _862 = (floor(_826 - (_834 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _863 = (floor(_827 - (_835 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _876 = (1.0f - abs(_852)) - abs(_860);
  float _877 = (1.0f - abs(_853)) - abs(_861);
  float _878 = (1.0f - abs(_854)) - abs(_862);
  float _879 = (1.0f - abs(_855)) - abs(_863);
  float _908 = select((_876 > 0.0f), -0.0f, -1.0f);
  float _909 = select((_877 > 0.0f), -0.0f, -1.0f);
  float _910 = select((_878 > 0.0f), -0.0f, -1.0f);
  float _911 = select((_879 > 0.0f), -0.0f, -1.0f);
  float _916 = (((floor(_852) * 2.0f) + 1.0f) * _908) + _852;
  float _917 = (((floor(_860) * 2.0f) + 1.0f) * _908) + _860;
  float _918 = (((floor(_853) * 2.0f) + 1.0f) * _909) + _853;
  float _919 = (((floor(_861) * 2.0f) + 1.0f) * _909) + _861;
  float _924 = (((floor(_854) * 2.0f) + 1.0f) * _910) + _854;
  float _925 = (((floor(_862) * 2.0f) + 1.0f) * _910) + _862;
  float _926 = (((floor(_855) * 2.0f) + 1.0f) * _911) + _855;
  float _927 = (((floor(_863) * 2.0f) + 1.0f) * _911) + _863;
  float _936 = 1.7928400039672852f - (dot(float3(_916, _917, _876), float3(_916, _917, _876)) * 0.8537350296974182f);
  float _937 = 1.7928400039672852f - (dot(float3(_918, _919, _877), float3(_918, _919, _877)) * 0.8537350296974182f);
  float _938 = 1.7928400039672852f - (dot(float3(_924, _925, _878), float3(_924, _925, _878)) * 0.8537350296974182f);
  float _939 = 1.7928400039672852f - (dot(float3(_926, _927, _879), float3(_926, _927, _879)) * 0.8537350296974182f);
  float _960 = max((0.6000000238418579f - dot(float3(_666, _667, _668), float3(_666, _667, _668))), 0.0f);
  float _961 = max((0.6000000238418579f - dot(float3(_687, _688, _689), float3(_687, _688, _689))), 0.0f);
  float _962 = max((0.6000000238418579f - dot(float3(_693, _694, _695), float3(_693, _694, _695))), 0.0f);
  float _963 = max((0.6000000238418579f - dot(float3(_696, _697, _698), float3(_696, _697, _698))), 0.0f);
  float _964 = _960 * _960;
  float _965 = _961 * _961;
  float _966 = _962 * _962;
  float _967 = _963 * _963;
  float _982 = saturate((((sin((_282 * 2.5f) - _306) * 0.15000000596046448f) + 0.050000011920928955f) + (dot(float4((_964 * _964), (_965 * _965), (_966 * _966), (_967 * _967)), float4(dot(float3((_936 * _916), (_936 * _917), (_936 * _876)), float3(_666, _667, _668)), dot(float3((_937 * _918), (_937 * _919), (_937 * _877)), float3(_687, _688, _689)), dot(float3((_938 * _924), (_938 * _925), (_938 * _878)), float3(_693, _694, _695)), dot(float3((_939 * _926), (_939 * _927), (_939 * _879)), float3(_696, _697, _698)))) * 21.0f)) * 4.0f);
  float _986 = (_982 * _982) * (3.0f - (_982 * 2.0f));
  float _988 = (_986 * 0.6499999761581421f) + 0.3499999940395355f;
  float _995 = frame_consts.time * 0.15000000596046448f;
  float _996 = (_283 * 0.04444444552063942f) - _995;
  float _997 = _310 - _995;
  float _998 = frame_consts.time * 0.02500000037252903f;
  float _999 = dot(float3(_996, _997, _998), float3(0.3333333432674408f, 0.3333333432674408f, 0.3333333432674408f));
  float _1003 = floor(_996 + _999);
  float _1004 = floor(_997 + _999);
  float _1005 = floor(_998 + _999);
  float _1009 = dot(float3(_1003, _1004, _1005), float3(0.1666666716337204f, 0.1666666716337204f, 0.1666666716337204f));
  float _1010 = _1009 + (_996 - _1003);
  float _1011 = _1009 + (_997 - _1004);
  float _1012 = (_998 - _1005) + _1009;
  float _1016 = select((_1010 < _1011), 0.0f, 1.0f);
  float _1017 = select((_1011 < _1012), 0.0f, 1.0f);
  float _1018 = select((_1012 < _1010), 0.0f, 1.0f);
  float _1019 = 1.0f - _1016;
  float _1020 = 1.0f - _1017;
  float _1021 = 1.0f - _1018;
  float _1022 = min(_1016, _1021);
  float _1023 = min(_1017, _1019);
  float _1024 = min(_1018, _1020);
  float _1025 = max(_1016, _1021);
  float _1026 = max(_1017, _1019);
  float _1027 = max(_1018, _1020);
  float _1031 = (_1010 - _1022) + 0.1666666716337204f;
  float _1032 = (_1011 - _1023) + 0.1666666716337204f;
  float _1033 = (_1012 - _1024) + 0.1666666716337204f;
  float _1037 = (_1010 - _1025) + 0.3333333432674408f;
  float _1038 = (_1011 - _1026) + 0.3333333432674408f;
  float _1039 = (_1012 - _1027) + 0.3333333432674408f;
  float _1040 = _1010 + -0.5f;
  float _1041 = _1011 + -0.5f;
  float _1042 = _1012 + -0.5f;
  float _1052 = _1003 - (floor(_1003 * 0.0034602077212184668f) * 289.0f);
  float _1053 = _1004 - (floor(_1004 * 0.0034602077212184668f) * 289.0f);
  float _1054 = _1005 - (floor(_1005 * 0.0034602077212184668f) * 289.0f);
  float _1055 = _1054 + _1024;
  float _1056 = _1054 + _1027;
  float _1057 = _1054 + 1.0f;
  float _1066 = ((_1054 * 34.0f) + 1.0f) * _1054;
  float _1067 = ((_1055 * 34.0f) + 1.0f) * _1055;
  float _1068 = ((_1056 * 34.0f) + 1.0f) * _1056;
  float _1069 = ((_1057 * 34.0f) + 1.0f) * _1057;
  float _1083 = (_1066 - (floor(_1066 * 0.0034602077212184668f) * 289.0f)) + _1053;
  float _1086 = ((_1053 + _1023) - (floor(_1067 * 0.0034602077212184668f) * 289.0f)) + _1067;
  float _1089 = ((_1053 + _1026) - (floor(_1068 * 0.0034602077212184668f) * 289.0f)) + _1068;
  float _1092 = ((_1053 + 1.0f) - (floor(_1069 * 0.0034602077212184668f) * 289.0f)) + _1069;
  float _1101 = ((_1083 * 34.0f) + 1.0f) * _1083;
  float _1102 = ((_1086 * 34.0f) + 1.0f) * _1086;
  float _1103 = ((_1089 * 34.0f) + 1.0f) * _1089;
  float _1104 = ((_1092 * 34.0f) + 1.0f) * _1092;
  float _1118 = (_1101 - (floor(_1101 * 0.0034602077212184668f) * 289.0f)) + _1052;
  float _1121 = ((_1052 + _1022) - (floor(_1102 * 0.0034602077212184668f) * 289.0f)) + _1102;
  float _1124 = ((_1052 + _1025) - (floor(_1103 * 0.0034602077212184668f) * 289.0f)) + _1103;
  float _1127 = ((_1052 + 1.0f) - (floor(_1104 * 0.0034602077212184668f) * 289.0f)) + _1104;
  float _1136 = ((_1118 * 34.0f) + 1.0f) * _1118;
  float _1137 = ((_1121 * 34.0f) + 1.0f) * _1121;
  float _1138 = ((_1124 * 34.0f) + 1.0f) * _1124;
  float _1139 = ((_1127 * 34.0f) + 1.0f) * _1127;
  float _1152 = _1136 - (floor(_1136 * 0.0034602077212184668f) * 289.0f);
  float _1153 = _1137 - (floor(_1137 * 0.0034602077212184668f) * 289.0f);
  float _1154 = _1138 - (floor(_1138 * 0.0034602077212184668f) * 289.0f);
  float _1155 = _1139 - (floor(_1139 * 0.0034602077212184668f) * 289.0f);
  float _1168 = _1152 - (floor(_1152 * 0.020408164709806442f) * 49.0f);
  float _1169 = _1153 - (floor(_1153 * 0.020408164709806442f) * 49.0f);
  float _1170 = _1154 - (floor(_1154 * 0.020408164709806442f) * 49.0f);
  float _1171 = _1155 - (floor(_1155 * 0.020408164709806442f) * 49.0f);
  float _1176 = floor(_1168 * 0.1428571492433548f);
  float _1177 = floor(_1169 * 0.1428571492433548f);
  float _1178 = floor(_1170 * 0.1428571492433548f);
  float _1179 = floor(_1171 * 0.1428571492433548f);
  float _1196 = (_1176 * 0.2857142984867096f) + -0.9285714030265808f;
  float _1197 = (_1177 * 0.2857142984867096f) + -0.9285714030265808f;
  float _1198 = (_1178 * 0.2857142984867096f) + -0.9285714030265808f;
  float _1199 = (_1179 * 0.2857142984867096f) + -0.9285714030265808f;
  float _1204 = (floor(_1168 - (_1176 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _1205 = (floor(_1169 - (_1177 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _1206 = (floor(_1170 - (_1178 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _1207 = (floor(_1171 - (_1179 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _1220 = (1.0f - abs(_1196)) - abs(_1204);
  float _1221 = (1.0f - abs(_1197)) - abs(_1205);
  float _1222 = (1.0f - abs(_1198)) - abs(_1206);
  float _1223 = (1.0f - abs(_1199)) - abs(_1207);
  float _1252 = select((_1220 > 0.0f), -0.0f, -1.0f);
  float _1253 = select((_1221 > 0.0f), -0.0f, -1.0f);
  float _1254 = select((_1222 > 0.0f), -0.0f, -1.0f);
  float _1255 = select((_1223 > 0.0f), -0.0f, -1.0f);
  float _1260 = (((floor(_1196) * 2.0f) + 1.0f) * _1252) + _1196;
  float _1261 = (((floor(_1204) * 2.0f) + 1.0f) * _1252) + _1204;
  float _1262 = (((floor(_1197) * 2.0f) + 1.0f) * _1253) + _1197;
  float _1263 = (((floor(_1205) * 2.0f) + 1.0f) * _1253) + _1205;
  float _1268 = (((floor(_1198) * 2.0f) + 1.0f) * _1254) + _1198;
  float _1269 = (((floor(_1206) * 2.0f) + 1.0f) * _1254) + _1206;
  float _1270 = (((floor(_1199) * 2.0f) + 1.0f) * _1255) + _1199;
  float _1271 = (((floor(_1207) * 2.0f) + 1.0f) * _1255) + _1207;
  float _1280 = 1.7928400039672852f - (dot(float3(_1260, _1261, _1220), float3(_1260, _1261, _1220)) * 0.8537350296974182f);
  float _1281 = 1.7928400039672852f - (dot(float3(_1262, _1263, _1221), float3(_1262, _1263, _1221)) * 0.8537350296974182f);
  float _1282 = 1.7928400039672852f - (dot(float3(_1268, _1269, _1222), float3(_1268, _1269, _1222)) * 0.8537350296974182f);
  float _1283 = 1.7928400039672852f - (dot(float3(_1270, _1271, _1223), float3(_1270, _1271, _1223)) * 0.8537350296974182f);
  float _1304 = max((0.6000000238418579f - dot(float3(_1010, _1011, _1012), float3(_1010, _1011, _1012))), 0.0f);
  float _1305 = max((0.6000000238418579f - dot(float3(_1031, _1032, _1033), float3(_1031, _1032, _1033))), 0.0f);
  float _1306 = max((0.6000000238418579f - dot(float3(_1037, _1038, _1039), float3(_1037, _1038, _1039))), 0.0f);
  float _1307 = max((0.6000000238418579f - dot(float3(_1040, _1041, _1042), float3(_1040, _1041, _1042))), 0.0f);
  float _1308 = _1304 * _1304;
  float _1309 = _1305 * _1305;
  float _1310 = _1306 * _1306;
  float _1311 = _1307 * _1307;
  float _1326 = saturate((((sin(_305 - (frame_consts.time * 1.5f)) * 0.15000000596046448f) + 0.050000011920928955f) + (dot(float4((_1308 * _1308), (_1309 * _1309), (_1310 * _1310), (_1311 * _1311)), float4(dot(float3((_1280 * _1260), (_1280 * _1261), (_1280 * _1220)), float3(_1010, _1011, _1012)), dot(float3((_1281 * _1262), (_1281 * _1263), (_1281 * _1221)), float3(_1031, _1032, _1033)), dot(float3((_1282 * _1268), (_1282 * _1269), (_1282 * _1222)), float3(_1037, _1038, _1039)), dot(float3((_1283 * _1270), (_1283 * _1271), (_1283 * _1223)), float3(_1040, _1041, _1042)))) * 21.0f)) * 4.0f);
  float _1330 = (_1326 * _1326) * (3.0f - (_1326 * 2.0f));
  float _1332 = (_1330 * 0.6499999761581421f) + 0.3499999940395355f;
  float _1354 = saturate(_648);
  float _1355 = saturate(_988);
  float _1377 = (((_192 * 1.2000000476837158f) * _197) * frame_consts.params.vignette.golden_intensity) * ((((saturate(11.0f - (sqrt((_289 * _289) + (_288 * _288)) / ((_986 * 0.039000000804662704f) + 0.08100000768899918f))) * _988) + (saturate(11.0f - (sqrt((_284 * _284) + _294) / ((_646 * 0.039000000804662704f) + 0.08100000768899918f))) * _648)) + (saturate(11.0f - (sqrt((_301 * _301) + _294) / ((_1330 * 0.039000000804662704f) + 0.08100000768899918f))) * _1332)) + (((((saturate(1.0f - (abs(_285) * 0.8333333134651184f)) * _1354) + (saturate(1.0f - (abs(dot(float2(_288, _289), float2(-0.8660253882408142f, 0.5f))) * 0.8333333134651184f)) * _1355)) * saturate(_1332)) + ((_1354 * saturate(1.0f - (abs(dot(float2(_284, _285), float2(0.8660253882408142f, 0.5f))) * 0.8333333134651184f))) * _1355)) * 0.5f));
  SV_Target.x = ((_1377 * ((_244 * _244) - _206)) + _206);
  SV_Target.y = ((_1377 * ((_245 * _245) - _207)) + _207);
  SV_Target.z = ((_1377 * ((_246 * _246) - _208)) + _208);
  if (RENODX_TONE_MAP_TYPE) {
    SV_Target.rgb = renodx::draw::ToneMapPass(_27.rgb, SV_Target.rgb);
  } else {
    SV_Target.rgb = saturate(SV_Target.rgb);
  }
  SV_Target.rgb = renodx::draw::RenderIntermediatePass(SV_Target.rgb);

  SV_Target.w = 1.0f;
  return SV_Target;
}
