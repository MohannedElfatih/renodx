#include "../shared.h"

struct Lod_params {
  struct Lod_brush_params {
    float4 brush_uv[4];
    float base_radius;
    float radius_variation;
    float radius_random;
    float blur;
    float alpha;
    float stretch;
  } brushes;
  struct Lod_noise_params {
    float chaos;
    float freq;
    float brightness;
    float saturation;
    float hue;
  } noise;
  struct Lod_outlines_params {
    float2 thickness;
    float2 softness;
    float2 displacement;
    float2 attenuation;
    float lighting_threshold;
    float lighting_threshold_softness;
    float2 lighting_dark;
    float2 lighting_bright;
    float2 discretion;
    float2 alpha;
  } outlines;
};

struct Frame_constants {
  float3 cam_world_pos;
  float time;
  float2 inv_near_dim;
  float proj_scale;
  uint flags;
  float2 half_vp_dim;
  int2 vp_dim;
  float2 vp_texel_size;
  int2 mouse_pos;
  int2 inspected_pix;
  int2 hi_z_0_dim;
  int supersampling;
  int debug_patches;
  int use_patches;
  int emissive;
  float3 target;
  uint frame_number;
  uint shot_frame_number;
  float dt;
  float4 view_to_world[4];
  float4 world_to_view[4];
  float4 view_ndc[4];
  float4 world_ndc[4];
  float4 prev_world_ndc[4];
  float4 ndc_world[4];
  float4 ndc_to_prev_ndc[4];
  float4 prev_ndc_to_ndc[4];
  float4 view_world_z0;
  float4 pix_to_fog_eq;
  float3 mio_view;
  float3 mio_hair_outline_color;
  float mio_foliage_velocity;
  int show_wireframe;
  int ao;
  int glitch;
  int no_vertex_color;
  float paper_mult;
  int hatching;
  int mio_halo;
  int vol_temporal;
  int heart_attack_active;
  int heart_attack_secondary_target;
  int triangular_dissolve_enabled;
  int color_correct;
  float starfield_effect_amount;
  float starfield_fade_amount;
  float3 starfield_center_view;
  float starfield_glow_amount;
  float starfield_pulse_t;
  float death_anim_t;
  float3 game_plane_world_origin;
  float3 game_plane_world_normal;
  float3 game_plane_world_u;
  float3 game_plane_world_v;
  float4 game_plane_transform[4];
  float4 hatching_xf[4];
  float4 paper_xf[4];
  float2 game_plane_blend;
  float heart_attack_t;
  float heart_attack_duration;
  float heart_attack_pulse;
  float heart_attack_outline_distance;
  float heart_attack_dissolve_distance;
  float3 heart_attack_dissolve_color;
  float heart_attack_dissolve_base;
  float heart_attack_dissolve_mult;
  float3 heart_attack_dissolve_world_center;
  float heart_attack_vertical_dissolve;
  float triangular_dissolve_base_amount;
  float triangular_dissolve_amount;
  float flashback_lut;
  float evil_mio;
  float dead_mio;
  float godlike_mio;
  float khlia_pulse_t;
  float khlia__pulse_t;
  float khlia_pulse_period;
  float3 khlia_world_pos;
  float skydome_rotation_offset;
  float hatch_ambiant_mul;
  float hatch_ambiant_add;
  float glitch_scale;
  uint max_contours;
  uint max_contour_loops;
  int death_screen;
  float death_screen_t;
  int poetic_death_screen;
  float poetic_death_screen_t;
  float tremor_pulse_t;
  int invert;
  float surface_fade;
  struct Postprocess_params {
    struct AO_params {
      float3 color;
      float intensity;
    } ao;
    struct Fog_params {
      float bloom_factor;
      float space;
      float outline_density;
      float outline_attenuation;
    } fog;
    struct Ambient_light_params {
      int undercoat_grad;
      float3 color;
      float intensity;
      float gameplay_intensity;
      float gameplay_width;
      float directional_intensity;
      float directional_shadows;
      float undercoat_noise_freq;
      float undercoat_noise_amplitude;
      float undercoat_noise_threshold;
      float undercoating;
    } ambient_light;
    struct Vignette_params {
      float intensity;
      float rounded;
      float3 color;
      float golden_intensity;
      float golden_color;
    } vignette;
    struct Bloom_params {
      float intensity;
      float threshold_low;
      float threshold_high;
    } bloom;
    struct Mio_params {
      float light_intensity;
      float light_radius;
      float3 light_color;
      float spec_intensity;
      float3 halo_color;
      float halo_intensity;
    } mio;
    struct Particles_params {
      uint count;
      float cam_near;
      float cam_far;
      float fadeoff_near;
      float2 lifetime;
      float fadein_duration;
      float fadeoff_duration;
      float2 alpha;
      float2 scale;
      float2 speed;
      int gradient;
      float circle_attenuation;
    } particles;
    struct Chroma_aberration_params {
      float intensity;
    } chroma_aberration;
    struct Fade_params {
      float intensity;
      float3 color;
    } fade;
    struct Dof_params {
      float plane_01;
      float plane_01_softness;
      float plane_12;
      float plane_12_softness;
      float foreground;
      float foreground_softness;
    } dof;
    Lod_params lod_foreground;
    Lod_params lod_game;
    Lod_params lod_midground;
    Lod_params lod_background;
  } params;
};


Texture2D<float4> tex : register(t0);

Texture2D<float> depth_tex : register(t1);

Texture2D<float2> distortion : register(t4);

Texture2D<float> paper_tex : register(t5);

Texture2D<float3> bloom_tex : register(t7);

cbuffer frame_consts : register(b0) {
  Frame_constants frame_consts : packoffset(c000.x);
};

SamplerState sampler_nearest : register(s0);

SamplerState sampler_bilinear : register(s1);

SamplerState sampler_bilinear_wrap : register(s2);

float4 main(
  noperspective float4 SV_Position : SV_Position,
  linear float2 O_Uv : O_Uv
) : SV_Target {
  float4 SV_Target;
  float _15 = float((int)(frame_consts.vp_dim.x));
  float _16 = float((int)(frame_consts.vp_dim.y));
  float2 _17 = distortion.SampleLevel(sampler_nearest, float2(O_Uv.x, O_Uv.y), 0.0f);
  float _20 = _16 / _15;
  float _25 = saturate((_17.x * _20) + O_Uv.x);
  float _26 = saturate((_17.y * _20) + O_Uv.y);
  float4 _27 = tex.SampleLevel(sampler_nearest, float2(_25, _26), 0.0f);
  float3 _31 = bloom_tex.SampleLevel(sampler_bilinear, float2(_25, _26), 0.0f);
  float _46 = max((((1.0f - (_27.y * 0.7152000069618225f)) - (_27.x * 0.2125999927520752f)) - (_27.z * 0.0722000002861023f)), 0.0010000000474974513f);
  float _50 = (_27.x / _46) + (frame_consts.params.bloom.intensity * _31.x);
  float _51 = (_27.y / _46) + (frame_consts.params.bloom.intensity * _31.y);
  float _52 = (_27.z / _46) + (frame_consts.params.bloom.intensity * _31.z);
  float _58 = (((_50 * 0.2125999927520752f) + 1.0f) + (_51 * 0.7152000069618225f)) + (_52 * 0.0722000002861023f);
  float _62 = saturate(_50 / _58);
  float _63 = saturate(_51 / _58);
  float _64 = saturate(_52 / _58);
  float _70 = depth_tex.SampleLevel(sampler_nearest, float2(_25, _26), 0.0f);
  float _74 = 10000.0f / ((_70.x * 19999.5f) + 0.5f);
  float _79 = (_74 * ((_25 * 2.0f) + -1.0f)) * frame_consts.inv_near_dim.x;
  float _81 = (_74 * (((1.0f - _26) * 2.0f) + -1.0f)) * frame_consts.inv_near_dim.y;
  float _82 = -0.0f - _74;
  float _106 = mad((frame_consts.paper_xf[2].z), _82, mad((frame_consts.paper_xf[1].z), _81, (_79 * (frame_consts.paper_xf[0].z))));
  float _107 = mad((frame_consts.paper_xf[2].x), _82, mad((frame_consts.paper_xf[1].x), _81, (_79 * (frame_consts.paper_xf[0].x)))) / _106;
  float _108 = mad((frame_consts.paper_xf[2].y), _82, mad((frame_consts.paper_xf[1].y), _81, (_79 * (frame_consts.paper_xf[0].y)))) / _106;
  float _115 = log2(max(5.0f, (-0.0f - (_106 - frame_consts.game_plane_blend.x)))) * 10.0f;
  float _116 = floor(_115);
  float _117 = _115 - _116;
  float _119 = exp2(_116 * 0.10000000149011612f);
  float _120 = 1.0f / _119;
  float _121 = min(_120, 0.20000000298023224f);
  float _123 = min((_120 * 0.9330329895019531f), 0.20000000298023224f);
  float _124 = frame_consts.game_plane_blend.x - _119;
  float _130 = frame_consts.game_plane_blend.x - (_119 * 1.0717734098434448f);
  float _140 = paper_tex.SampleLevel(sampler_bilinear_wrap, float2((((_124 * _107) + (frame_consts.paper_xf[3].x)) * _121), (((_124 * _108) + (frame_consts.paper_xf[3].y)) * _121)), 0.0f);
  float _143 = paper_tex.SampleLevel(sampler_bilinear_wrap, float2((((_130 * _107) + (frame_consts.paper_xf[3].x)) * _123), (((_130 * _108) + (frame_consts.paper_xf[3].y)) * _123)), 0.0f);
  float _150 = ((1.0f - (_140.x * (1.0f - _117))) - (_143.x * _117)) * frame_consts.paper_mult;
  float _165 = _15 / _16;
  float _177 = exp2(log2(saturate((frame_consts.params.vignette.intensity * abs(_25 + -0.5f)) * (((_165 + -1.0f) * frame_consts.params.vignette.rounded) + 1.0f))) * 5.0f);
  float _178 = exp2(log2(saturate(frame_consts.params.vignette.intensity * abs(_26 + -0.5f))) * 5.0f);
  float _184 = exp2(log2(saturate(1.0f - dot(float2(_177, _178), float2(_177, _178)))) * 6.0f);
  float _189 = 1.0f - _184;
  float _191 = 1.0f - (_189 * 0.8500000238418579f);
  float _198 = (_191 * ((_62 - (_150 * _62)) - frame_consts.params.vignette.color.x)) + frame_consts.params.vignette.color.x;
  float _199 = (_191 * ((_63 - (_150 * _63)) - frame_consts.params.vignette.color.y)) + frame_consts.params.vignette.color.y;
  float _200 = (_191 * ((_64 - (_150 * _64)) - frame_consts.params.vignette.color.z)) + frame_consts.params.vignette.color.z;
  float _204 = _25 * _15;
  float _205 = _26 * _16;
  float _206 = _205 + _204;
  float _212 = frac(_206 * 0.0033333334140479565f) + -0.5f;
  float _213 = frac((_205 - _204) * 0.0033333334140479565f) + -0.5f;
  float _219 = saturate(sqrt((_213 * _213) + (_212 * _212)) * 2.0f);
  float _230 = saturate((sin((_206 * 0.01666666753590107f) - (frame_consts.time * 0.8500000238418579f)) * 1.2500001192092896f) + -0.25000008940696716f);
  float _235 = ((_230 * _230) * 0.2199999988079071f) * (3.0f - (_230 * 2.0f));
  float _236 = _235 + 0.9777389168739319f;
  float _237 = ((_219 * 0.13274884223937988f) + 0.7175776362419128f) + _235;
  float _238 = ((_219 * 0.3335757553577423f) + 0.30871906876564026f) + _235;
  float _243 = (_25 * 1080.0f) * _165;
  float _244 = _26 * 1080.0f;
  float _245 = _243 * 0.04444444552063942f;
  float _246 = _26 * 27.712812423706055f;
  float _248 = ceil(_245 - _246);
  float _251 = floor(_26 * 55.42562484741211f) + 1.0f;
  float _254 = ceil((-0.0f - _246) - _245);
  float _256 = (_251 + _248) + _254;
  float _258 = (_256 * 22.5f) + -33.75f;
  float _259 = _248 - _254;
  float _261 = _259 * 11.25f;
  float _267 = (((_251 * 0.5773502588272095f) - (_248 * 0.28867512941360474f)) - (_254 * 0.28867512941360474f)) * 22.5f;
  float _270 = _258 + _261;
  float _271 = _267 + (19.485570907592773f - (_256 * 12.990381240844727f));
  float _274 = ((_256 * 25.980762481689453f) + -38.97114181518555f) + _267;
  float _275 = _261 - _258;
  float _276 = _270 - _243;
  float _277 = _271 - _244;
  float _280 = _261 - _243;
  float _281 = _274 - _244;
  float _286 = _277 * _277;
  float _293 = _275 - _243;
  float _297 = _271 * 2.5f;
  float _298 = frame_consts.time * 1.5f;
  float _302 = _271 * 0.004444444552063942f;
  float _303 = frame_consts.time * 0.15000000596046448f;
  float _304 = (_270 * 0.04444444552063942f) - _303;
  float _305 = _302 - _303;
  float _306 = frame_consts.time * 0.02500000037252903f;
  float _307 = dot(float3(_304, _305, _306), float3(0.3333333432674408f, 0.3333333432674408f, 0.3333333432674408f));
  float _311 = floor(_307 + _304);
  float _312 = floor(_307 + _305);
  float _313 = floor(_307 + _306);
  float _317 = dot(float3(_311, _312, _313), float3(0.1666666716337204f, 0.1666666716337204f, 0.1666666716337204f));
  float _318 = _317 + (_304 - _311);
  float _319 = _317 + (_305 - _312);
  float _320 = (_306 - _313) + _317;
  float _324 = select((_318 < _319), 0.0f, 1.0f);
  float _325 = select((_319 < _320), 0.0f, 1.0f);
  float _326 = select((_320 < _318), 0.0f, 1.0f);
  float _327 = 1.0f - _324;
  float _328 = 1.0f - _325;
  float _329 = 1.0f - _326;
  float _330 = min(_324, _329);
  float _331 = min(_325, _327);
  float _332 = min(_326, _328);
  float _333 = max(_324, _329);
  float _334 = max(_325, _327);
  float _335 = max(_326, _328);
  float _339 = (_318 - _330) + 0.1666666716337204f;
  float _340 = (_319 - _331) + 0.1666666716337204f;
  float _341 = (_320 - _332) + 0.1666666716337204f;
  float _345 = (_318 - _333) + 0.3333333432674408f;
  float _346 = (_319 - _334) + 0.3333333432674408f;
  float _347 = (_320 - _335) + 0.3333333432674408f;
  float _348 = _318 + -0.5f;
  float _349 = _319 + -0.5f;
  float _350 = _320 + -0.5f;
  float _360 = _311 - (floor(_311 * 0.0034602077212184668f) * 289.0f);
  float _361 = _312 - (floor(_312 * 0.0034602077212184668f) * 289.0f);
  float _362 = _313 - (floor(_313 * 0.0034602077212184668f) * 289.0f);
  float _363 = _362 + _332;
  float _364 = _362 + _335;
  float _365 = _362 + 1.0f;
  float _374 = ((_362 * 34.0f) + 1.0f) * _362;
  float _375 = ((_363 * 34.0f) + 1.0f) * _363;
  float _376 = ((_364 * 34.0f) + 1.0f) * _364;
  float _377 = ((_365 * 34.0f) + 1.0f) * _365;
  float _391 = (_374 - (floor(_374 * 0.0034602077212184668f) * 289.0f)) + _361;
  float _394 = ((_361 + _331) - (floor(_375 * 0.0034602077212184668f) * 289.0f)) + _375;
  float _397 = ((_361 + _334) - (floor(_376 * 0.0034602077212184668f) * 289.0f)) + _376;
  float _400 = ((_361 + 1.0f) - (floor(_377 * 0.0034602077212184668f) * 289.0f)) + _377;
  float _409 = ((_391 * 34.0f) + 1.0f) * _391;
  float _410 = ((_394 * 34.0f) + 1.0f) * _394;
  float _411 = ((_397 * 34.0f) + 1.0f) * _397;
  float _412 = ((_400 * 34.0f) + 1.0f) * _400;
  float _426 = (_409 - (floor(_409 * 0.0034602077212184668f) * 289.0f)) + _360;
  float _429 = ((_360 + _330) - (floor(_410 * 0.0034602077212184668f) * 289.0f)) + _410;
  float _432 = ((_360 + _333) - (floor(_411 * 0.0034602077212184668f) * 289.0f)) + _411;
  float _435 = ((_360 + 1.0f) - (floor(_412 * 0.0034602077212184668f) * 289.0f)) + _412;
  float _444 = ((_426 * 34.0f) + 1.0f) * _426;
  float _445 = ((_429 * 34.0f) + 1.0f) * _429;
  float _446 = ((_432 * 34.0f) + 1.0f) * _432;
  float _447 = ((_435 * 34.0f) + 1.0f) * _435;
  float _460 = _444 - (floor(_444 * 0.0034602077212184668f) * 289.0f);
  float _461 = _445 - (floor(_445 * 0.0034602077212184668f) * 289.0f);
  float _462 = _446 - (floor(_446 * 0.0034602077212184668f) * 289.0f);
  float _463 = _447 - (floor(_447 * 0.0034602077212184668f) * 289.0f);
  float _476 = _460 - (floor(_460 * 0.020408164709806442f) * 49.0f);
  float _477 = _461 - (floor(_461 * 0.020408164709806442f) * 49.0f);
  float _478 = _462 - (floor(_462 * 0.020408164709806442f) * 49.0f);
  float _479 = _463 - (floor(_463 * 0.020408164709806442f) * 49.0f);
  float _484 = floor(_476 * 0.1428571492433548f);
  float _485 = floor(_477 * 0.1428571492433548f);
  float _486 = floor(_478 * 0.1428571492433548f);
  float _487 = floor(_479 * 0.1428571492433548f);
  float _504 = (_484 * 0.2857142984867096f) + -0.9285714030265808f;
  float _505 = (_485 * 0.2857142984867096f) + -0.9285714030265808f;
  float _506 = (_486 * 0.2857142984867096f) + -0.9285714030265808f;
  float _507 = (_487 * 0.2857142984867096f) + -0.9285714030265808f;
  float _512 = (floor(_476 - (_484 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _513 = (floor(_477 - (_485 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _514 = (floor(_478 - (_486 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _515 = (floor(_479 - (_487 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _528 = (1.0f - abs(_504)) - abs(_512);
  float _529 = (1.0f - abs(_505)) - abs(_513);
  float _530 = (1.0f - abs(_506)) - abs(_514);
  float _531 = (1.0f - abs(_507)) - abs(_515);
  float _560 = select((_528 > 0.0f), -0.0f, -1.0f);
  float _561 = select((_529 > 0.0f), -0.0f, -1.0f);
  float _562 = select((_530 > 0.0f), -0.0f, -1.0f);
  float _563 = select((_531 > 0.0f), -0.0f, -1.0f);
  float _568 = (((floor(_504) * 2.0f) + 1.0f) * _560) + _504;
  float _569 = (((floor(_512) * 2.0f) + 1.0f) * _560) + _512;
  float _570 = (((floor(_505) * 2.0f) + 1.0f) * _561) + _505;
  float _571 = (((floor(_513) * 2.0f) + 1.0f) * _561) + _513;
  float _576 = (((floor(_506) * 2.0f) + 1.0f) * _562) + _506;
  float _577 = (((floor(_514) * 2.0f) + 1.0f) * _562) + _514;
  float _578 = (((floor(_507) * 2.0f) + 1.0f) * _563) + _507;
  float _579 = (((floor(_515) * 2.0f) + 1.0f) * _563) + _515;
  float _588 = 1.7928400039672852f - (dot(float3(_568, _569, _528), float3(_568, _569, _528)) * 0.8537350296974182f);
  float _589 = 1.7928400039672852f - (dot(float3(_570, _571, _529), float3(_570, _571, _529)) * 0.8537350296974182f);
  float _590 = 1.7928400039672852f - (dot(float3(_576, _577, _530), float3(_576, _577, _530)) * 0.8537350296974182f);
  float _591 = 1.7928400039672852f - (dot(float3(_578, _579, _531), float3(_578, _579, _531)) * 0.8537350296974182f);
  float _612 = max((0.6000000238418579f - dot(float3(_318, _319, _320), float3(_318, _319, _320))), 0.0f);
  float _613 = max((0.6000000238418579f - dot(float3(_339, _340, _341), float3(_339, _340, _341))), 0.0f);
  float _614 = max((0.6000000238418579f - dot(float3(_345, _346, _347), float3(_345, _346, _347))), 0.0f);
  float _615 = max((0.6000000238418579f - dot(float3(_348, _349, _350), float3(_348, _349, _350))), 0.0f);
  float _616 = _612 * _612;
  float _617 = _613 * _613;
  float _618 = _614 * _614;
  float _619 = _615 * _615;
  float _634 = saturate((((sin(_297 - _298) * 0.15000000596046448f) + 0.050000011920928955f) + (dot(float4((_616 * _616), (_617 * _617), (_618 * _618), (_619 * _619)), float4(dot(float3((_588 * _568), (_588 * _569), (_588 * _528)), float3(_318, _319, _320)), dot(float3((_589 * _570), (_589 * _571), (_589 * _529)), float3(_339, _340, _341)), dot(float3((_590 * _576), (_590 * _577), (_590 * _530)), float3(_345, _346, _347)), dot(float3((_591 * _578), (_591 * _579), (_591 * _531)), float3(_348, _349, _350)))) * 21.0f)) * 4.0f);
  float _638 = (_634 * _634) * (3.0f - (_634 * 2.0f));
  float _640 = (_638 * 0.6499999761581421f) + 0.3499999940395355f;
  float _645 = (_259 * 0.5f) - _303;
  float _646 = (_274 * 0.004444444552063942f) - _303;
  float _647 = dot(float3(_645, _646, _306), float3(0.3333333432674408f, 0.3333333432674408f, 0.3333333432674408f));
  float _651 = floor(_647 + _645);
  float _652 = floor(_647 + _646);
  float _653 = floor(_647 + _306);
  float _657 = dot(float3(_651, _652, _653), float3(0.1666666716337204f, 0.1666666716337204f, 0.1666666716337204f));
  float _658 = _657 + (_645 - _651);
  float _659 = _657 + (_646 - _652);
  float _660 = (_306 - _653) + _657;
  float _664 = select((_658 < _659), 0.0f, 1.0f);
  float _665 = select((_659 < _660), 0.0f, 1.0f);
  float _666 = select((_660 < _658), 0.0f, 1.0f);
  float _667 = 1.0f - _664;
  float _668 = 1.0f - _665;
  float _669 = 1.0f - _666;
  float _670 = min(_664, _669);
  float _671 = min(_665, _667);
  float _672 = min(_666, _668);
  float _673 = max(_664, _669);
  float _674 = max(_665, _667);
  float _675 = max(_666, _668);
  float _679 = (_658 - _670) + 0.1666666716337204f;
  float _680 = (_659 - _671) + 0.1666666716337204f;
  float _681 = (_660 - _672) + 0.1666666716337204f;
  float _685 = (_658 - _673) + 0.3333333432674408f;
  float _686 = (_659 - _674) + 0.3333333432674408f;
  float _687 = (_660 - _675) + 0.3333333432674408f;
  float _688 = _658 + -0.5f;
  float _689 = _659 + -0.5f;
  float _690 = _660 + -0.5f;
  float _700 = _651 - (floor(_651 * 0.0034602077212184668f) * 289.0f);
  float _701 = _652 - (floor(_652 * 0.0034602077212184668f) * 289.0f);
  float _702 = _653 - (floor(_653 * 0.0034602077212184668f) * 289.0f);
  float _703 = _702 + _672;
  float _704 = _702 + _675;
  float _705 = _702 + 1.0f;
  float _714 = ((_702 * 34.0f) + 1.0f) * _702;
  float _715 = ((_703 * 34.0f) + 1.0f) * _703;
  float _716 = ((_704 * 34.0f) + 1.0f) * _704;
  float _717 = ((_705 * 34.0f) + 1.0f) * _705;
  float _731 = (_714 - (floor(_714 * 0.0034602077212184668f) * 289.0f)) + _701;
  float _734 = ((_701 + _671) - (floor(_715 * 0.0034602077212184668f) * 289.0f)) + _715;
  float _737 = ((_701 + _674) - (floor(_716 * 0.0034602077212184668f) * 289.0f)) + _716;
  float _740 = ((_701 + 1.0f) - (floor(_717 * 0.0034602077212184668f) * 289.0f)) + _717;
  float _749 = ((_731 * 34.0f) + 1.0f) * _731;
  float _750 = ((_734 * 34.0f) + 1.0f) * _734;
  float _751 = ((_737 * 34.0f) + 1.0f) * _737;
  float _752 = ((_740 * 34.0f) + 1.0f) * _740;
  float _766 = (_749 - (floor(_749 * 0.0034602077212184668f) * 289.0f)) + _700;
  float _769 = ((_700 + _670) - (floor(_750 * 0.0034602077212184668f) * 289.0f)) + _750;
  float _772 = ((_700 + _673) - (floor(_751 * 0.0034602077212184668f) * 289.0f)) + _751;
  float _775 = ((_700 + 1.0f) - (floor(_752 * 0.0034602077212184668f) * 289.0f)) + _752;
  float _784 = ((_766 * 34.0f) + 1.0f) * _766;
  float _785 = ((_769 * 34.0f) + 1.0f) * _769;
  float _786 = ((_772 * 34.0f) + 1.0f) * _772;
  float _787 = ((_775 * 34.0f) + 1.0f) * _775;
  float _800 = _784 - (floor(_784 * 0.0034602077212184668f) * 289.0f);
  float _801 = _785 - (floor(_785 * 0.0034602077212184668f) * 289.0f);
  float _802 = _786 - (floor(_786 * 0.0034602077212184668f) * 289.0f);
  float _803 = _787 - (floor(_787 * 0.0034602077212184668f) * 289.0f);
  float _816 = _800 - (floor(_800 * 0.020408164709806442f) * 49.0f);
  float _817 = _801 - (floor(_801 * 0.020408164709806442f) * 49.0f);
  float _818 = _802 - (floor(_802 * 0.020408164709806442f) * 49.0f);
  float _819 = _803 - (floor(_803 * 0.020408164709806442f) * 49.0f);
  float _824 = floor(_816 * 0.1428571492433548f);
  float _825 = floor(_817 * 0.1428571492433548f);
  float _826 = floor(_818 * 0.1428571492433548f);
  float _827 = floor(_819 * 0.1428571492433548f);
  float _844 = (_824 * 0.2857142984867096f) + -0.9285714030265808f;
  float _845 = (_825 * 0.2857142984867096f) + -0.9285714030265808f;
  float _846 = (_826 * 0.2857142984867096f) + -0.9285714030265808f;
  float _847 = (_827 * 0.2857142984867096f) + -0.9285714030265808f;
  float _852 = (floor(_816 - (_824 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _853 = (floor(_817 - (_825 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _854 = (floor(_818 - (_826 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _855 = (floor(_819 - (_827 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _868 = (1.0f - abs(_844)) - abs(_852);
  float _869 = (1.0f - abs(_845)) - abs(_853);
  float _870 = (1.0f - abs(_846)) - abs(_854);
  float _871 = (1.0f - abs(_847)) - abs(_855);
  float _900 = select((_868 > 0.0f), -0.0f, -1.0f);
  float _901 = select((_869 > 0.0f), -0.0f, -1.0f);
  float _902 = select((_870 > 0.0f), -0.0f, -1.0f);
  float _903 = select((_871 > 0.0f), -0.0f, -1.0f);
  float _908 = (((floor(_844) * 2.0f) + 1.0f) * _900) + _844;
  float _909 = (((floor(_852) * 2.0f) + 1.0f) * _900) + _852;
  float _910 = (((floor(_845) * 2.0f) + 1.0f) * _901) + _845;
  float _911 = (((floor(_853) * 2.0f) + 1.0f) * _901) + _853;
  float _916 = (((floor(_846) * 2.0f) + 1.0f) * _902) + _846;
  float _917 = (((floor(_854) * 2.0f) + 1.0f) * _902) + _854;
  float _918 = (((floor(_847) * 2.0f) + 1.0f) * _903) + _847;
  float _919 = (((floor(_855) * 2.0f) + 1.0f) * _903) + _855;
  float _928 = 1.7928400039672852f - (dot(float3(_908, _909, _868), float3(_908, _909, _868)) * 0.8537350296974182f);
  float _929 = 1.7928400039672852f - (dot(float3(_910, _911, _869), float3(_910, _911, _869)) * 0.8537350296974182f);
  float _930 = 1.7928400039672852f - (dot(float3(_916, _917, _870), float3(_916, _917, _870)) * 0.8537350296974182f);
  float _931 = 1.7928400039672852f - (dot(float3(_918, _919, _871), float3(_918, _919, _871)) * 0.8537350296974182f);
  float _952 = max((0.6000000238418579f - dot(float3(_658, _659, _660), float3(_658, _659, _660))), 0.0f);
  float _953 = max((0.6000000238418579f - dot(float3(_679, _680, _681), float3(_679, _680, _681))), 0.0f);
  float _954 = max((0.6000000238418579f - dot(float3(_685, _686, _687), float3(_685, _686, _687))), 0.0f);
  float _955 = max((0.6000000238418579f - dot(float3(_688, _689, _690), float3(_688, _689, _690))), 0.0f);
  float _956 = _952 * _952;
  float _957 = _953 * _953;
  float _958 = _954 * _954;
  float _959 = _955 * _955;
  float _974 = saturate((((sin((_274 * 2.5f) - _298) * 0.15000000596046448f) + 0.050000011920928955f) + (dot(float4((_956 * _956), (_957 * _957), (_958 * _958), (_959 * _959)), float4(dot(float3((_928 * _908), (_928 * _909), (_928 * _868)), float3(_658, _659, _660)), dot(float3((_929 * _910), (_929 * _911), (_929 * _869)), float3(_679, _680, _681)), dot(float3((_930 * _916), (_930 * _917), (_930 * _870)), float3(_685, _686, _687)), dot(float3((_931 * _918), (_931 * _919), (_931 * _871)), float3(_688, _689, _690)))) * 21.0f)) * 4.0f);
  float _978 = (_974 * _974) * (3.0f - (_974 * 2.0f));
  float _980 = (_978 * 0.6499999761581421f) + 0.3499999940395355f;
  float _987 = frame_consts.time * 0.15000000596046448f;
  float _988 = (_275 * 0.04444444552063942f) - _987;
  float _989 = _302 - _987;
  float _990 = frame_consts.time * 0.02500000037252903f;
  float _991 = dot(float3(_988, _989, _990), float3(0.3333333432674408f, 0.3333333432674408f, 0.3333333432674408f));
  float _995 = floor(_988 + _991);
  float _996 = floor(_989 + _991);
  float _997 = floor(_990 + _991);
  float _1001 = dot(float3(_995, _996, _997), float3(0.1666666716337204f, 0.1666666716337204f, 0.1666666716337204f));
  float _1002 = _1001 + (_988 - _995);
  float _1003 = _1001 + (_989 - _996);
  float _1004 = (_990 - _997) + _1001;
  float _1008 = select((_1002 < _1003), 0.0f, 1.0f);
  float _1009 = select((_1003 < _1004), 0.0f, 1.0f);
  float _1010 = select((_1004 < _1002), 0.0f, 1.0f);
  float _1011 = 1.0f - _1008;
  float _1012 = 1.0f - _1009;
  float _1013 = 1.0f - _1010;
  float _1014 = min(_1008, _1013);
  float _1015 = min(_1009, _1011);
  float _1016 = min(_1010, _1012);
  float _1017 = max(_1008, _1013);
  float _1018 = max(_1009, _1011);
  float _1019 = max(_1010, _1012);
  float _1023 = (_1002 - _1014) + 0.1666666716337204f;
  float _1024 = (_1003 - _1015) + 0.1666666716337204f;
  float _1025 = (_1004 - _1016) + 0.1666666716337204f;
  float _1029 = (_1002 - _1017) + 0.3333333432674408f;
  float _1030 = (_1003 - _1018) + 0.3333333432674408f;
  float _1031 = (_1004 - _1019) + 0.3333333432674408f;
  float _1032 = _1002 + -0.5f;
  float _1033 = _1003 + -0.5f;
  float _1034 = _1004 + -0.5f;
  float _1044 = _995 - (floor(_995 * 0.0034602077212184668f) * 289.0f);
  float _1045 = _996 - (floor(_996 * 0.0034602077212184668f) * 289.0f);
  float _1046 = _997 - (floor(_997 * 0.0034602077212184668f) * 289.0f);
  float _1047 = _1046 + _1016;
  float _1048 = _1046 + _1019;
  float _1049 = _1046 + 1.0f;
  float _1058 = ((_1046 * 34.0f) + 1.0f) * _1046;
  float _1059 = ((_1047 * 34.0f) + 1.0f) * _1047;
  float _1060 = ((_1048 * 34.0f) + 1.0f) * _1048;
  float _1061 = ((_1049 * 34.0f) + 1.0f) * _1049;
  float _1075 = (_1058 - (floor(_1058 * 0.0034602077212184668f) * 289.0f)) + _1045;
  float _1078 = ((_1045 + _1015) - (floor(_1059 * 0.0034602077212184668f) * 289.0f)) + _1059;
  float _1081 = ((_1045 + _1018) - (floor(_1060 * 0.0034602077212184668f) * 289.0f)) + _1060;
  float _1084 = ((_1045 + 1.0f) - (floor(_1061 * 0.0034602077212184668f) * 289.0f)) + _1061;
  float _1093 = ((_1075 * 34.0f) + 1.0f) * _1075;
  float _1094 = ((_1078 * 34.0f) + 1.0f) * _1078;
  float _1095 = ((_1081 * 34.0f) + 1.0f) * _1081;
  float _1096 = ((_1084 * 34.0f) + 1.0f) * _1084;
  float _1110 = (_1093 - (floor(_1093 * 0.0034602077212184668f) * 289.0f)) + _1044;
  float _1113 = ((_1044 + _1014) - (floor(_1094 * 0.0034602077212184668f) * 289.0f)) + _1094;
  float _1116 = ((_1044 + _1017) - (floor(_1095 * 0.0034602077212184668f) * 289.0f)) + _1095;
  float _1119 = ((_1044 + 1.0f) - (floor(_1096 * 0.0034602077212184668f) * 289.0f)) + _1096;
  float _1128 = ((_1110 * 34.0f) + 1.0f) * _1110;
  float _1129 = ((_1113 * 34.0f) + 1.0f) * _1113;
  float _1130 = ((_1116 * 34.0f) + 1.0f) * _1116;
  float _1131 = ((_1119 * 34.0f) + 1.0f) * _1119;
  float _1144 = _1128 - (floor(_1128 * 0.0034602077212184668f) * 289.0f);
  float _1145 = _1129 - (floor(_1129 * 0.0034602077212184668f) * 289.0f);
  float _1146 = _1130 - (floor(_1130 * 0.0034602077212184668f) * 289.0f);
  float _1147 = _1131 - (floor(_1131 * 0.0034602077212184668f) * 289.0f);
  float _1160 = _1144 - (floor(_1144 * 0.020408164709806442f) * 49.0f);
  float _1161 = _1145 - (floor(_1145 * 0.020408164709806442f) * 49.0f);
  float _1162 = _1146 - (floor(_1146 * 0.020408164709806442f) * 49.0f);
  float _1163 = _1147 - (floor(_1147 * 0.020408164709806442f) * 49.0f);
  float _1168 = floor(_1160 * 0.1428571492433548f);
  float _1169 = floor(_1161 * 0.1428571492433548f);
  float _1170 = floor(_1162 * 0.1428571492433548f);
  float _1171 = floor(_1163 * 0.1428571492433548f);
  float _1188 = (_1168 * 0.2857142984867096f) + -0.9285714030265808f;
  float _1189 = (_1169 * 0.2857142984867096f) + -0.9285714030265808f;
  float _1190 = (_1170 * 0.2857142984867096f) + -0.9285714030265808f;
  float _1191 = (_1171 * 0.2857142984867096f) + -0.9285714030265808f;
  float _1196 = (floor(_1160 - (_1168 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _1197 = (floor(_1161 - (_1169 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _1198 = (floor(_1162 - (_1170 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _1199 = (floor(_1163 - (_1171 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _1212 = (1.0f - abs(_1188)) - abs(_1196);
  float _1213 = (1.0f - abs(_1189)) - abs(_1197);
  float _1214 = (1.0f - abs(_1190)) - abs(_1198);
  float _1215 = (1.0f - abs(_1191)) - abs(_1199);
  float _1244 = select((_1212 > 0.0f), -0.0f, -1.0f);
  float _1245 = select((_1213 > 0.0f), -0.0f, -1.0f);
  float _1246 = select((_1214 > 0.0f), -0.0f, -1.0f);
  float _1247 = select((_1215 > 0.0f), -0.0f, -1.0f);
  float _1252 = (((floor(_1188) * 2.0f) + 1.0f) * _1244) + _1188;
  float _1253 = (((floor(_1196) * 2.0f) + 1.0f) * _1244) + _1196;
  float _1254 = (((floor(_1189) * 2.0f) + 1.0f) * _1245) + _1189;
  float _1255 = (((floor(_1197) * 2.0f) + 1.0f) * _1245) + _1197;
  float _1260 = (((floor(_1190) * 2.0f) + 1.0f) * _1246) + _1190;
  float _1261 = (((floor(_1198) * 2.0f) + 1.0f) * _1246) + _1198;
  float _1262 = (((floor(_1191) * 2.0f) + 1.0f) * _1247) + _1191;
  float _1263 = (((floor(_1199) * 2.0f) + 1.0f) * _1247) + _1199;
  float _1272 = 1.7928400039672852f - (dot(float3(_1252, _1253, _1212), float3(_1252, _1253, _1212)) * 0.8537350296974182f);
  float _1273 = 1.7928400039672852f - (dot(float3(_1254, _1255, _1213), float3(_1254, _1255, _1213)) * 0.8537350296974182f);
  float _1274 = 1.7928400039672852f - (dot(float3(_1260, _1261, _1214), float3(_1260, _1261, _1214)) * 0.8537350296974182f);
  float _1275 = 1.7928400039672852f - (dot(float3(_1262, _1263, _1215), float3(_1262, _1263, _1215)) * 0.8537350296974182f);
  float _1296 = max((0.6000000238418579f - dot(float3(_1002, _1003, _1004), float3(_1002, _1003, _1004))), 0.0f);
  float _1297 = max((0.6000000238418579f - dot(float3(_1023, _1024, _1025), float3(_1023, _1024, _1025))), 0.0f);
  float _1298 = max((0.6000000238418579f - dot(float3(_1029, _1030, _1031), float3(_1029, _1030, _1031))), 0.0f);
  float _1299 = max((0.6000000238418579f - dot(float3(_1032, _1033, _1034), float3(_1032, _1033, _1034))), 0.0f);
  float _1300 = _1296 * _1296;
  float _1301 = _1297 * _1297;
  float _1302 = _1298 * _1298;
  float _1303 = _1299 * _1299;
  float _1318 = saturate((((sin(_297 - (frame_consts.time * 1.5f)) * 0.15000000596046448f) + 0.050000011920928955f) + (dot(float4((_1300 * _1300), (_1301 * _1301), (_1302 * _1302), (_1303 * _1303)), float4(dot(float3((_1272 * _1252), (_1272 * _1253), (_1272 * _1212)), float3(_1002, _1003, _1004)), dot(float3((_1273 * _1254), (_1273 * _1255), (_1273 * _1213)), float3(_1023, _1024, _1025)), dot(float3((_1274 * _1260), (_1274 * _1261), (_1274 * _1214)), float3(_1029, _1030, _1031)), dot(float3((_1275 * _1262), (_1275 * _1263), (_1275 * _1215)), float3(_1032, _1033, _1034)))) * 21.0f)) * 4.0f);
  float _1322 = (_1318 * _1318) * (3.0f - (_1318 * 2.0f));
  float _1324 = (_1322 * 0.6499999761581421f) + 0.3499999940395355f;
  float _1346 = saturate(_640);
  float _1347 = saturate(_980);
  float _1369 = (((_184 * 1.2000000476837158f) * _189) * frame_consts.params.vignette.golden_intensity) * ((((saturate(11.0f - (sqrt((_281 * _281) + (_280 * _280)) / ((_978 * 0.039000000804662704f) + 0.08100000768899918f))) * _980) + (saturate(11.0f - (sqrt((_276 * _276) + _286) / ((_638 * 0.039000000804662704f) + 0.08100000768899918f))) * _640)) + (saturate(11.0f - (sqrt((_293 * _293) + _286) / ((_1322 * 0.039000000804662704f) + 0.08100000768899918f))) * _1324)) + (((((saturate(1.0f - (abs(_277) * 0.8333333134651184f)) * _1346) + (saturate(1.0f - (abs(dot(float2(_280, _281), float2(-0.8660253882408142f, 0.5f))) * 0.8333333134651184f)) * _1347)) * saturate(_1324)) + ((_1346 * saturate(1.0f - (abs(dot(float2(_276, _277), float2(0.8660253882408142f, 0.5f))) * 0.8333333134651184f))) * _1347)) * 0.5f));
  SV_Target.x = ((_1369 * ((_236 * _236) - _198)) + _198);
  SV_Target.y = ((_1369 * ((_237 * _237) - _199)) + _199);
  SV_Target.z = ((_1369 * ((_238 * _238) - _200)) + _200);
  if (RENODX_TONE_MAP_TYPE) {
    SV_Target.rgb = renodx::draw::ToneMapPass(_27.rgb, SV_Target.rgb);
  } else {
    SV_Target.rgb = saturate(SV_Target.rgb);
  }
  SV_Target.rgb = renodx::draw::RenderIntermediatePass(SV_Target.rgb);

  SV_Target.w = 1.0f;
  return SV_Target;
}
