#include "../shared.h"

struct Lod_params {
  struct Lod_brush_params {
    float4 brush_uv[4];
    float base_radius;
    float radius_variation;
    float radius_random;
    float blur;
    float alpha;
    float stretch;
  } brushes;
  struct Lod_noise_params {
    float chaos;
    float freq;
    float brightness;
    float saturation;
    float hue;
  } noise;
  struct Lod_outlines_params {
    float2 thickness;
    float2 softness;
    float2 displacement;
    float2 attenuation;
    float lighting_threshold;
    float lighting_threshold_softness;
    float2 lighting_dark;
    float2 lighting_bright;
    float2 discretion;
    float2 alpha;
  } outlines;
};

struct Frame_constants {
  float3 cam_world_pos;
  float time;
  float2 inv_near_dim;
  float proj_scale;
  uint flags;
  float2 half_vp_dim;
  int2 vp_dim;
  float2 vp_texel_size;
  int2 mouse_pos;
  int2 inspected_pix;
  int2 hi_z_0_dim;
  int supersampling;
  int debug_patches;
  int use_patches;
  int emissive;
  float3 target;
  uint frame_number;
  uint shot_frame_number;
  float dt;
  float4 view_to_world[4];
  float4 world_to_view[4];
  float4 view_ndc[4];
  float4 world_ndc[4];
  float4 prev_world_ndc[4];
  float4 ndc_world[4];
  float4 ndc_to_prev_ndc[4];
  float4 prev_ndc_to_ndc[4];
  float4 view_world_z0;
  float4 pix_to_fog_eq;
  float3 mio_view;
  float3 mio_hair_outline_color;
  float mio_foliage_velocity;
  int show_wireframe;
  int ao;
  int glitch;
  int no_vertex_color;
  float paper_mult;
  int hatching;
  int mio_halo;
  int vol_temporal;
  int heart_attack_active;
  int heart_attack_secondary_target;
  int triangular_dissolve_enabled;
  int color_correct;
  float starfield_effect_amount;
  float starfield_fade_amount;
  float3 starfield_center_view;
  float starfield_glow_amount;
  float starfield_pulse_t;
  float death_anim_t;
  float3 game_plane_world_origin;
  float3 game_plane_world_normal;
  float3 game_plane_world_u;
  float3 game_plane_world_v;
  float4 game_plane_transform[4];
  float4 hatching_xf[4];
  float4 paper_xf[4];
  float2 game_plane_blend;
  float heart_attack_t;
  float heart_attack_duration;
  float heart_attack_pulse;
  float heart_attack_outline_distance;
  float heart_attack_dissolve_distance;
  float3 heart_attack_dissolve_color;
  float heart_attack_dissolve_base;
  float heart_attack_dissolve_mult;
  float3 heart_attack_dissolve_world_center;
  float heart_attack_vertical_dissolve;
  float triangular_dissolve_base_amount;
  float triangular_dissolve_amount;
  float flashback_lut;
  float evil_mio;
  float dead_mio;
  float godlike_mio;
  float khlia_pulse_t;
  float khlia__pulse_t;
  float khlia_pulse_period;
  float3 khlia_world_pos;
  float skydome_rotation_offset;
  float hatch_ambiant_mul;
  float hatch_ambiant_add;
  float glitch_scale;
  uint max_contours;
  uint max_contour_loops;
  int death_screen;
  float death_screen_t;
  int poetic_death_screen;
  float poetic_death_screen_t;
  float tremor_pulse_t;
  int invert;
  float surface_fade;
  struct Postprocess_params {
    struct AO_params {
      float3 color;
      float intensity;
    } ao;
    struct Fog_params {
      float bloom_factor;
      float space;
      float outline_density;
      float outline_attenuation;
    } fog;
    struct Ambient_light_params {
      int undercoat_grad;
      float3 color;
      float intensity;
      float gameplay_intensity;
      float gameplay_width;
      float directional_intensity;
      float directional_shadows;
      float undercoat_noise_freq;
      float undercoat_noise_amplitude;
      float undercoat_noise_threshold;
      float undercoating;
    } ambient_light;
    struct Vignette_params {
      float intensity;
      float rounded;
      float3 color;
      float golden_intensity;
      float golden_color;
    } vignette;
    struct Bloom_params {
      float intensity;
      float threshold_low;
      float threshold_high;
    } bloom;
    struct Mio_params {
      float light_intensity;
      float light_radius;
      float3 light_color;
      float spec_intensity;
      float3 halo_color;
      float halo_intensity;
    } mio;
    struct Particles_params {
      uint count;
      float cam_near;
      float cam_far;
      float fadeoff_near;
      float2 lifetime;
      float fadein_duration;
      float fadeoff_duration;
      float2 alpha;
      float2 scale;
      float2 speed;
      int gradient;
      float circle_attenuation;
    } particles;
    struct Chroma_aberration_params {
      float intensity;
    } chroma_aberration;
    struct Fade_params {
      float intensity;
      float3 color;
    } fade;
    struct Dof_params {
      float plane_01;
      float plane_01_softness;
      float plane_12;
      float plane_12_softness;
      float foreground;
      float foreground_softness;
    } dof;
    Lod_params lod_foreground;
    Lod_params lod_game;
    Lod_params lod_midground;
    Lod_params lod_background;
  } params;
};


Texture2D<float4> tex : register(t0);

Texture2D<float> depth_tex : register(t1);

Texture2D<float> paper_tex : register(t5);

Texture2D<float3> bloom_tex : register(t7);

Texture2D<float3> color_correct_lut : register(t8);

cbuffer frame_consts : register(b0) {
  Frame_constants frame_consts : packoffset(c000.x);
};

SamplerState sampler_nearest : register(s0);

SamplerState sampler_bilinear : register(s1);

SamplerState sampler_bilinear_wrap : register(s2);

float4 main(
  noperspective float4 SV_Position : SV_Position,
  linear float2 O_Uv : O_Uv
) : SV_Target {
  float4 SV_Target;
  float _15 = float((int)(frame_consts.vp_dim.x));
  float _16 = float((int)(frame_consts.vp_dim.y));
  float4 _17 = tex.SampleLevel(sampler_nearest, float2(O_Uv.x, O_Uv.y), 0.0f);
  float3 _21 = bloom_tex.SampleLevel(sampler_bilinear, float2(O_Uv.x, O_Uv.y), 0.0f);
  float _36 = max((((1.0f - (_17.y * 0.7152000069618225f)) - (_17.x * 0.2125999927520752f)) - (_17.z * 0.0722000002861023f)), 0.0010000000474974513f);
  float _40 = (_17.x / _36) + (frame_consts.params.bloom.intensity * _21.x);
  float _41 = (_17.y / _36) + (frame_consts.params.bloom.intensity * _21.y);
  float _42 = (_17.z / _36) + (frame_consts.params.bloom.intensity * _21.z);
  float _48 = (((_40 * 0.2125999927520752f) + 1.0f) + (_41 * 0.7152000069618225f)) + (_42 * 0.0722000002861023f);
  float _52 = saturate(_40 / _48);
  float _53 = saturate(_41 / _48);
  float _54 = saturate(_42 / _48);
  uint2 _55; color_correct_lut.GetDimensions(_55.x, _55.y);
  float _68;
  float _79;
  float _90;
  if (!(!(_52 <= 0.0031308000907301903f))) {
    _68 = (_52 * 12.920000076293945f);
  } else {
    _68 = (((pow(_52, 0.4166666567325592f)) * 1.0549999475479126f) + -0.054999999701976776f);
  }
  if (!(!(_53 <= 0.0031308000907301903f))) {
    _79 = (_53 * 12.920000076293945f);
  } else {
    _79 = (((pow(_53, 0.4166666567325592f)) * 1.0549999475479126f) + -0.054999999701976776f);
  }
  if (!(!(_54 <= 0.0031308000907301903f))) {
    _90 = (_54 * 12.920000076293945f);
  } else {
    _90 = (((pow(_54, 0.4166666567325592f)) * 1.0549999475479126f) + -0.054999999701976776f);
  }
  float _93 = float((uint)(_55.y + -1u));
  float _96 = _90 * _93;
  float _97 = frac(_96);
  float _99 = float((uint)_55.y);
  float _101 = (_68 * _93) + 0.5f;
  float _104 = float((uint)_55.x);
  float _106 = (lerp(_79, 1.0f, _93)) / _99;
  float3 _107 = color_correct_lut.SampleLevel(sampler_bilinear, float2((((ceil(_96) * _99) + _101) / _104), _106), 0.0f);
  float3 _115 = color_correct_lut.SampleLevel(sampler_bilinear, float2((((floor(_96) * _99) + _101) / _104), _106), 0.0f);
  float _125 = ((_107.x - _115.x) * _97) + _115.x;
  float _126 = ((_107.y - _115.y) * _97) + _115.y;
  float _127 = ((_107.z - _115.z) * _97) + _115.z;
  float _133 = depth_tex.SampleLevel(sampler_nearest, float2(O_Uv.x, O_Uv.y), 0.0f);
  float _137 = 10000.0f / ((_133.x * 19999.5f) + 0.5f);
  float _142 = (_137 * ((O_Uv.x * 2.0f) + -1.0f)) * frame_consts.inv_near_dim.x;
  float _144 = (_137 * (((1.0f - O_Uv.y) * 2.0f) + -1.0f)) * frame_consts.inv_near_dim.y;
  float _145 = -0.0f - _137;
  float _169 = mad((frame_consts.paper_xf[2].z), _145, mad((frame_consts.paper_xf[1].z), _144, (_142 * (frame_consts.paper_xf[0].z))));
  float _181 = exp2(round(log2(max(5.0f, (-0.0f - (_169 - frame_consts.game_plane_blend.x)))) * 10.0f) * 0.10000000149011612f);
  float _183 = min((1.0f / _181), 0.20000000298023224f);
  float _184 = frame_consts.game_plane_blend.x - _181;
  float _191 = paper_tex.SampleLevel(sampler_bilinear_wrap, float2((((_184 * (mad((frame_consts.paper_xf[2].x), _145, mad((frame_consts.paper_xf[1].x), _144, (_142 * (frame_consts.paper_xf[0].x)))) / _169)) + (frame_consts.paper_xf[3].x)) * _183), (((_184 * (mad((frame_consts.paper_xf[2].y), _145, mad((frame_consts.paper_xf[1].y), _144, (_142 * (frame_consts.paper_xf[0].y)))) / _169)) + (frame_consts.paper_xf[3].y)) * _183)), 0.0f);
  float _196 = (1.0f - _191.x) * frame_consts.paper_mult;
  float _211 = _15 / _16;
  float _223 = exp2(log2(saturate((frame_consts.params.vignette.intensity * abs(O_Uv.x + -0.5f)) * (((_211 + -1.0f) * frame_consts.params.vignette.rounded) + 1.0f))) * 5.0f);
  float _224 = exp2(log2(saturate(frame_consts.params.vignette.intensity * abs(O_Uv.y + -0.5f))) * 5.0f);
  float _230 = exp2(log2(saturate(1.0f - dot(float2(_223, _224), float2(_223, _224)))) * 6.0f);
  float _235 = 1.0f - _230;
  float _237 = 1.0f - (_235 * 0.8500000238418579f);
  float _244 = (_237 * ((_125 - (_196 * _125)) - frame_consts.params.vignette.color.x)) + frame_consts.params.vignette.color.x;
  float _245 = (_237 * ((_126 - (_196 * _126)) - frame_consts.params.vignette.color.y)) + frame_consts.params.vignette.color.y;
  float _246 = (_237 * ((_127 - (_196 * _127)) - frame_consts.params.vignette.color.z)) + frame_consts.params.vignette.color.z;
  float _250 = _15 * O_Uv.x;
  float _251 = _16 * O_Uv.y;
  float _252 = _250 + _251;
  float _258 = frac(_252 * 0.0033333334140479565f) + -0.5f;
  float _259 = frac((_251 - _250) * 0.0033333334140479565f) + -0.5f;
  float _265 = saturate(sqrt((_259 * _259) + (_258 * _258)) * 2.0f);
  float _276 = saturate((sin((_252 * 0.01666666753590107f) - (frame_consts.time * 0.8500000238418579f)) * 1.2500001192092896f) + -0.25000008940696716f);
  float _281 = ((_276 * _276) * 0.2199999988079071f) * (3.0f - (_276 * 2.0f));
  float _282 = _281 + 0.9777389168739319f;
  float _283 = ((_265 * 0.13274884223937988f) + 0.7175776362419128f) + _281;
  float _284 = ((_265 * 0.3335757553577423f) + 0.30871906876564026f) + _281;
  float _289 = (O_Uv.x * 1080.0f) * _211;
  float _290 = O_Uv.y * 1080.0f;
  float _291 = _289 * 0.04444444552063942f;
  float _292 = O_Uv.y * 27.712812423706055f;
  float _294 = ceil(_291 - _292);
  float _297 = floor(O_Uv.y * 55.42562484741211f) + 1.0f;
  float _300 = ceil((-0.0f - _292) - _291);
  float _302 = (_297 + _294) + _300;
  float _304 = (_302 * 22.5f) + -33.75f;
  float _305 = _294 - _300;
  float _307 = _305 * 11.25f;
  float _313 = (((_297 * 0.5773502588272095f) - (_294 * 0.28867512941360474f)) - (_300 * 0.28867512941360474f)) * 22.5f;
  float _316 = _304 + _307;
  float _317 = _313 + (19.485570907592773f - (_302 * 12.990381240844727f));
  float _320 = ((_302 * 25.980762481689453f) + -38.97114181518555f) + _313;
  float _321 = _307 - _304;
  float _322 = _316 - _289;
  float _323 = _317 - _290;
  float _326 = _307 - _289;
  float _327 = _320 - _290;
  float _332 = _323 * _323;
  float _339 = _321 - _289;
  float _343 = _317 * 2.5f;
  float _344 = frame_consts.time * 1.5f;
  float _348 = _317 * 0.004444444552063942f;
  float _349 = frame_consts.time * 0.15000000596046448f;
  float _350 = (_316 * 0.04444444552063942f) - _349;
  float _351 = _348 - _349;
  float _352 = frame_consts.time * 0.02500000037252903f;
  float _353 = dot(float3(_350, _351, _352), float3(0.3333333432674408f, 0.3333333432674408f, 0.3333333432674408f));
  float _357 = floor(_353 + _350);
  float _358 = floor(_353 + _351);
  float _359 = floor(_353 + _352);
  float _363 = dot(float3(_357, _358, _359), float3(0.1666666716337204f, 0.1666666716337204f, 0.1666666716337204f));
  float _364 = _363 + (_350 - _357);
  float _365 = _363 + (_351 - _358);
  float _366 = (_352 - _359) + _363;
  float _370 = select((_364 < _365), 0.0f, 1.0f);
  float _371 = select((_365 < _366), 0.0f, 1.0f);
  float _372 = select((_366 < _364), 0.0f, 1.0f);
  float _373 = 1.0f - _370;
  float _374 = 1.0f - _371;
  float _375 = 1.0f - _372;
  float _376 = min(_370, _375);
  float _377 = min(_371, _373);
  float _378 = min(_372, _374);
  float _379 = max(_370, _375);
  float _380 = max(_371, _373);
  float _381 = max(_372, _374);
  float _385 = (_364 - _376) + 0.1666666716337204f;
  float _386 = (_365 - _377) + 0.1666666716337204f;
  float _387 = (_366 - _378) + 0.1666666716337204f;
  float _391 = (_364 - _379) + 0.3333333432674408f;
  float _392 = (_365 - _380) + 0.3333333432674408f;
  float _393 = (_366 - _381) + 0.3333333432674408f;
  float _394 = _364 + -0.5f;
  float _395 = _365 + -0.5f;
  float _396 = _366 + -0.5f;
  float _406 = _357 - (floor(_357 * 0.0034602077212184668f) * 289.0f);
  float _407 = _358 - (floor(_358 * 0.0034602077212184668f) * 289.0f);
  float _408 = _359 - (floor(_359 * 0.0034602077212184668f) * 289.0f);
  float _409 = _408 + _378;
  float _410 = _408 + _381;
  float _411 = _408 + 1.0f;
  float _420 = ((_408 * 34.0f) + 1.0f) * _408;
  float _421 = ((_409 * 34.0f) + 1.0f) * _409;
  float _422 = ((_410 * 34.0f) + 1.0f) * _410;
  float _423 = ((_411 * 34.0f) + 1.0f) * _411;
  float _437 = (_420 - (floor(_420 * 0.0034602077212184668f) * 289.0f)) + _407;
  float _440 = ((_407 + _377) - (floor(_421 * 0.0034602077212184668f) * 289.0f)) + _421;
  float _443 = ((_407 + _380) - (floor(_422 * 0.0034602077212184668f) * 289.0f)) + _422;
  float _446 = ((_407 + 1.0f) - (floor(_423 * 0.0034602077212184668f) * 289.0f)) + _423;
  float _455 = ((_437 * 34.0f) + 1.0f) * _437;
  float _456 = ((_440 * 34.0f) + 1.0f) * _440;
  float _457 = ((_443 * 34.0f) + 1.0f) * _443;
  float _458 = ((_446 * 34.0f) + 1.0f) * _446;
  float _472 = (_455 - (floor(_455 * 0.0034602077212184668f) * 289.0f)) + _406;
  float _475 = ((_406 + _376) - (floor(_456 * 0.0034602077212184668f) * 289.0f)) + _456;
  float _478 = ((_406 + _379) - (floor(_457 * 0.0034602077212184668f) * 289.0f)) + _457;
  float _481 = ((_406 + 1.0f) - (floor(_458 * 0.0034602077212184668f) * 289.0f)) + _458;
  float _490 = ((_472 * 34.0f) + 1.0f) * _472;
  float _491 = ((_475 * 34.0f) + 1.0f) * _475;
  float _492 = ((_478 * 34.0f) + 1.0f) * _478;
  float _493 = ((_481 * 34.0f) + 1.0f) * _481;
  float _506 = _490 - (floor(_490 * 0.0034602077212184668f) * 289.0f);
  float _507 = _491 - (floor(_491 * 0.0034602077212184668f) * 289.0f);
  float _508 = _492 - (floor(_492 * 0.0034602077212184668f) * 289.0f);
  float _509 = _493 - (floor(_493 * 0.0034602077212184668f) * 289.0f);
  float _522 = _506 - (floor(_506 * 0.020408164709806442f) * 49.0f);
  float _523 = _507 - (floor(_507 * 0.020408164709806442f) * 49.0f);
  float _524 = _508 - (floor(_508 * 0.020408164709806442f) * 49.0f);
  float _525 = _509 - (floor(_509 * 0.020408164709806442f) * 49.0f);
  float _530 = floor(_522 * 0.1428571492433548f);
  float _531 = floor(_523 * 0.1428571492433548f);
  float _532 = floor(_524 * 0.1428571492433548f);
  float _533 = floor(_525 * 0.1428571492433548f);
  float _550 = (_530 * 0.2857142984867096f) + -0.9285714030265808f;
  float _551 = (_531 * 0.2857142984867096f) + -0.9285714030265808f;
  float _552 = (_532 * 0.2857142984867096f) + -0.9285714030265808f;
  float _553 = (_533 * 0.2857142984867096f) + -0.9285714030265808f;
  float _558 = (floor(_522 - (_530 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _559 = (floor(_523 - (_531 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _560 = (floor(_524 - (_532 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _561 = (floor(_525 - (_533 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _574 = (1.0f - abs(_550)) - abs(_558);
  float _575 = (1.0f - abs(_551)) - abs(_559);
  float _576 = (1.0f - abs(_552)) - abs(_560);
  float _577 = (1.0f - abs(_553)) - abs(_561);
  float _606 = select((_574 > 0.0f), -0.0f, -1.0f);
  float _607 = select((_575 > 0.0f), -0.0f, -1.0f);
  float _608 = select((_576 > 0.0f), -0.0f, -1.0f);
  float _609 = select((_577 > 0.0f), -0.0f, -1.0f);
  float _614 = (((floor(_550) * 2.0f) + 1.0f) * _606) + _550;
  float _615 = (((floor(_558) * 2.0f) + 1.0f) * _606) + _558;
  float _616 = (((floor(_551) * 2.0f) + 1.0f) * _607) + _551;
  float _617 = (((floor(_559) * 2.0f) + 1.0f) * _607) + _559;
  float _622 = (((floor(_552) * 2.0f) + 1.0f) * _608) + _552;
  float _623 = (((floor(_560) * 2.0f) + 1.0f) * _608) + _560;
  float _624 = (((floor(_553) * 2.0f) + 1.0f) * _609) + _553;
  float _625 = (((floor(_561) * 2.0f) + 1.0f) * _609) + _561;
  float _634 = 1.7928400039672852f - (dot(float3(_614, _615, _574), float3(_614, _615, _574)) * 0.8537350296974182f);
  float _635 = 1.7928400039672852f - (dot(float3(_616, _617, _575), float3(_616, _617, _575)) * 0.8537350296974182f);
  float _636 = 1.7928400039672852f - (dot(float3(_622, _623, _576), float3(_622, _623, _576)) * 0.8537350296974182f);
  float _637 = 1.7928400039672852f - (dot(float3(_624, _625, _577), float3(_624, _625, _577)) * 0.8537350296974182f);
  float _658 = max((0.6000000238418579f - dot(float3(_364, _365, _366), float3(_364, _365, _366))), 0.0f);
  float _659 = max((0.6000000238418579f - dot(float3(_385, _386, _387), float3(_385, _386, _387))), 0.0f);
  float _660 = max((0.6000000238418579f - dot(float3(_391, _392, _393), float3(_391, _392, _393))), 0.0f);
  float _661 = max((0.6000000238418579f - dot(float3(_394, _395, _396), float3(_394, _395, _396))), 0.0f);
  float _662 = _658 * _658;
  float _663 = _659 * _659;
  float _664 = _660 * _660;
  float _665 = _661 * _661;
  float _680 = saturate((((sin(_343 - _344) * 0.15000000596046448f) + 0.050000011920928955f) + (dot(float4((_662 * _662), (_663 * _663), (_664 * _664), (_665 * _665)), float4(dot(float3((_634 * _614), (_634 * _615), (_634 * _574)), float3(_364, _365, _366)), dot(float3((_635 * _616), (_635 * _617), (_635 * _575)), float3(_385, _386, _387)), dot(float3((_636 * _622), (_636 * _623), (_636 * _576)), float3(_391, _392, _393)), dot(float3((_637 * _624), (_637 * _625), (_637 * _577)), float3(_394, _395, _396)))) * 21.0f)) * 4.0f);
  float _684 = (_680 * _680) * (3.0f - (_680 * 2.0f));
  float _686 = (_684 * 0.6499999761581421f) + 0.3499999940395355f;
  float _691 = (_305 * 0.5f) - _349;
  float _692 = (_320 * 0.004444444552063942f) - _349;
  float _693 = dot(float3(_691, _692, _352), float3(0.3333333432674408f, 0.3333333432674408f, 0.3333333432674408f));
  float _697 = floor(_693 + _691);
  float _698 = floor(_693 + _692);
  float _699 = floor(_693 + _352);
  float _703 = dot(float3(_697, _698, _699), float3(0.1666666716337204f, 0.1666666716337204f, 0.1666666716337204f));
  float _704 = _703 + (_691 - _697);
  float _705 = _703 + (_692 - _698);
  float _706 = (_352 - _699) + _703;
  float _710 = select((_704 < _705), 0.0f, 1.0f);
  float _711 = select((_705 < _706), 0.0f, 1.0f);
  float _712 = select((_706 < _704), 0.0f, 1.0f);
  float _713 = 1.0f - _710;
  float _714 = 1.0f - _711;
  float _715 = 1.0f - _712;
  float _716 = min(_710, _715);
  float _717 = min(_711, _713);
  float _718 = min(_712, _714);
  float _719 = max(_710, _715);
  float _720 = max(_711, _713);
  float _721 = max(_712, _714);
  float _725 = (_704 - _716) + 0.1666666716337204f;
  float _726 = (_705 - _717) + 0.1666666716337204f;
  float _727 = (_706 - _718) + 0.1666666716337204f;
  float _731 = (_704 - _719) + 0.3333333432674408f;
  float _732 = (_705 - _720) + 0.3333333432674408f;
  float _733 = (_706 - _721) + 0.3333333432674408f;
  float _734 = _704 + -0.5f;
  float _735 = _705 + -0.5f;
  float _736 = _706 + -0.5f;
  float _746 = _697 - (floor(_697 * 0.0034602077212184668f) * 289.0f);
  float _747 = _698 - (floor(_698 * 0.0034602077212184668f) * 289.0f);
  float _748 = _699 - (floor(_699 * 0.0034602077212184668f) * 289.0f);
  float _749 = _748 + _718;
  float _750 = _748 + _721;
  float _751 = _748 + 1.0f;
  float _760 = ((_748 * 34.0f) + 1.0f) * _748;
  float _761 = ((_749 * 34.0f) + 1.0f) * _749;
  float _762 = ((_750 * 34.0f) + 1.0f) * _750;
  float _763 = ((_751 * 34.0f) + 1.0f) * _751;
  float _777 = (_760 - (floor(_760 * 0.0034602077212184668f) * 289.0f)) + _747;
  float _780 = ((_747 + _717) - (floor(_761 * 0.0034602077212184668f) * 289.0f)) + _761;
  float _783 = ((_747 + _720) - (floor(_762 * 0.0034602077212184668f) * 289.0f)) + _762;
  float _786 = ((_747 + 1.0f) - (floor(_763 * 0.0034602077212184668f) * 289.0f)) + _763;
  float _795 = ((_777 * 34.0f) + 1.0f) * _777;
  float _796 = ((_780 * 34.0f) + 1.0f) * _780;
  float _797 = ((_783 * 34.0f) + 1.0f) * _783;
  float _798 = ((_786 * 34.0f) + 1.0f) * _786;
  float _812 = (_795 - (floor(_795 * 0.0034602077212184668f) * 289.0f)) + _746;
  float _815 = ((_746 + _716) - (floor(_796 * 0.0034602077212184668f) * 289.0f)) + _796;
  float _818 = ((_746 + _719) - (floor(_797 * 0.0034602077212184668f) * 289.0f)) + _797;
  float _821 = ((_746 + 1.0f) - (floor(_798 * 0.0034602077212184668f) * 289.0f)) + _798;
  float _830 = ((_812 * 34.0f) + 1.0f) * _812;
  float _831 = ((_815 * 34.0f) + 1.0f) * _815;
  float _832 = ((_818 * 34.0f) + 1.0f) * _818;
  float _833 = ((_821 * 34.0f) + 1.0f) * _821;
  float _846 = _830 - (floor(_830 * 0.0034602077212184668f) * 289.0f);
  float _847 = _831 - (floor(_831 * 0.0034602077212184668f) * 289.0f);
  float _848 = _832 - (floor(_832 * 0.0034602077212184668f) * 289.0f);
  float _849 = _833 - (floor(_833 * 0.0034602077212184668f) * 289.0f);
  float _862 = _846 - (floor(_846 * 0.020408164709806442f) * 49.0f);
  float _863 = _847 - (floor(_847 * 0.020408164709806442f) * 49.0f);
  float _864 = _848 - (floor(_848 * 0.020408164709806442f) * 49.0f);
  float _865 = _849 - (floor(_849 * 0.020408164709806442f) * 49.0f);
  float _870 = floor(_862 * 0.1428571492433548f);
  float _871 = floor(_863 * 0.1428571492433548f);
  float _872 = floor(_864 * 0.1428571492433548f);
  float _873 = floor(_865 * 0.1428571492433548f);
  float _890 = (_870 * 0.2857142984867096f) + -0.9285714030265808f;
  float _891 = (_871 * 0.2857142984867096f) + -0.9285714030265808f;
  float _892 = (_872 * 0.2857142984867096f) + -0.9285714030265808f;
  float _893 = (_873 * 0.2857142984867096f) + -0.9285714030265808f;
  float _898 = (floor(_862 - (_870 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _899 = (floor(_863 - (_871 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _900 = (floor(_864 - (_872 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _901 = (floor(_865 - (_873 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _914 = (1.0f - abs(_890)) - abs(_898);
  float _915 = (1.0f - abs(_891)) - abs(_899);
  float _916 = (1.0f - abs(_892)) - abs(_900);
  float _917 = (1.0f - abs(_893)) - abs(_901);
  float _946 = select((_914 > 0.0f), -0.0f, -1.0f);
  float _947 = select((_915 > 0.0f), -0.0f, -1.0f);
  float _948 = select((_916 > 0.0f), -0.0f, -1.0f);
  float _949 = select((_917 > 0.0f), -0.0f, -1.0f);
  float _954 = (((floor(_890) * 2.0f) + 1.0f) * _946) + _890;
  float _955 = (((floor(_898) * 2.0f) + 1.0f) * _946) + _898;
  float _956 = (((floor(_891) * 2.0f) + 1.0f) * _947) + _891;
  float _957 = (((floor(_899) * 2.0f) + 1.0f) * _947) + _899;
  float _962 = (((floor(_892) * 2.0f) + 1.0f) * _948) + _892;
  float _963 = (((floor(_900) * 2.0f) + 1.0f) * _948) + _900;
  float _964 = (((floor(_893) * 2.0f) + 1.0f) * _949) + _893;
  float _965 = (((floor(_901) * 2.0f) + 1.0f) * _949) + _901;
  float _974 = 1.7928400039672852f - (dot(float3(_954, _955, _914), float3(_954, _955, _914)) * 0.8537350296974182f);
  float _975 = 1.7928400039672852f - (dot(float3(_956, _957, _915), float3(_956, _957, _915)) * 0.8537350296974182f);
  float _976 = 1.7928400039672852f - (dot(float3(_962, _963, _916), float3(_962, _963, _916)) * 0.8537350296974182f);
  float _977 = 1.7928400039672852f - (dot(float3(_964, _965, _917), float3(_964, _965, _917)) * 0.8537350296974182f);
  float _998 = max((0.6000000238418579f - dot(float3(_704, _705, _706), float3(_704, _705, _706))), 0.0f);
  float _999 = max((0.6000000238418579f - dot(float3(_725, _726, _727), float3(_725, _726, _727))), 0.0f);
  float _1000 = max((0.6000000238418579f - dot(float3(_731, _732, _733), float3(_731, _732, _733))), 0.0f);
  float _1001 = max((0.6000000238418579f - dot(float3(_734, _735, _736), float3(_734, _735, _736))), 0.0f);
  float _1002 = _998 * _998;
  float _1003 = _999 * _999;
  float _1004 = _1000 * _1000;
  float _1005 = _1001 * _1001;
  float _1020 = saturate((((sin((_320 * 2.5f) - _344) * 0.15000000596046448f) + 0.050000011920928955f) + (dot(float4((_1002 * _1002), (_1003 * _1003), (_1004 * _1004), (_1005 * _1005)), float4(dot(float3((_974 * _954), (_974 * _955), (_974 * _914)), float3(_704, _705, _706)), dot(float3((_975 * _956), (_975 * _957), (_975 * _915)), float3(_725, _726, _727)), dot(float3((_976 * _962), (_976 * _963), (_976 * _916)), float3(_731, _732, _733)), dot(float3((_977 * _964), (_977 * _965), (_977 * _917)), float3(_734, _735, _736)))) * 21.0f)) * 4.0f);
  float _1024 = (_1020 * _1020) * (3.0f - (_1020 * 2.0f));
  float _1026 = (_1024 * 0.6499999761581421f) + 0.3499999940395355f;
  float _1033 = frame_consts.time * 0.15000000596046448f;
  float _1034 = (_321 * 0.04444444552063942f) - _1033;
  float _1035 = _348 - _1033;
  float _1036 = frame_consts.time * 0.02500000037252903f;
  float _1037 = dot(float3(_1034, _1035, _1036), float3(0.3333333432674408f, 0.3333333432674408f, 0.3333333432674408f));
  float _1041 = floor(_1034 + _1037);
  float _1042 = floor(_1035 + _1037);
  float _1043 = floor(_1036 + _1037);
  float _1047 = dot(float3(_1041, _1042, _1043), float3(0.1666666716337204f, 0.1666666716337204f, 0.1666666716337204f));
  float _1048 = _1047 + (_1034 - _1041);
  float _1049 = _1047 + (_1035 - _1042);
  float _1050 = (_1036 - _1043) + _1047;
  float _1054 = select((_1048 < _1049), 0.0f, 1.0f);
  float _1055 = select((_1049 < _1050), 0.0f, 1.0f);
  float _1056 = select((_1050 < _1048), 0.0f, 1.0f);
  float _1057 = 1.0f - _1054;
  float _1058 = 1.0f - _1055;
  float _1059 = 1.0f - _1056;
  float _1060 = min(_1054, _1059);
  float _1061 = min(_1055, _1057);
  float _1062 = min(_1056, _1058);
  float _1063 = max(_1054, _1059);
  float _1064 = max(_1055, _1057);
  float _1065 = max(_1056, _1058);
  float _1069 = (_1048 - _1060) + 0.1666666716337204f;
  float _1070 = (_1049 - _1061) + 0.1666666716337204f;
  float _1071 = (_1050 - _1062) + 0.1666666716337204f;
  float _1075 = (_1048 - _1063) + 0.3333333432674408f;
  float _1076 = (_1049 - _1064) + 0.3333333432674408f;
  float _1077 = (_1050 - _1065) + 0.3333333432674408f;
  float _1078 = _1048 + -0.5f;
  float _1079 = _1049 + -0.5f;
  float _1080 = _1050 + -0.5f;
  float _1090 = _1041 - (floor(_1041 * 0.0034602077212184668f) * 289.0f);
  float _1091 = _1042 - (floor(_1042 * 0.0034602077212184668f) * 289.0f);
  float _1092 = _1043 - (floor(_1043 * 0.0034602077212184668f) * 289.0f);
  float _1093 = _1092 + _1062;
  float _1094 = _1092 + _1065;
  float _1095 = _1092 + 1.0f;
  float _1104 = ((_1092 * 34.0f) + 1.0f) * _1092;
  float _1105 = ((_1093 * 34.0f) + 1.0f) * _1093;
  float _1106 = ((_1094 * 34.0f) + 1.0f) * _1094;
  float _1107 = ((_1095 * 34.0f) + 1.0f) * _1095;
  float _1121 = (_1104 - (floor(_1104 * 0.0034602077212184668f) * 289.0f)) + _1091;
  float _1124 = ((_1091 + _1061) - (floor(_1105 * 0.0034602077212184668f) * 289.0f)) + _1105;
  float _1127 = ((_1091 + _1064) - (floor(_1106 * 0.0034602077212184668f) * 289.0f)) + _1106;
  float _1130 = ((_1091 + 1.0f) - (floor(_1107 * 0.0034602077212184668f) * 289.0f)) + _1107;
  float _1139 = ((_1121 * 34.0f) + 1.0f) * _1121;
  float _1140 = ((_1124 * 34.0f) + 1.0f) * _1124;
  float _1141 = ((_1127 * 34.0f) + 1.0f) * _1127;
  float _1142 = ((_1130 * 34.0f) + 1.0f) * _1130;
  float _1156 = (_1139 - (floor(_1139 * 0.0034602077212184668f) * 289.0f)) + _1090;
  float _1159 = ((_1090 + _1060) - (floor(_1140 * 0.0034602077212184668f) * 289.0f)) + _1140;
  float _1162 = ((_1090 + _1063) - (floor(_1141 * 0.0034602077212184668f) * 289.0f)) + _1141;
  float _1165 = ((_1090 + 1.0f) - (floor(_1142 * 0.0034602077212184668f) * 289.0f)) + _1142;
  float _1174 = ((_1156 * 34.0f) + 1.0f) * _1156;
  float _1175 = ((_1159 * 34.0f) + 1.0f) * _1159;
  float _1176 = ((_1162 * 34.0f) + 1.0f) * _1162;
  float _1177 = ((_1165 * 34.0f) + 1.0f) * _1165;
  float _1190 = _1174 - (floor(_1174 * 0.0034602077212184668f) * 289.0f);
  float _1191 = _1175 - (floor(_1175 * 0.0034602077212184668f) * 289.0f);
  float _1192 = _1176 - (floor(_1176 * 0.0034602077212184668f) * 289.0f);
  float _1193 = _1177 - (floor(_1177 * 0.0034602077212184668f) * 289.0f);
  float _1206 = _1190 - (floor(_1190 * 0.020408164709806442f) * 49.0f);
  float _1207 = _1191 - (floor(_1191 * 0.020408164709806442f) * 49.0f);
  float _1208 = _1192 - (floor(_1192 * 0.020408164709806442f) * 49.0f);
  float _1209 = _1193 - (floor(_1193 * 0.020408164709806442f) * 49.0f);
  float _1214 = floor(_1206 * 0.1428571492433548f);
  float _1215 = floor(_1207 * 0.1428571492433548f);
  float _1216 = floor(_1208 * 0.1428571492433548f);
  float _1217 = floor(_1209 * 0.1428571492433548f);
  float _1234 = (_1214 * 0.2857142984867096f) + -0.9285714030265808f;
  float _1235 = (_1215 * 0.2857142984867096f) + -0.9285714030265808f;
  float _1236 = (_1216 * 0.2857142984867096f) + -0.9285714030265808f;
  float _1237 = (_1217 * 0.2857142984867096f) + -0.9285714030265808f;
  float _1242 = (floor(_1206 - (_1214 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _1243 = (floor(_1207 - (_1215 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _1244 = (floor(_1208 - (_1216 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _1245 = (floor(_1209 - (_1217 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _1258 = (1.0f - abs(_1234)) - abs(_1242);
  float _1259 = (1.0f - abs(_1235)) - abs(_1243);
  float _1260 = (1.0f - abs(_1236)) - abs(_1244);
  float _1261 = (1.0f - abs(_1237)) - abs(_1245);
  float _1290 = select((_1258 > 0.0f), -0.0f, -1.0f);
  float _1291 = select((_1259 > 0.0f), -0.0f, -1.0f);
  float _1292 = select((_1260 > 0.0f), -0.0f, -1.0f);
  float _1293 = select((_1261 > 0.0f), -0.0f, -1.0f);
  float _1298 = (((floor(_1234) * 2.0f) + 1.0f) * _1290) + _1234;
  float _1299 = (((floor(_1242) * 2.0f) + 1.0f) * _1290) + _1242;
  float _1300 = (((floor(_1235) * 2.0f) + 1.0f) * _1291) + _1235;
  float _1301 = (((floor(_1243) * 2.0f) + 1.0f) * _1291) + _1243;
  float _1306 = (((floor(_1236) * 2.0f) + 1.0f) * _1292) + _1236;
  float _1307 = (((floor(_1244) * 2.0f) + 1.0f) * _1292) + _1244;
  float _1308 = (((floor(_1237) * 2.0f) + 1.0f) * _1293) + _1237;
  float _1309 = (((floor(_1245) * 2.0f) + 1.0f) * _1293) + _1245;
  float _1318 = 1.7928400039672852f - (dot(float3(_1298, _1299, _1258), float3(_1298, _1299, _1258)) * 0.8537350296974182f);
  float _1319 = 1.7928400039672852f - (dot(float3(_1300, _1301, _1259), float3(_1300, _1301, _1259)) * 0.8537350296974182f);
  float _1320 = 1.7928400039672852f - (dot(float3(_1306, _1307, _1260), float3(_1306, _1307, _1260)) * 0.8537350296974182f);
  float _1321 = 1.7928400039672852f - (dot(float3(_1308, _1309, _1261), float3(_1308, _1309, _1261)) * 0.8537350296974182f);
  float _1342 = max((0.6000000238418579f - dot(float3(_1048, _1049, _1050), float3(_1048, _1049, _1050))), 0.0f);
  float _1343 = max((0.6000000238418579f - dot(float3(_1069, _1070, _1071), float3(_1069, _1070, _1071))), 0.0f);
  float _1344 = max((0.6000000238418579f - dot(float3(_1075, _1076, _1077), float3(_1075, _1076, _1077))), 0.0f);
  float _1345 = max((0.6000000238418579f - dot(float3(_1078, _1079, _1080), float3(_1078, _1079, _1080))), 0.0f);
  float _1346 = _1342 * _1342;
  float _1347 = _1343 * _1343;
  float _1348 = _1344 * _1344;
  float _1349 = _1345 * _1345;
  float _1364 = saturate((((sin(_343 - (frame_consts.time * 1.5f)) * 0.15000000596046448f) + 0.050000011920928955f) + (dot(float4((_1346 * _1346), (_1347 * _1347), (_1348 * _1348), (_1349 * _1349)), float4(dot(float3((_1318 * _1298), (_1318 * _1299), (_1318 * _1258)), float3(_1048, _1049, _1050)), dot(float3((_1319 * _1300), (_1319 * _1301), (_1319 * _1259)), float3(_1069, _1070, _1071)), dot(float3((_1320 * _1306), (_1320 * _1307), (_1320 * _1260)), float3(_1075, _1076, _1077)), dot(float3((_1321 * _1308), (_1321 * _1309), (_1321 * _1261)), float3(_1078, _1079, _1080)))) * 21.0f)) * 4.0f);
  float _1368 = (_1364 * _1364) * (3.0f - (_1364 * 2.0f));
  float _1370 = (_1368 * 0.6499999761581421f) + 0.3499999940395355f;
  float _1392 = saturate(_686);
  float _1393 = saturate(_1026);
  float _1415 = (((_230 * 1.2000000476837158f) * _235) * frame_consts.params.vignette.golden_intensity) * ((((saturate(11.0f - (sqrt((_327 * _327) + (_326 * _326)) / ((_1024 * 0.039000000804662704f) + 0.08100000768899918f))) * _1026) + (saturate(11.0f - (sqrt((_322 * _322) + _332) / ((_684 * 0.039000000804662704f) + 0.08100000768899918f))) * _686)) + (saturate(11.0f - (sqrt((_339 * _339) + _332) / ((_1368 * 0.039000000804662704f) + 0.08100000768899918f))) * _1370)) + (((((saturate(1.0f - (abs(_323) * 0.8333333134651184f)) * _1392) + (saturate(1.0f - (abs(dot(float2(_326, _327), float2(-0.8660253882408142f, 0.5f))) * 0.8333333134651184f)) * _1393)) * saturate(_1370)) + ((_1392 * saturate(1.0f - (abs(dot(float2(_322, _323), float2(0.8660253882408142f, 0.5f))) * 0.8333333134651184f))) * _1393)) * 0.5f));
  SV_Target.x = ((_1415 * ((_282 * _282) - _244)) + _244);
  SV_Target.y = ((_1415 * ((_283 * _283) - _245)) + _245);
  SV_Target.z = ((_1415 * ((_284 * _284) - _246)) + _246);
  if (RENODX_TONE_MAP_TYPE) {
    SV_Target.rgb = renodx::draw::ToneMapPass(_17.rgb, SV_Target.rgb);
  } else {
    SV_Target.rgb = saturate(SV_Target.rgb);
  }
  SV_Target.rgb = renodx::draw::RenderIntermediatePass(SV_Target.rgb);

  SV_Target.w = 1.0f;
  return SV_Target;
}
