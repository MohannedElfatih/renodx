#include "../shared.h"

struct Lod_params {
  struct Lod_brush_params {
    float4 brush_uv[4];
    float base_radius;
    float radius_variation;
    float radius_random;
    float blur;
    float alpha;
    float stretch;
  } brushes;
  struct Lod_noise_params {
    float chaos;
    float freq;
    float brightness;
    float saturation;
    float hue;
  } noise;
  struct Lod_outlines_params {
    float2 thickness;
    float2 softness;
    float2 displacement;
    float2 attenuation;
    float lighting_threshold;
    float lighting_threshold_softness;
    float2 lighting_dark;
    float2 lighting_bright;
    float2 discretion;
    float2 alpha;
  } outlines;
};

struct Frame_constants {
  float3 cam_world_pos;
  float time;
  float2 inv_near_dim;
  float proj_scale;
  uint flags;
  float2 half_vp_dim;
  int2 vp_dim;
  float2 vp_texel_size;
  int2 mouse_pos;
  int2 inspected_pix;
  int2 hi_z_0_dim;
  int supersampling;
  int debug_patches;
  int use_patches;
  int emissive;
  float3 target;
  uint frame_number;
  uint shot_frame_number;
  float dt;
  float4 view_to_world[4];
  float4 world_to_view[4];
  float4 view_ndc[4];
  float4 world_ndc[4];
  float4 prev_world_ndc[4];
  float4 ndc_world[4];
  float4 ndc_to_prev_ndc[4];
  float4 prev_ndc_to_ndc[4];
  float4 view_world_z0;
  float4 pix_to_fog_eq;
  float3 mio_view;
  float3 mio_hair_outline_color;
  float mio_foliage_velocity;
  int show_wireframe;
  int ao;
  int glitch;
  int no_vertex_color;
  float paper_mult;
  int hatching;
  int mio_halo;
  int vol_temporal;
  int heart_attack_active;
  int heart_attack_secondary_target;
  int triangular_dissolve_enabled;
  int color_correct;
  float starfield_effect_amount;
  float starfield_fade_amount;
  float3 starfield_center_view;
  float starfield_glow_amount;
  float starfield_pulse_t;
  float death_anim_t;
  float3 game_plane_world_origin;
  float3 game_plane_world_normal;
  float3 game_plane_world_u;
  float3 game_plane_world_v;
  float4 game_plane_transform[4];
  float4 hatching_xf[4];
  float4 paper_xf[4];
  float2 game_plane_blend;
  float heart_attack_t;
  float heart_attack_duration;
  float heart_attack_pulse;
  float heart_attack_outline_distance;
  float heart_attack_dissolve_distance;
  float3 heart_attack_dissolve_color;
  float heart_attack_dissolve_base;
  float heart_attack_dissolve_mult;
  float3 heart_attack_dissolve_world_center;
  float heart_attack_vertical_dissolve;
  float triangular_dissolve_base_amount;
  float triangular_dissolve_amount;
  float flashback_lut;
  float evil_mio;
  float dead_mio;
  float godlike_mio;
  float khlia_pulse_t;
  float khlia__pulse_t;
  float khlia_pulse_period;
  float3 khlia_world_pos;
  float skydome_rotation_offset;
  float hatch_ambiant_mul;
  float hatch_ambiant_add;
  float glitch_scale;
  uint max_contours;
  uint max_contour_loops;
  int death_screen;
  float death_screen_t;
  int poetic_death_screen;
  float poetic_death_screen_t;
  float tremor_pulse_t;
  int invert;
  float surface_fade;
  struct Postprocess_params {
    struct AO_params {
      float3 color;
      float intensity;
    } ao;
    struct Fog_params {
      float bloom_factor;
      float space;
      float outline_density;
      float outline_attenuation;
    } fog;
    struct Ambient_light_params {
      int undercoat_grad;
      float3 color;
      float intensity;
      float gameplay_intensity;
      float gameplay_width;
      float directional_intensity;
      float directional_shadows;
      float undercoat_noise_freq;
      float undercoat_noise_amplitude;
      float undercoat_noise_threshold;
      float undercoating;
    } ambient_light;
    struct Vignette_params {
      float intensity;
      float rounded;
      float3 color;
      float golden_intensity;
      float golden_color;
    } vignette;
    struct Bloom_params {
      float intensity;
      float threshold_low;
      float threshold_high;
    } bloom;
    struct Mio_params {
      float light_intensity;
      float light_radius;
      float3 light_color;
      float spec_intensity;
      float3 halo_color;
      float halo_intensity;
    } mio;
    struct Particles_params {
      uint count;
      float cam_near;
      float cam_far;
      float fadeoff_near;
      float2 lifetime;
      float fadein_duration;
      float fadeoff_duration;
      float2 alpha;
      float2 scale;
      float2 speed;
      int gradient;
      float circle_attenuation;
    } particles;
    struct Chroma_aberration_params {
      float intensity;
    } chroma_aberration;
    struct Fade_params {
      float intensity;
      float3 color;
    } fade;
    struct Dof_params {
      float plane_01;
      float plane_01_softness;
      float plane_12;
      float plane_12_softness;
      float foreground;
      float foreground_softness;
    } dof;
    Lod_params lod_foreground;
    Lod_params lod_game;
    Lod_params lod_midground;
    Lod_params lod_background;
  } params;
};


Texture2D<float4> tex : register(t0);

Texture2D<float> depth_tex : register(t1);

Texture2D<float> paper_tex : register(t5);

Texture2D<float3> bloom_tex : register(t7);

Texture2D<float3> color_correct_lut : register(t8);

cbuffer frame_consts : register(b0) {
  Frame_constants frame_consts : packoffset(c000.x);
};

SamplerState sampler_nearest : register(s0);

SamplerState sampler_bilinear : register(s1);

SamplerState sampler_bilinear_wrap : register(s2);

float4 main(
  noperspective float4 SV_Position : SV_Position,
  linear float2 O_Uv : O_Uv
) : SV_Target {
  float4 SV_Target;
  float _15 = float((int)(frame_consts.vp_dim.x));
  float _16 = float((int)(frame_consts.vp_dim.y));
  float4 _17 = tex.SampleLevel(sampler_nearest, float2(O_Uv.x, O_Uv.y), 0.0f);
  float3 _21 = bloom_tex.SampleLevel(sampler_bilinear, float2(O_Uv.x, O_Uv.y), 0.0f);
  float _36 = max((((1.0f - (_17.y * 0.7152000069618225f)) - (_17.x * 0.2125999927520752f)) - (_17.z * 0.0722000002861023f)), 0.0010000000474974513f);
  float _40 = (_17.x / _36) + (frame_consts.params.bloom.intensity * _21.x);
  float _41 = (_17.y / _36) + (frame_consts.params.bloom.intensity * _21.y);
  float _42 = (_17.z / _36) + (frame_consts.params.bloom.intensity * _21.z);
  float _48 = (((_40 * 0.2125999927520752f) + 1.0f) + (_41 * 0.7152000069618225f)) + (_42 * 0.0722000002861023f);
  float _52 = saturate(_40 / _48);
  float _53 = saturate(_41 / _48);
  float _54 = saturate(_42 / _48);
  uint2 _55; color_correct_lut.GetDimensions(_55.x, _55.y);
  float _68;
  float _79;
  float _90;
  if (!(!(_52 <= 0.0031308000907301903f))) {
    _68 = (_52 * 12.920000076293945f);
  } else {
    _68 = (((pow(_52, 0.4166666567325592f)) * 1.0549999475479126f) + -0.054999999701976776f);
  }
  if (!(!(_53 <= 0.0031308000907301903f))) {
    _79 = (_53 * 12.920000076293945f);
  } else {
    _79 = (((pow(_53, 0.4166666567325592f)) * 1.0549999475479126f) + -0.054999999701976776f);
  }
  if (!(!(_54 <= 0.0031308000907301903f))) {
    _90 = (_54 * 12.920000076293945f);
  } else {
    _90 = (((pow(_54, 0.4166666567325592f)) * 1.0549999475479126f) + -0.054999999701976776f);
  }
  float _93 = float((uint)(_55.y + -1u));
  float _96 = _90 * _93;
  float _97 = frac(_96);
  float _99 = float((uint)_55.y);
  float _101 = (_68 * _93) + 0.5f;
  float _104 = float((uint)_55.x);
  float _106 = (lerp(_79, 1.0f, _93)) / _99;
  float3 _107 = color_correct_lut.SampleLevel(sampler_bilinear, float2((((ceil(_96) * _99) + _101) / _104), _106), 0.0f);
  float3 _115 = color_correct_lut.SampleLevel(sampler_bilinear, float2((((floor(_96) * _99) + _101) / _104), _106), 0.0f);
  float _125 = ((_107.x - _115.x) * _97) + _115.x;
  float _126 = ((_107.y - _115.y) * _97) + _115.y;
  float _127 = ((_107.z - _115.z) * _97) + _115.z;
  float _133 = depth_tex.SampleLevel(sampler_nearest, float2(O_Uv.x, O_Uv.y), 0.0f);
  float _137 = 10000.0f / ((_133.x * 19999.5f) + 0.5f);
  float _142 = (_137 * ((O_Uv.x * 2.0f) + -1.0f)) * frame_consts.inv_near_dim.x;
  float _144 = (_137 * (((1.0f - O_Uv.y) * 2.0f) + -1.0f)) * frame_consts.inv_near_dim.y;
  float _145 = -0.0f - _137;
  float _169 = mad((frame_consts.paper_xf[2].z), _145, mad((frame_consts.paper_xf[1].z), _144, (_142 * (frame_consts.paper_xf[0].z))));
  float _170 = mad((frame_consts.paper_xf[2].x), _145, mad((frame_consts.paper_xf[1].x), _144, (_142 * (frame_consts.paper_xf[0].x)))) / _169;
  float _171 = mad((frame_consts.paper_xf[2].y), _145, mad((frame_consts.paper_xf[1].y), _144, (_142 * (frame_consts.paper_xf[0].y)))) / _169;
  float _183 = exp2(round(log2(max(5.0f, (-0.0f - (_169 - frame_consts.game_plane_blend.x)))) * 10.0f) * 0.10000000149011612f);
  float _185 = min((1.0f / _183), 0.20000000298023224f);
  float _186 = frame_consts.game_plane_blend.x - _183;
  float _193 = frame_consts.game_plane_blend.x + 10.0f;
  float _201 = exp2(round(log2(max(5.0f, (-0.0f - (_169 - _193)))) * 10.0f) * 0.10000000149011612f);
  float _203 = min((1.0f / _201), 0.20000000298023224f);
  float _204 = _193 - _201;
  float _211 = paper_tex.SampleLevel(sampler_bilinear_wrap, float2((((_186 * _170) + (frame_consts.paper_xf[3].x)) * _185), (((_186 * _171) + (frame_consts.paper_xf[3].y)) * _185)), 0.0f);
  float _214 = paper_tex.SampleLevel(sampler_bilinear_wrap, float2((((_204 * _170) + (frame_consts.paper_xf[3].x)) * _203), (((_204 * _171) + (frame_consts.paper_xf[3].y)) * _203)), 0.0f);
  float _221 = ((1.0f - (_211.x * (1.0f - frame_consts.game_plane_blend.y))) - (_214.x * frame_consts.game_plane_blend.y)) * frame_consts.paper_mult;
  float _236 = _15 / _16;
  float _248 = exp2(log2(saturate((frame_consts.params.vignette.intensity * abs(O_Uv.x + -0.5f)) * (((_236 + -1.0f) * frame_consts.params.vignette.rounded) + 1.0f))) * 5.0f);
  float _249 = exp2(log2(saturate(frame_consts.params.vignette.intensity * abs(O_Uv.y + -0.5f))) * 5.0f);
  float _255 = exp2(log2(saturate(1.0f - dot(float2(_248, _249), float2(_248, _249)))) * 6.0f);
  float _260 = 1.0f - _255;
  float _262 = 1.0f - (_260 * 0.8500000238418579f);
  float _269 = (_262 * ((_125 - (_221 * _125)) - frame_consts.params.vignette.color.x)) + frame_consts.params.vignette.color.x;
  float _270 = (_262 * ((_126 - (_221 * _126)) - frame_consts.params.vignette.color.y)) + frame_consts.params.vignette.color.y;
  float _271 = (_262 * ((_127 - (_221 * _127)) - frame_consts.params.vignette.color.z)) + frame_consts.params.vignette.color.z;
  float _275 = _15 * O_Uv.x;
  float _276 = _16 * O_Uv.y;
  float _277 = _275 + _276;
  float _283 = frac(_277 * 0.0033333334140479565f) + -0.5f;
  float _284 = frac((_276 - _275) * 0.0033333334140479565f) + -0.5f;
  float _290 = saturate(sqrt((_284 * _284) + (_283 * _283)) * 2.0f);
  float _301 = saturate((sin((_277 * 0.01666666753590107f) - (frame_consts.time * 0.8500000238418579f)) * 1.2500001192092896f) + -0.25000008940696716f);
  float _306 = ((_301 * _301) * 0.2199999988079071f) * (3.0f - (_301 * 2.0f));
  float _307 = _306 + 0.9777389168739319f;
  float _308 = ((_290 * 0.13274884223937988f) + 0.7175776362419128f) + _306;
  float _309 = ((_290 * 0.3335757553577423f) + 0.30871906876564026f) + _306;
  float _314 = (O_Uv.x * 1080.0f) * _236;
  float _315 = O_Uv.y * 1080.0f;
  float _316 = _314 * 0.04444444552063942f;
  float _317 = O_Uv.y * 27.712812423706055f;
  float _319 = ceil(_316 - _317);
  float _322 = floor(O_Uv.y * 55.42562484741211f) + 1.0f;
  float _325 = ceil((-0.0f - _317) - _316);
  float _327 = (_322 + _319) + _325;
  float _329 = (_327 * 22.5f) + -33.75f;
  float _330 = _319 - _325;
  float _332 = _330 * 11.25f;
  float _338 = (((_322 * 0.5773502588272095f) - (_319 * 0.28867512941360474f)) - (_325 * 0.28867512941360474f)) * 22.5f;
  float _341 = _329 + _332;
  float _342 = _338 + (19.485570907592773f - (_327 * 12.990381240844727f));
  float _345 = ((_327 * 25.980762481689453f) + -38.97114181518555f) + _338;
  float _346 = _332 - _329;
  float _347 = _341 - _314;
  float _348 = _342 - _315;
  float _351 = _332 - _314;
  float _352 = _345 - _315;
  float _357 = _348 * _348;
  float _364 = _346 - _314;
  float _368 = _342 * 2.5f;
  float _369 = frame_consts.time * 1.5f;
  float _373 = _342 * 0.004444444552063942f;
  float _374 = frame_consts.time * 0.15000000596046448f;
  float _375 = (_341 * 0.04444444552063942f) - _374;
  float _376 = _373 - _374;
  float _377 = frame_consts.time * 0.02500000037252903f;
  float _378 = dot(float3(_375, _376, _377), float3(0.3333333432674408f, 0.3333333432674408f, 0.3333333432674408f));
  float _382 = floor(_378 + _375);
  float _383 = floor(_378 + _376);
  float _384 = floor(_378 + _377);
  float _388 = dot(float3(_382, _383, _384), float3(0.1666666716337204f, 0.1666666716337204f, 0.1666666716337204f));
  float _389 = _388 + (_375 - _382);
  float _390 = _388 + (_376 - _383);
  float _391 = (_377 - _384) + _388;
  float _395 = select((_389 < _390), 0.0f, 1.0f);
  float _396 = select((_390 < _391), 0.0f, 1.0f);
  float _397 = select((_391 < _389), 0.0f, 1.0f);
  float _398 = 1.0f - _395;
  float _399 = 1.0f - _396;
  float _400 = 1.0f - _397;
  float _401 = min(_395, _400);
  float _402 = min(_396, _398);
  float _403 = min(_397, _399);
  float _404 = max(_395, _400);
  float _405 = max(_396, _398);
  float _406 = max(_397, _399);
  float _410 = (_389 - _401) + 0.1666666716337204f;
  float _411 = (_390 - _402) + 0.1666666716337204f;
  float _412 = (_391 - _403) + 0.1666666716337204f;
  float _416 = (_389 - _404) + 0.3333333432674408f;
  float _417 = (_390 - _405) + 0.3333333432674408f;
  float _418 = (_391 - _406) + 0.3333333432674408f;
  float _419 = _389 + -0.5f;
  float _420 = _390 + -0.5f;
  float _421 = _391 + -0.5f;
  float _431 = _382 - (floor(_382 * 0.0034602077212184668f) * 289.0f);
  float _432 = _383 - (floor(_383 * 0.0034602077212184668f) * 289.0f);
  float _433 = _384 - (floor(_384 * 0.0034602077212184668f) * 289.0f);
  float _434 = _433 + _403;
  float _435 = _433 + _406;
  float _436 = _433 + 1.0f;
  float _445 = ((_433 * 34.0f) + 1.0f) * _433;
  float _446 = ((_434 * 34.0f) + 1.0f) * _434;
  float _447 = ((_435 * 34.0f) + 1.0f) * _435;
  float _448 = ((_436 * 34.0f) + 1.0f) * _436;
  float _462 = (_445 - (floor(_445 * 0.0034602077212184668f) * 289.0f)) + _432;
  float _465 = ((_432 + _402) - (floor(_446 * 0.0034602077212184668f) * 289.0f)) + _446;
  float _468 = ((_432 + _405) - (floor(_447 * 0.0034602077212184668f) * 289.0f)) + _447;
  float _471 = ((_432 + 1.0f) - (floor(_448 * 0.0034602077212184668f) * 289.0f)) + _448;
  float _480 = ((_462 * 34.0f) + 1.0f) * _462;
  float _481 = ((_465 * 34.0f) + 1.0f) * _465;
  float _482 = ((_468 * 34.0f) + 1.0f) * _468;
  float _483 = ((_471 * 34.0f) + 1.0f) * _471;
  float _497 = (_480 - (floor(_480 * 0.0034602077212184668f) * 289.0f)) + _431;
  float _500 = ((_431 + _401) - (floor(_481 * 0.0034602077212184668f) * 289.0f)) + _481;
  float _503 = ((_431 + _404) - (floor(_482 * 0.0034602077212184668f) * 289.0f)) + _482;
  float _506 = ((_431 + 1.0f) - (floor(_483 * 0.0034602077212184668f) * 289.0f)) + _483;
  float _515 = ((_497 * 34.0f) + 1.0f) * _497;
  float _516 = ((_500 * 34.0f) + 1.0f) * _500;
  float _517 = ((_503 * 34.0f) + 1.0f) * _503;
  float _518 = ((_506 * 34.0f) + 1.0f) * _506;
  float _531 = _515 - (floor(_515 * 0.0034602077212184668f) * 289.0f);
  float _532 = _516 - (floor(_516 * 0.0034602077212184668f) * 289.0f);
  float _533 = _517 - (floor(_517 * 0.0034602077212184668f) * 289.0f);
  float _534 = _518 - (floor(_518 * 0.0034602077212184668f) * 289.0f);
  float _547 = _531 - (floor(_531 * 0.020408164709806442f) * 49.0f);
  float _548 = _532 - (floor(_532 * 0.020408164709806442f) * 49.0f);
  float _549 = _533 - (floor(_533 * 0.020408164709806442f) * 49.0f);
  float _550 = _534 - (floor(_534 * 0.020408164709806442f) * 49.0f);
  float _555 = floor(_547 * 0.1428571492433548f);
  float _556 = floor(_548 * 0.1428571492433548f);
  float _557 = floor(_549 * 0.1428571492433548f);
  float _558 = floor(_550 * 0.1428571492433548f);
  float _575 = (_555 * 0.2857142984867096f) + -0.9285714030265808f;
  float _576 = (_556 * 0.2857142984867096f) + -0.9285714030265808f;
  float _577 = (_557 * 0.2857142984867096f) + -0.9285714030265808f;
  float _578 = (_558 * 0.2857142984867096f) + -0.9285714030265808f;
  float _583 = (floor(_547 - (_555 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _584 = (floor(_548 - (_556 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _585 = (floor(_549 - (_557 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _586 = (floor(_550 - (_558 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _599 = (1.0f - abs(_575)) - abs(_583);
  float _600 = (1.0f - abs(_576)) - abs(_584);
  float _601 = (1.0f - abs(_577)) - abs(_585);
  float _602 = (1.0f - abs(_578)) - abs(_586);
  float _631 = select((_599 > 0.0f), -0.0f, -1.0f);
  float _632 = select((_600 > 0.0f), -0.0f, -1.0f);
  float _633 = select((_601 > 0.0f), -0.0f, -1.0f);
  float _634 = select((_602 > 0.0f), -0.0f, -1.0f);
  float _639 = (((floor(_575) * 2.0f) + 1.0f) * _631) + _575;
  float _640 = (((floor(_583) * 2.0f) + 1.0f) * _631) + _583;
  float _641 = (((floor(_576) * 2.0f) + 1.0f) * _632) + _576;
  float _642 = (((floor(_584) * 2.0f) + 1.0f) * _632) + _584;
  float _647 = (((floor(_577) * 2.0f) + 1.0f) * _633) + _577;
  float _648 = (((floor(_585) * 2.0f) + 1.0f) * _633) + _585;
  float _649 = (((floor(_578) * 2.0f) + 1.0f) * _634) + _578;
  float _650 = (((floor(_586) * 2.0f) + 1.0f) * _634) + _586;
  float _659 = 1.7928400039672852f - (dot(float3(_639, _640, _599), float3(_639, _640, _599)) * 0.8537350296974182f);
  float _660 = 1.7928400039672852f - (dot(float3(_641, _642, _600), float3(_641, _642, _600)) * 0.8537350296974182f);
  float _661 = 1.7928400039672852f - (dot(float3(_647, _648, _601), float3(_647, _648, _601)) * 0.8537350296974182f);
  float _662 = 1.7928400039672852f - (dot(float3(_649, _650, _602), float3(_649, _650, _602)) * 0.8537350296974182f);
  float _683 = max((0.6000000238418579f - dot(float3(_389, _390, _391), float3(_389, _390, _391))), 0.0f);
  float _684 = max((0.6000000238418579f - dot(float3(_410, _411, _412), float3(_410, _411, _412))), 0.0f);
  float _685 = max((0.6000000238418579f - dot(float3(_416, _417, _418), float3(_416, _417, _418))), 0.0f);
  float _686 = max((0.6000000238418579f - dot(float3(_419, _420, _421), float3(_419, _420, _421))), 0.0f);
  float _687 = _683 * _683;
  float _688 = _684 * _684;
  float _689 = _685 * _685;
  float _690 = _686 * _686;
  float _705 = saturate((((sin(_368 - _369) * 0.15000000596046448f) + 0.050000011920928955f) + (dot(float4((_687 * _687), (_688 * _688), (_689 * _689), (_690 * _690)), float4(dot(float3((_659 * _639), (_659 * _640), (_659 * _599)), float3(_389, _390, _391)), dot(float3((_660 * _641), (_660 * _642), (_660 * _600)), float3(_410, _411, _412)), dot(float3((_661 * _647), (_661 * _648), (_661 * _601)), float3(_416, _417, _418)), dot(float3((_662 * _649), (_662 * _650), (_662 * _602)), float3(_419, _420, _421)))) * 21.0f)) * 4.0f);
  float _709 = (_705 * _705) * (3.0f - (_705 * 2.0f));
  float _711 = (_709 * 0.6499999761581421f) + 0.3499999940395355f;
  float _716 = (_330 * 0.5f) - _374;
  float _717 = (_345 * 0.004444444552063942f) - _374;
  float _718 = dot(float3(_716, _717, _377), float3(0.3333333432674408f, 0.3333333432674408f, 0.3333333432674408f));
  float _722 = floor(_718 + _716);
  float _723 = floor(_718 + _717);
  float _724 = floor(_718 + _377);
  float _728 = dot(float3(_722, _723, _724), float3(0.1666666716337204f, 0.1666666716337204f, 0.1666666716337204f));
  float _729 = _728 + (_716 - _722);
  float _730 = _728 + (_717 - _723);
  float _731 = (_377 - _724) + _728;
  float _735 = select((_729 < _730), 0.0f, 1.0f);
  float _736 = select((_730 < _731), 0.0f, 1.0f);
  float _737 = select((_731 < _729), 0.0f, 1.0f);
  float _738 = 1.0f - _735;
  float _739 = 1.0f - _736;
  float _740 = 1.0f - _737;
  float _741 = min(_735, _740);
  float _742 = min(_736, _738);
  float _743 = min(_737, _739);
  float _744 = max(_735, _740);
  float _745 = max(_736, _738);
  float _746 = max(_737, _739);
  float _750 = (_729 - _741) + 0.1666666716337204f;
  float _751 = (_730 - _742) + 0.1666666716337204f;
  float _752 = (_731 - _743) + 0.1666666716337204f;
  float _756 = (_729 - _744) + 0.3333333432674408f;
  float _757 = (_730 - _745) + 0.3333333432674408f;
  float _758 = (_731 - _746) + 0.3333333432674408f;
  float _759 = _729 + -0.5f;
  float _760 = _730 + -0.5f;
  float _761 = _731 + -0.5f;
  float _771 = _722 - (floor(_722 * 0.0034602077212184668f) * 289.0f);
  float _772 = _723 - (floor(_723 * 0.0034602077212184668f) * 289.0f);
  float _773 = _724 - (floor(_724 * 0.0034602077212184668f) * 289.0f);
  float _774 = _773 + _743;
  float _775 = _773 + _746;
  float _776 = _773 + 1.0f;
  float _785 = ((_773 * 34.0f) + 1.0f) * _773;
  float _786 = ((_774 * 34.0f) + 1.0f) * _774;
  float _787 = ((_775 * 34.0f) + 1.0f) * _775;
  float _788 = ((_776 * 34.0f) + 1.0f) * _776;
  float _802 = (_785 - (floor(_785 * 0.0034602077212184668f) * 289.0f)) + _772;
  float _805 = ((_772 + _742) - (floor(_786 * 0.0034602077212184668f) * 289.0f)) + _786;
  float _808 = ((_772 + _745) - (floor(_787 * 0.0034602077212184668f) * 289.0f)) + _787;
  float _811 = ((_772 + 1.0f) - (floor(_788 * 0.0034602077212184668f) * 289.0f)) + _788;
  float _820 = ((_802 * 34.0f) + 1.0f) * _802;
  float _821 = ((_805 * 34.0f) + 1.0f) * _805;
  float _822 = ((_808 * 34.0f) + 1.0f) * _808;
  float _823 = ((_811 * 34.0f) + 1.0f) * _811;
  float _837 = (_820 - (floor(_820 * 0.0034602077212184668f) * 289.0f)) + _771;
  float _840 = ((_771 + _741) - (floor(_821 * 0.0034602077212184668f) * 289.0f)) + _821;
  float _843 = ((_771 + _744) - (floor(_822 * 0.0034602077212184668f) * 289.0f)) + _822;
  float _846 = ((_771 + 1.0f) - (floor(_823 * 0.0034602077212184668f) * 289.0f)) + _823;
  float _855 = ((_837 * 34.0f) + 1.0f) * _837;
  float _856 = ((_840 * 34.0f) + 1.0f) * _840;
  float _857 = ((_843 * 34.0f) + 1.0f) * _843;
  float _858 = ((_846 * 34.0f) + 1.0f) * _846;
  float _871 = _855 - (floor(_855 * 0.0034602077212184668f) * 289.0f);
  float _872 = _856 - (floor(_856 * 0.0034602077212184668f) * 289.0f);
  float _873 = _857 - (floor(_857 * 0.0034602077212184668f) * 289.0f);
  float _874 = _858 - (floor(_858 * 0.0034602077212184668f) * 289.0f);
  float _887 = _871 - (floor(_871 * 0.020408164709806442f) * 49.0f);
  float _888 = _872 - (floor(_872 * 0.020408164709806442f) * 49.0f);
  float _889 = _873 - (floor(_873 * 0.020408164709806442f) * 49.0f);
  float _890 = _874 - (floor(_874 * 0.020408164709806442f) * 49.0f);
  float _895 = floor(_887 * 0.1428571492433548f);
  float _896 = floor(_888 * 0.1428571492433548f);
  float _897 = floor(_889 * 0.1428571492433548f);
  float _898 = floor(_890 * 0.1428571492433548f);
  float _915 = (_895 * 0.2857142984867096f) + -0.9285714030265808f;
  float _916 = (_896 * 0.2857142984867096f) + -0.9285714030265808f;
  float _917 = (_897 * 0.2857142984867096f) + -0.9285714030265808f;
  float _918 = (_898 * 0.2857142984867096f) + -0.9285714030265808f;
  float _923 = (floor(_887 - (_895 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _924 = (floor(_888 - (_896 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _925 = (floor(_889 - (_897 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _926 = (floor(_890 - (_898 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _939 = (1.0f - abs(_915)) - abs(_923);
  float _940 = (1.0f - abs(_916)) - abs(_924);
  float _941 = (1.0f - abs(_917)) - abs(_925);
  float _942 = (1.0f - abs(_918)) - abs(_926);
  float _971 = select((_939 > 0.0f), -0.0f, -1.0f);
  float _972 = select((_940 > 0.0f), -0.0f, -1.0f);
  float _973 = select((_941 > 0.0f), -0.0f, -1.0f);
  float _974 = select((_942 > 0.0f), -0.0f, -1.0f);
  float _979 = (((floor(_915) * 2.0f) + 1.0f) * _971) + _915;
  float _980 = (((floor(_923) * 2.0f) + 1.0f) * _971) + _923;
  float _981 = (((floor(_916) * 2.0f) + 1.0f) * _972) + _916;
  float _982 = (((floor(_924) * 2.0f) + 1.0f) * _972) + _924;
  float _987 = (((floor(_917) * 2.0f) + 1.0f) * _973) + _917;
  float _988 = (((floor(_925) * 2.0f) + 1.0f) * _973) + _925;
  float _989 = (((floor(_918) * 2.0f) + 1.0f) * _974) + _918;
  float _990 = (((floor(_926) * 2.0f) + 1.0f) * _974) + _926;
  float _999 = 1.7928400039672852f - (dot(float3(_979, _980, _939), float3(_979, _980, _939)) * 0.8537350296974182f);
  float _1000 = 1.7928400039672852f - (dot(float3(_981, _982, _940), float3(_981, _982, _940)) * 0.8537350296974182f);
  float _1001 = 1.7928400039672852f - (dot(float3(_987, _988, _941), float3(_987, _988, _941)) * 0.8537350296974182f);
  float _1002 = 1.7928400039672852f - (dot(float3(_989, _990, _942), float3(_989, _990, _942)) * 0.8537350296974182f);
  float _1023 = max((0.6000000238418579f - dot(float3(_729, _730, _731), float3(_729, _730, _731))), 0.0f);
  float _1024 = max((0.6000000238418579f - dot(float3(_750, _751, _752), float3(_750, _751, _752))), 0.0f);
  float _1025 = max((0.6000000238418579f - dot(float3(_756, _757, _758), float3(_756, _757, _758))), 0.0f);
  float _1026 = max((0.6000000238418579f - dot(float3(_759, _760, _761), float3(_759, _760, _761))), 0.0f);
  float _1027 = _1023 * _1023;
  float _1028 = _1024 * _1024;
  float _1029 = _1025 * _1025;
  float _1030 = _1026 * _1026;
  float _1045 = saturate((((sin((_345 * 2.5f) - _369) * 0.15000000596046448f) + 0.050000011920928955f) + (dot(float4((_1027 * _1027), (_1028 * _1028), (_1029 * _1029), (_1030 * _1030)), float4(dot(float3((_999 * _979), (_999 * _980), (_999 * _939)), float3(_729, _730, _731)), dot(float3((_1000 * _981), (_1000 * _982), (_1000 * _940)), float3(_750, _751, _752)), dot(float3((_1001 * _987), (_1001 * _988), (_1001 * _941)), float3(_756, _757, _758)), dot(float3((_1002 * _989), (_1002 * _990), (_1002 * _942)), float3(_759, _760, _761)))) * 21.0f)) * 4.0f);
  float _1049 = (_1045 * _1045) * (3.0f - (_1045 * 2.0f));
  float _1051 = (_1049 * 0.6499999761581421f) + 0.3499999940395355f;
  float _1058 = frame_consts.time * 0.15000000596046448f;
  float _1059 = (_346 * 0.04444444552063942f) - _1058;
  float _1060 = _373 - _1058;
  float _1061 = frame_consts.time * 0.02500000037252903f;
  float _1062 = dot(float3(_1059, _1060, _1061), float3(0.3333333432674408f, 0.3333333432674408f, 0.3333333432674408f));
  float _1066 = floor(_1059 + _1062);
  float _1067 = floor(_1060 + _1062);
  float _1068 = floor(_1061 + _1062);
  float _1072 = dot(float3(_1066, _1067, _1068), float3(0.1666666716337204f, 0.1666666716337204f, 0.1666666716337204f));
  float _1073 = _1072 + (_1059 - _1066);
  float _1074 = _1072 + (_1060 - _1067);
  float _1075 = (_1061 - _1068) + _1072;
  float _1079 = select((_1073 < _1074), 0.0f, 1.0f);
  float _1080 = select((_1074 < _1075), 0.0f, 1.0f);
  float _1081 = select((_1075 < _1073), 0.0f, 1.0f);
  float _1082 = 1.0f - _1079;
  float _1083 = 1.0f - _1080;
  float _1084 = 1.0f - _1081;
  float _1085 = min(_1079, _1084);
  float _1086 = min(_1080, _1082);
  float _1087 = min(_1081, _1083);
  float _1088 = max(_1079, _1084);
  float _1089 = max(_1080, _1082);
  float _1090 = max(_1081, _1083);
  float _1094 = (_1073 - _1085) + 0.1666666716337204f;
  float _1095 = (_1074 - _1086) + 0.1666666716337204f;
  float _1096 = (_1075 - _1087) + 0.1666666716337204f;
  float _1100 = (_1073 - _1088) + 0.3333333432674408f;
  float _1101 = (_1074 - _1089) + 0.3333333432674408f;
  float _1102 = (_1075 - _1090) + 0.3333333432674408f;
  float _1103 = _1073 + -0.5f;
  float _1104 = _1074 + -0.5f;
  float _1105 = _1075 + -0.5f;
  float _1115 = _1066 - (floor(_1066 * 0.0034602077212184668f) * 289.0f);
  float _1116 = _1067 - (floor(_1067 * 0.0034602077212184668f) * 289.0f);
  float _1117 = _1068 - (floor(_1068 * 0.0034602077212184668f) * 289.0f);
  float _1118 = _1117 + _1087;
  float _1119 = _1117 + _1090;
  float _1120 = _1117 + 1.0f;
  float _1129 = ((_1117 * 34.0f) + 1.0f) * _1117;
  float _1130 = ((_1118 * 34.0f) + 1.0f) * _1118;
  float _1131 = ((_1119 * 34.0f) + 1.0f) * _1119;
  float _1132 = ((_1120 * 34.0f) + 1.0f) * _1120;
  float _1146 = (_1129 - (floor(_1129 * 0.0034602077212184668f) * 289.0f)) + _1116;
  float _1149 = ((_1116 + _1086) - (floor(_1130 * 0.0034602077212184668f) * 289.0f)) + _1130;
  float _1152 = ((_1116 + _1089) - (floor(_1131 * 0.0034602077212184668f) * 289.0f)) + _1131;
  float _1155 = ((_1116 + 1.0f) - (floor(_1132 * 0.0034602077212184668f) * 289.0f)) + _1132;
  float _1164 = ((_1146 * 34.0f) + 1.0f) * _1146;
  float _1165 = ((_1149 * 34.0f) + 1.0f) * _1149;
  float _1166 = ((_1152 * 34.0f) + 1.0f) * _1152;
  float _1167 = ((_1155 * 34.0f) + 1.0f) * _1155;
  float _1181 = (_1164 - (floor(_1164 * 0.0034602077212184668f) * 289.0f)) + _1115;
  float _1184 = ((_1115 + _1085) - (floor(_1165 * 0.0034602077212184668f) * 289.0f)) + _1165;
  float _1187 = ((_1115 + _1088) - (floor(_1166 * 0.0034602077212184668f) * 289.0f)) + _1166;
  float _1190 = ((_1115 + 1.0f) - (floor(_1167 * 0.0034602077212184668f) * 289.0f)) + _1167;
  float _1199 = ((_1181 * 34.0f) + 1.0f) * _1181;
  float _1200 = ((_1184 * 34.0f) + 1.0f) * _1184;
  float _1201 = ((_1187 * 34.0f) + 1.0f) * _1187;
  float _1202 = ((_1190 * 34.0f) + 1.0f) * _1190;
  float _1215 = _1199 - (floor(_1199 * 0.0034602077212184668f) * 289.0f);
  float _1216 = _1200 - (floor(_1200 * 0.0034602077212184668f) * 289.0f);
  float _1217 = _1201 - (floor(_1201 * 0.0034602077212184668f) * 289.0f);
  float _1218 = _1202 - (floor(_1202 * 0.0034602077212184668f) * 289.0f);
  float _1231 = _1215 - (floor(_1215 * 0.020408164709806442f) * 49.0f);
  float _1232 = _1216 - (floor(_1216 * 0.020408164709806442f) * 49.0f);
  float _1233 = _1217 - (floor(_1217 * 0.020408164709806442f) * 49.0f);
  float _1234 = _1218 - (floor(_1218 * 0.020408164709806442f) * 49.0f);
  float _1239 = floor(_1231 * 0.1428571492433548f);
  float _1240 = floor(_1232 * 0.1428571492433548f);
  float _1241 = floor(_1233 * 0.1428571492433548f);
  float _1242 = floor(_1234 * 0.1428571492433548f);
  float _1259 = (_1239 * 0.2857142984867096f) + -0.9285714030265808f;
  float _1260 = (_1240 * 0.2857142984867096f) + -0.9285714030265808f;
  float _1261 = (_1241 * 0.2857142984867096f) + -0.9285714030265808f;
  float _1262 = (_1242 * 0.2857142984867096f) + -0.9285714030265808f;
  float _1267 = (floor(_1231 - (_1239 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _1268 = (floor(_1232 - (_1240 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _1269 = (floor(_1233 - (_1241 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _1270 = (floor(_1234 - (_1242 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _1283 = (1.0f - abs(_1259)) - abs(_1267);
  float _1284 = (1.0f - abs(_1260)) - abs(_1268);
  float _1285 = (1.0f - abs(_1261)) - abs(_1269);
  float _1286 = (1.0f - abs(_1262)) - abs(_1270);
  float _1315 = select((_1283 > 0.0f), -0.0f, -1.0f);
  float _1316 = select((_1284 > 0.0f), -0.0f, -1.0f);
  float _1317 = select((_1285 > 0.0f), -0.0f, -1.0f);
  float _1318 = select((_1286 > 0.0f), -0.0f, -1.0f);
  float _1323 = (((floor(_1259) * 2.0f) + 1.0f) * _1315) + _1259;
  float _1324 = (((floor(_1267) * 2.0f) + 1.0f) * _1315) + _1267;
  float _1325 = (((floor(_1260) * 2.0f) + 1.0f) * _1316) + _1260;
  float _1326 = (((floor(_1268) * 2.0f) + 1.0f) * _1316) + _1268;
  float _1331 = (((floor(_1261) * 2.0f) + 1.0f) * _1317) + _1261;
  float _1332 = (((floor(_1269) * 2.0f) + 1.0f) * _1317) + _1269;
  float _1333 = (((floor(_1262) * 2.0f) + 1.0f) * _1318) + _1262;
  float _1334 = (((floor(_1270) * 2.0f) + 1.0f) * _1318) + _1270;
  float _1343 = 1.7928400039672852f - (dot(float3(_1323, _1324, _1283), float3(_1323, _1324, _1283)) * 0.8537350296974182f);
  float _1344 = 1.7928400039672852f - (dot(float3(_1325, _1326, _1284), float3(_1325, _1326, _1284)) * 0.8537350296974182f);
  float _1345 = 1.7928400039672852f - (dot(float3(_1331, _1332, _1285), float3(_1331, _1332, _1285)) * 0.8537350296974182f);
  float _1346 = 1.7928400039672852f - (dot(float3(_1333, _1334, _1286), float3(_1333, _1334, _1286)) * 0.8537350296974182f);
  float _1367 = max((0.6000000238418579f - dot(float3(_1073, _1074, _1075), float3(_1073, _1074, _1075))), 0.0f);
  float _1368 = max((0.6000000238418579f - dot(float3(_1094, _1095, _1096), float3(_1094, _1095, _1096))), 0.0f);
  float _1369 = max((0.6000000238418579f - dot(float3(_1100, _1101, _1102), float3(_1100, _1101, _1102))), 0.0f);
  float _1370 = max((0.6000000238418579f - dot(float3(_1103, _1104, _1105), float3(_1103, _1104, _1105))), 0.0f);
  float _1371 = _1367 * _1367;
  float _1372 = _1368 * _1368;
  float _1373 = _1369 * _1369;
  float _1374 = _1370 * _1370;
  float _1389 = saturate((((sin(_368 - (frame_consts.time * 1.5f)) * 0.15000000596046448f) + 0.050000011920928955f) + (dot(float4((_1371 * _1371), (_1372 * _1372), (_1373 * _1373), (_1374 * _1374)), float4(dot(float3((_1343 * _1323), (_1343 * _1324), (_1343 * _1283)), float3(_1073, _1074, _1075)), dot(float3((_1344 * _1325), (_1344 * _1326), (_1344 * _1284)), float3(_1094, _1095, _1096)), dot(float3((_1345 * _1331), (_1345 * _1332), (_1345 * _1285)), float3(_1100, _1101, _1102)), dot(float3((_1346 * _1333), (_1346 * _1334), (_1346 * _1286)), float3(_1103, _1104, _1105)))) * 21.0f)) * 4.0f);
  float _1393 = (_1389 * _1389) * (3.0f - (_1389 * 2.0f));
  float _1395 = (_1393 * 0.6499999761581421f) + 0.3499999940395355f;
  float _1417 = saturate(_711);
  float _1418 = saturate(_1051);
  float _1440 = (((_255 * 1.2000000476837158f) * _260) * frame_consts.params.vignette.golden_intensity) * ((((saturate(11.0f - (sqrt((_352 * _352) + (_351 * _351)) / ((_1049 * 0.039000000804662704f) + 0.08100000768899918f))) * _1051) + (saturate(11.0f - (sqrt((_347 * _347) + _357) / ((_709 * 0.039000000804662704f) + 0.08100000768899918f))) * _711)) + (saturate(11.0f - (sqrt((_364 * _364) + _357) / ((_1393 * 0.039000000804662704f) + 0.08100000768899918f))) * _1395)) + (((((saturate(1.0f - (abs(_348) * 0.8333333134651184f)) * _1417) + (saturate(1.0f - (abs(dot(float2(_351, _352), float2(-0.8660253882408142f, 0.5f))) * 0.8333333134651184f)) * _1418)) * saturate(_1395)) + ((_1417 * saturate(1.0f - (abs(dot(float2(_347, _348), float2(0.8660253882408142f, 0.5f))) * 0.8333333134651184f))) * _1418)) * 0.5f));
  SV_Target.x = ((_1440 * ((_307 * _307) - _269)) + _269);
  SV_Target.y = ((_1440 * ((_308 * _308) - _270)) + _270);
  SV_Target.z = ((_1440 * ((_309 * _309) - _271)) + _271);
  if (RENODX_TONE_MAP_TYPE) {
    SV_Target.rgb = renodx::draw::ToneMapPass(_17.rgb, SV_Target.rgb);
  } else {
    SV_Target.rgb = saturate(SV_Target.rgb);
  }
  SV_Target.rgb = renodx::draw::RenderIntermediatePass(SV_Target.rgb);

  SV_Target.w = 1.0f;
  return SV_Target;
}
