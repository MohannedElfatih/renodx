#include "../shared.h"

struct Lod_params {
  struct Lod_brush_params {
    float4 brush_uv[4];
    float base_radius;
    float radius_variation;
    float radius_random;
    float blur;
    float alpha;
    float stretch;
  } brushes;
  struct Lod_noise_params {
    float chaos;
    float freq;
    float brightness;
    float saturation;
    float hue;
  } noise;
  struct Lod_outlines_params {
    float2 thickness;
    float2 softness;
    float2 displacement;
    float2 attenuation;
    float lighting_threshold;
    float lighting_threshold_softness;
    float2 lighting_dark;
    float2 lighting_bright;
    float2 discretion;
    float2 alpha;
  } outlines;
};

struct Frame_constants {
  float3 cam_world_pos;
  float time;
  float2 inv_near_dim;
  float proj_scale;
  uint flags;
  float2 half_vp_dim;
  int2 vp_dim;
  float2 vp_texel_size;
  int2 mouse_pos;
  int2 inspected_pix;
  int2 hi_z_0_dim;
  int supersampling;
  int debug_patches;
  int use_patches;
  int emissive;
  float3 target;
  uint frame_number;
  uint shot_frame_number;
  float dt;
  float4 view_to_world[4];
  float4 world_to_view[4];
  float4 view_ndc[4];
  float4 world_ndc[4];
  float4 prev_world_ndc[4];
  float4 ndc_world[4];
  float4 ndc_to_prev_ndc[4];
  float4 prev_ndc_to_ndc[4];
  float4 view_world_z0;
  float4 pix_to_fog_eq;
  float3 mio_view;
  float3 mio_hair_outline_color;
  float mio_foliage_velocity;
  int show_wireframe;
  int ao;
  int glitch;
  int no_vertex_color;
  float paper_mult;
  int hatching;
  int mio_halo;
  int vol_temporal;
  int heart_attack_active;
  int heart_attack_secondary_target;
  int triangular_dissolve_enabled;
  int color_correct;
  float starfield_effect_amount;
  float starfield_fade_amount;
  float3 starfield_center_view;
  float starfield_glow_amount;
  float starfield_pulse_t;
  float death_anim_t;
  float3 game_plane_world_origin;
  float3 game_plane_world_normal;
  float3 game_plane_world_u;
  float3 game_plane_world_v;
  float4 game_plane_transform[4];
  float4 hatching_xf[4];
  float4 paper_xf[4];
  float2 game_plane_blend;
  float heart_attack_t;
  float heart_attack_duration;
  float heart_attack_pulse;
  float heart_attack_outline_distance;
  float heart_attack_dissolve_distance;
  float3 heart_attack_dissolve_color;
  float heart_attack_dissolve_base;
  float heart_attack_dissolve_mult;
  float3 heart_attack_dissolve_world_center;
  float heart_attack_vertical_dissolve;
  float triangular_dissolve_base_amount;
  float triangular_dissolve_amount;
  float flashback_lut;
  float evil_mio;
  float dead_mio;
  float godlike_mio;
  float khlia_pulse_t;
  float khlia__pulse_t;
  float khlia_pulse_period;
  float3 khlia_world_pos;
  float skydome_rotation_offset;
  float hatch_ambiant_mul;
  float hatch_ambiant_add;
  float glitch_scale;
  uint max_contours;
  uint max_contour_loops;
  int death_screen;
  float death_screen_t;
  int poetic_death_screen;
  float poetic_death_screen_t;
  float tremor_pulse_t;
  int invert;
  float surface_fade;
  struct Postprocess_params {
    struct AO_params {
      float3 color;
      float intensity;
    } ao;
    struct Fog_params {
      float bloom_factor;
      float space;
      float outline_density;
      float outline_attenuation;
    } fog;
    struct Ambient_light_params {
      int undercoat_grad;
      float3 color;
      float intensity;
      float gameplay_intensity;
      float gameplay_width;
      float directional_intensity;
      float directional_shadows;
      float undercoat_noise_freq;
      float undercoat_noise_amplitude;
      float undercoat_noise_threshold;
      float undercoating;
    } ambient_light;
    struct Vignette_params {
      float intensity;
      float rounded;
      float3 color;
      float golden_intensity;
      float golden_color;
    } vignette;
    struct Bloom_params {
      float intensity;
      float threshold_low;
      float threshold_high;
    } bloom;
    struct Mio_params {
      float light_intensity;
      float light_radius;
      float3 light_color;
      float spec_intensity;
      float3 halo_color;
      float halo_intensity;
    } mio;
    struct Particles_params {
      uint count;
      float cam_near;
      float cam_far;
      float fadeoff_near;
      float2 lifetime;
      float fadein_duration;
      float fadeoff_duration;
      float2 alpha;
      float2 scale;
      float2 speed;
      int gradient;
      float circle_attenuation;
    } particles;
    struct Chroma_aberration_params {
      float intensity;
    } chroma_aberration;
    struct Fade_params {
      float intensity;
      float3 color;
    } fade;
    struct Dof_params {
      float plane_01;
      float plane_01_softness;
      float plane_12;
      float plane_12_softness;
      float foreground;
      float foreground_softness;
    } dof;
    Lod_params lod_foreground;
    Lod_params lod_game;
    Lod_params lod_midground;
    Lod_params lod_background;
  } params;
};


Texture2D<float4> tex : register(t0);

Texture2D<float> depth_tex : register(t1);

Texture2D<float2> distortion : register(t4);

Texture2D<float> paper_tex : register(t5);

cbuffer frame_consts : register(b0) {
  Frame_constants frame_consts : packoffset(c000.x);
};

SamplerState sampler_nearest : register(s0);

SamplerState sampler_bilinear_wrap : register(s1);

float4 main(
  noperspective float4 SV_Position : SV_Position,
  linear float2 O_Uv : O_Uv
) : SV_Target {
  float4 SV_Target;
  float _13 = float((int)(frame_consts.vp_dim.x));
  float _14 = float((int)(frame_consts.vp_dim.y));
  float2 _15 = distortion.SampleLevel(sampler_nearest, float2(O_Uv.x, O_Uv.y), 0.0f);
  float _18 = _14 / _13;
  float _23 = saturate((_15.x * _18) + O_Uv.x);
  float _24 = saturate((_15.y * _18) + O_Uv.y);
  float4 _25 = tex.SampleLevel(sampler_nearest, float2(_23, _24), 0.0f);
  float _34 = depth_tex.SampleLevel(sampler_nearest, float2(_23, _24), 0.0f);
  float _38 = 10000.0f / ((_34.x * 19999.5f) + 0.5f);
  float _43 = (_38 * ((_23 * 2.0f) + -1.0f)) * frame_consts.inv_near_dim.x;
  float _45 = (_38 * (((1.0f - _24) * 2.0f) + -1.0f)) * frame_consts.inv_near_dim.y;
  float _46 = -0.0f - _38;
  float _70 = mad((frame_consts.paper_xf[2].z), _46, mad((frame_consts.paper_xf[1].z), _45, (_43 * (frame_consts.paper_xf[0].z))));
  float _71 = mad((frame_consts.paper_xf[2].x), _46, mad((frame_consts.paper_xf[1].x), _45, (_43 * (frame_consts.paper_xf[0].x)))) / _70;
  float _72 = mad((frame_consts.paper_xf[2].y), _46, mad((frame_consts.paper_xf[1].y), _45, (_43 * (frame_consts.paper_xf[0].y)))) / _70;
  float _79 = log2(max(5.0f, (-0.0f - (_70 - frame_consts.game_plane_blend.x)))) * 10.0f;
  float _80 = floor(_79);
  float _81 = _79 - _80;
  float _83 = exp2(_80 * 0.10000000149011612f);
  float _84 = 1.0f / _83;
  float _85 = min(_84, 0.20000000298023224f);
  float _87 = min((_84 * 0.9330329895019531f), 0.20000000298023224f);
  float _88 = frame_consts.game_plane_blend.x - _83;
  float _94 = frame_consts.game_plane_blend.x - (_83 * 1.0717734098434448f);
  float _104 = paper_tex.SampleLevel(sampler_bilinear_wrap, float2((((_88 * _71) + (frame_consts.paper_xf[3].x)) * _85), (((_88 * _72) + (frame_consts.paper_xf[3].y)) * _85)), 0.0f);
  float _107 = paper_tex.SampleLevel(sampler_bilinear_wrap, float2((((_94 * _71) + (frame_consts.paper_xf[3].x)) * _87), (((_94 * _72) + (frame_consts.paper_xf[3].y)) * _87)), 0.0f);
  float _114 = ((1.0f - (_104.x * (1.0f - _81))) - (_107.x * _81)) * frame_consts.paper_mult;
  float _129 = _13 / _14;
  float _141 = exp2(log2(saturate((frame_consts.params.vignette.intensity * abs(_23 + -0.5f)) * (((_129 + -1.0f) * frame_consts.params.vignette.rounded) + 1.0f))) * 5.0f);
  float _142 = exp2(log2(saturate(frame_consts.params.vignette.intensity * abs(_24 + -0.5f))) * 5.0f);
  float _148 = exp2(log2(saturate(1.0f - dot(float2(_141, _142), float2(_141, _142)))) * 6.0f);
  float _153 = 1.0f - _148;
  float _155 = 1.0f - (_153 * 0.8500000238418579f);
  float _162 = (_155 * ((_25.x - (_114 * _25.x)) - frame_consts.params.vignette.color.x)) + frame_consts.params.vignette.color.x;
  float _163 = (_155 * ((_25.y - (_114 * _25.y)) - frame_consts.params.vignette.color.y)) + frame_consts.params.vignette.color.y;
  float _164 = (_155 * ((_25.z - (_114 * _25.z)) - frame_consts.params.vignette.color.z)) + frame_consts.params.vignette.color.z;
  float _168 = _23 * _13;
  float _169 = _24 * _14;
  float _170 = _169 + _168;
  float _176 = frac(_170 * 0.0033333334140479565f) + -0.5f;
  float _177 = frac((_169 - _168) * 0.0033333334140479565f) + -0.5f;
  float _183 = saturate(sqrt((_177 * _177) + (_176 * _176)) * 2.0f);
  float _194 = saturate((sin((_170 * 0.01666666753590107f) - (frame_consts.time * 0.8500000238418579f)) * 1.2500001192092896f) + -0.25000008940696716f);
  float _199 = ((_194 * _194) * 0.2199999988079071f) * (3.0f - (_194 * 2.0f));
  float _200 = _199 + 0.9777389168739319f;
  float _201 = ((_183 * 0.13274884223937988f) + 0.7175776362419128f) + _199;
  float _202 = ((_183 * 0.3335757553577423f) + 0.30871906876564026f) + _199;
  float _207 = (_23 * 1080.0f) * _129;
  float _208 = _24 * 1080.0f;
  float _209 = _207 * 0.04444444552063942f;
  float _210 = _24 * 27.712812423706055f;
  float _212 = ceil(_209 - _210);
  float _215 = floor(_24 * 55.42562484741211f) + 1.0f;
  float _218 = ceil((-0.0f - _210) - _209);
  float _220 = (_215 + _212) + _218;
  float _222 = (_220 * 22.5f) + -33.75f;
  float _223 = _212 - _218;
  float _225 = _223 * 11.25f;
  float _231 = (((_215 * 0.5773502588272095f) - (_212 * 0.28867512941360474f)) - (_218 * 0.28867512941360474f)) * 22.5f;
  float _234 = _222 + _225;
  float _235 = _231 + (19.485570907592773f - (_220 * 12.990381240844727f));
  float _238 = ((_220 * 25.980762481689453f) + -38.97114181518555f) + _231;
  float _239 = _225 - _222;
  float _240 = _234 - _207;
  float _241 = _235 - _208;
  float _244 = _225 - _207;
  float _245 = _238 - _208;
  float _250 = _241 * _241;
  float _257 = _239 - _207;
  float _261 = _235 * 2.5f;
  float _262 = frame_consts.time * 1.5f;
  float _266 = _235 * 0.004444444552063942f;
  float _267 = frame_consts.time * 0.15000000596046448f;
  float _268 = (_234 * 0.04444444552063942f) - _267;
  float _269 = _266 - _267;
  float _270 = frame_consts.time * 0.02500000037252903f;
  float _271 = dot(float3(_268, _269, _270), float3(0.3333333432674408f, 0.3333333432674408f, 0.3333333432674408f));
  float _275 = floor(_271 + _268);
  float _276 = floor(_271 + _269);
  float _277 = floor(_271 + _270);
  float _281 = dot(float3(_275, _276, _277), float3(0.1666666716337204f, 0.1666666716337204f, 0.1666666716337204f));
  float _282 = _281 + (_268 - _275);
  float _283 = _281 + (_269 - _276);
  float _284 = (_270 - _277) + _281;
  float _288 = select((_282 < _283), 0.0f, 1.0f);
  float _289 = select((_283 < _284), 0.0f, 1.0f);
  float _290 = select((_284 < _282), 0.0f, 1.0f);
  float _291 = 1.0f - _288;
  float _292 = 1.0f - _289;
  float _293 = 1.0f - _290;
  float _294 = min(_288, _293);
  float _295 = min(_289, _291);
  float _296 = min(_290, _292);
  float _297 = max(_288, _293);
  float _298 = max(_289, _291);
  float _299 = max(_290, _292);
  float _303 = (_282 - _294) + 0.1666666716337204f;
  float _304 = (_283 - _295) + 0.1666666716337204f;
  float _305 = (_284 - _296) + 0.1666666716337204f;
  float _309 = (_282 - _297) + 0.3333333432674408f;
  float _310 = (_283 - _298) + 0.3333333432674408f;
  float _311 = (_284 - _299) + 0.3333333432674408f;
  float _312 = _282 + -0.5f;
  float _313 = _283 + -0.5f;
  float _314 = _284 + -0.5f;
  float _324 = _275 - (floor(_275 * 0.0034602077212184668f) * 289.0f);
  float _325 = _276 - (floor(_276 * 0.0034602077212184668f) * 289.0f);
  float _326 = _277 - (floor(_277 * 0.0034602077212184668f) * 289.0f);
  float _327 = _326 + _296;
  float _328 = _326 + _299;
  float _329 = _326 + 1.0f;
  float _338 = ((_326 * 34.0f) + 1.0f) * _326;
  float _339 = ((_327 * 34.0f) + 1.0f) * _327;
  float _340 = ((_328 * 34.0f) + 1.0f) * _328;
  float _341 = ((_329 * 34.0f) + 1.0f) * _329;
  float _355 = (_338 - (floor(_338 * 0.0034602077212184668f) * 289.0f)) + _325;
  float _358 = ((_325 + _295) - (floor(_339 * 0.0034602077212184668f) * 289.0f)) + _339;
  float _361 = ((_325 + _298) - (floor(_340 * 0.0034602077212184668f) * 289.0f)) + _340;
  float _364 = ((_325 + 1.0f) - (floor(_341 * 0.0034602077212184668f) * 289.0f)) + _341;
  float _373 = ((_355 * 34.0f) + 1.0f) * _355;
  float _374 = ((_358 * 34.0f) + 1.0f) * _358;
  float _375 = ((_361 * 34.0f) + 1.0f) * _361;
  float _376 = ((_364 * 34.0f) + 1.0f) * _364;
  float _390 = (_373 - (floor(_373 * 0.0034602077212184668f) * 289.0f)) + _324;
  float _393 = ((_324 + _294) - (floor(_374 * 0.0034602077212184668f) * 289.0f)) + _374;
  float _396 = ((_324 + _297) - (floor(_375 * 0.0034602077212184668f) * 289.0f)) + _375;
  float _399 = ((_324 + 1.0f) - (floor(_376 * 0.0034602077212184668f) * 289.0f)) + _376;
  float _408 = ((_390 * 34.0f) + 1.0f) * _390;
  float _409 = ((_393 * 34.0f) + 1.0f) * _393;
  float _410 = ((_396 * 34.0f) + 1.0f) * _396;
  float _411 = ((_399 * 34.0f) + 1.0f) * _399;
  float _424 = _408 - (floor(_408 * 0.0034602077212184668f) * 289.0f);
  float _425 = _409 - (floor(_409 * 0.0034602077212184668f) * 289.0f);
  float _426 = _410 - (floor(_410 * 0.0034602077212184668f) * 289.0f);
  float _427 = _411 - (floor(_411 * 0.0034602077212184668f) * 289.0f);
  float _440 = _424 - (floor(_424 * 0.020408164709806442f) * 49.0f);
  float _441 = _425 - (floor(_425 * 0.020408164709806442f) * 49.0f);
  float _442 = _426 - (floor(_426 * 0.020408164709806442f) * 49.0f);
  float _443 = _427 - (floor(_427 * 0.020408164709806442f) * 49.0f);
  float _448 = floor(_440 * 0.1428571492433548f);
  float _449 = floor(_441 * 0.1428571492433548f);
  float _450 = floor(_442 * 0.1428571492433548f);
  float _451 = floor(_443 * 0.1428571492433548f);
  float _468 = (_448 * 0.2857142984867096f) + -0.9285714030265808f;
  float _469 = (_449 * 0.2857142984867096f) + -0.9285714030265808f;
  float _470 = (_450 * 0.2857142984867096f) + -0.9285714030265808f;
  float _471 = (_451 * 0.2857142984867096f) + -0.9285714030265808f;
  float _476 = (floor(_440 - (_448 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _477 = (floor(_441 - (_449 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _478 = (floor(_442 - (_450 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _479 = (floor(_443 - (_451 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _492 = (1.0f - abs(_468)) - abs(_476);
  float _493 = (1.0f - abs(_469)) - abs(_477);
  float _494 = (1.0f - abs(_470)) - abs(_478);
  float _495 = (1.0f - abs(_471)) - abs(_479);
  float _524 = select((_492 > 0.0f), -0.0f, -1.0f);
  float _525 = select((_493 > 0.0f), -0.0f, -1.0f);
  float _526 = select((_494 > 0.0f), -0.0f, -1.0f);
  float _527 = select((_495 > 0.0f), -0.0f, -1.0f);
  float _532 = (((floor(_468) * 2.0f) + 1.0f) * _524) + _468;
  float _533 = (((floor(_476) * 2.0f) + 1.0f) * _524) + _476;
  float _534 = (((floor(_469) * 2.0f) + 1.0f) * _525) + _469;
  float _535 = (((floor(_477) * 2.0f) + 1.0f) * _525) + _477;
  float _540 = (((floor(_470) * 2.0f) + 1.0f) * _526) + _470;
  float _541 = (((floor(_478) * 2.0f) + 1.0f) * _526) + _478;
  float _542 = (((floor(_471) * 2.0f) + 1.0f) * _527) + _471;
  float _543 = (((floor(_479) * 2.0f) + 1.0f) * _527) + _479;
  float _552 = 1.7928400039672852f - (dot(float3(_532, _533, _492), float3(_532, _533, _492)) * 0.8537350296974182f);
  float _553 = 1.7928400039672852f - (dot(float3(_534, _535, _493), float3(_534, _535, _493)) * 0.8537350296974182f);
  float _554 = 1.7928400039672852f - (dot(float3(_540, _541, _494), float3(_540, _541, _494)) * 0.8537350296974182f);
  float _555 = 1.7928400039672852f - (dot(float3(_542, _543, _495), float3(_542, _543, _495)) * 0.8537350296974182f);
  float _576 = max((0.6000000238418579f - dot(float3(_282, _283, _284), float3(_282, _283, _284))), 0.0f);
  float _577 = max((0.6000000238418579f - dot(float3(_303, _304, _305), float3(_303, _304, _305))), 0.0f);
  float _578 = max((0.6000000238418579f - dot(float3(_309, _310, _311), float3(_309, _310, _311))), 0.0f);
  float _579 = max((0.6000000238418579f - dot(float3(_312, _313, _314), float3(_312, _313, _314))), 0.0f);
  float _580 = _576 * _576;
  float _581 = _577 * _577;
  float _582 = _578 * _578;
  float _583 = _579 * _579;
  float _598 = saturate((((sin(_261 - _262) * 0.15000000596046448f) + 0.050000011920928955f) + (dot(float4((_580 * _580), (_581 * _581), (_582 * _582), (_583 * _583)), float4(dot(float3((_552 * _532), (_552 * _533), (_552 * _492)), float3(_282, _283, _284)), dot(float3((_553 * _534), (_553 * _535), (_553 * _493)), float3(_303, _304, _305)), dot(float3((_554 * _540), (_554 * _541), (_554 * _494)), float3(_309, _310, _311)), dot(float3((_555 * _542), (_555 * _543), (_555 * _495)), float3(_312, _313, _314)))) * 21.0f)) * 4.0f);
  float _602 = (_598 * _598) * (3.0f - (_598 * 2.0f));
  float _604 = (_602 * 0.6499999761581421f) + 0.3499999940395355f;
  float _609 = (_223 * 0.5f) - _267;
  float _610 = (_238 * 0.004444444552063942f) - _267;
  float _611 = dot(float3(_609, _610, _270), float3(0.3333333432674408f, 0.3333333432674408f, 0.3333333432674408f));
  float _615 = floor(_611 + _609);
  float _616 = floor(_611 + _610);
  float _617 = floor(_611 + _270);
  float _621 = dot(float3(_615, _616, _617), float3(0.1666666716337204f, 0.1666666716337204f, 0.1666666716337204f));
  float _622 = _621 + (_609 - _615);
  float _623 = _621 + (_610 - _616);
  float _624 = (_270 - _617) + _621;
  float _628 = select((_622 < _623), 0.0f, 1.0f);
  float _629 = select((_623 < _624), 0.0f, 1.0f);
  float _630 = select((_624 < _622), 0.0f, 1.0f);
  float _631 = 1.0f - _628;
  float _632 = 1.0f - _629;
  float _633 = 1.0f - _630;
  float _634 = min(_628, _633);
  float _635 = min(_629, _631);
  float _636 = min(_630, _632);
  float _637 = max(_628, _633);
  float _638 = max(_629, _631);
  float _639 = max(_630, _632);
  float _643 = (_622 - _634) + 0.1666666716337204f;
  float _644 = (_623 - _635) + 0.1666666716337204f;
  float _645 = (_624 - _636) + 0.1666666716337204f;
  float _649 = (_622 - _637) + 0.3333333432674408f;
  float _650 = (_623 - _638) + 0.3333333432674408f;
  float _651 = (_624 - _639) + 0.3333333432674408f;
  float _652 = _622 + -0.5f;
  float _653 = _623 + -0.5f;
  float _654 = _624 + -0.5f;
  float _664 = _615 - (floor(_615 * 0.0034602077212184668f) * 289.0f);
  float _665 = _616 - (floor(_616 * 0.0034602077212184668f) * 289.0f);
  float _666 = _617 - (floor(_617 * 0.0034602077212184668f) * 289.0f);
  float _667 = _666 + _636;
  float _668 = _666 + _639;
  float _669 = _666 + 1.0f;
  float _678 = ((_666 * 34.0f) + 1.0f) * _666;
  float _679 = ((_667 * 34.0f) + 1.0f) * _667;
  float _680 = ((_668 * 34.0f) + 1.0f) * _668;
  float _681 = ((_669 * 34.0f) + 1.0f) * _669;
  float _695 = (_678 - (floor(_678 * 0.0034602077212184668f) * 289.0f)) + _665;
  float _698 = ((_665 + _635) - (floor(_679 * 0.0034602077212184668f) * 289.0f)) + _679;
  float _701 = ((_665 + _638) - (floor(_680 * 0.0034602077212184668f) * 289.0f)) + _680;
  float _704 = ((_665 + 1.0f) - (floor(_681 * 0.0034602077212184668f) * 289.0f)) + _681;
  float _713 = ((_695 * 34.0f) + 1.0f) * _695;
  float _714 = ((_698 * 34.0f) + 1.0f) * _698;
  float _715 = ((_701 * 34.0f) + 1.0f) * _701;
  float _716 = ((_704 * 34.0f) + 1.0f) * _704;
  float _730 = (_713 - (floor(_713 * 0.0034602077212184668f) * 289.0f)) + _664;
  float _733 = ((_664 + _634) - (floor(_714 * 0.0034602077212184668f) * 289.0f)) + _714;
  float _736 = ((_664 + _637) - (floor(_715 * 0.0034602077212184668f) * 289.0f)) + _715;
  float _739 = ((_664 + 1.0f) - (floor(_716 * 0.0034602077212184668f) * 289.0f)) + _716;
  float _748 = ((_730 * 34.0f) + 1.0f) * _730;
  float _749 = ((_733 * 34.0f) + 1.0f) * _733;
  float _750 = ((_736 * 34.0f) + 1.0f) * _736;
  float _751 = ((_739 * 34.0f) + 1.0f) * _739;
  float _764 = _748 - (floor(_748 * 0.0034602077212184668f) * 289.0f);
  float _765 = _749 - (floor(_749 * 0.0034602077212184668f) * 289.0f);
  float _766 = _750 - (floor(_750 * 0.0034602077212184668f) * 289.0f);
  float _767 = _751 - (floor(_751 * 0.0034602077212184668f) * 289.0f);
  float _780 = _764 - (floor(_764 * 0.020408164709806442f) * 49.0f);
  float _781 = _765 - (floor(_765 * 0.020408164709806442f) * 49.0f);
  float _782 = _766 - (floor(_766 * 0.020408164709806442f) * 49.0f);
  float _783 = _767 - (floor(_767 * 0.020408164709806442f) * 49.0f);
  float _788 = floor(_780 * 0.1428571492433548f);
  float _789 = floor(_781 * 0.1428571492433548f);
  float _790 = floor(_782 * 0.1428571492433548f);
  float _791 = floor(_783 * 0.1428571492433548f);
  float _808 = (_788 * 0.2857142984867096f) + -0.9285714030265808f;
  float _809 = (_789 * 0.2857142984867096f) + -0.9285714030265808f;
  float _810 = (_790 * 0.2857142984867096f) + -0.9285714030265808f;
  float _811 = (_791 * 0.2857142984867096f) + -0.9285714030265808f;
  float _816 = (floor(_780 - (_788 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _817 = (floor(_781 - (_789 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _818 = (floor(_782 - (_790 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _819 = (floor(_783 - (_791 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _832 = (1.0f - abs(_808)) - abs(_816);
  float _833 = (1.0f - abs(_809)) - abs(_817);
  float _834 = (1.0f - abs(_810)) - abs(_818);
  float _835 = (1.0f - abs(_811)) - abs(_819);
  float _864 = select((_832 > 0.0f), -0.0f, -1.0f);
  float _865 = select((_833 > 0.0f), -0.0f, -1.0f);
  float _866 = select((_834 > 0.0f), -0.0f, -1.0f);
  float _867 = select((_835 > 0.0f), -0.0f, -1.0f);
  float _872 = (((floor(_808) * 2.0f) + 1.0f) * _864) + _808;
  float _873 = (((floor(_816) * 2.0f) + 1.0f) * _864) + _816;
  float _874 = (((floor(_809) * 2.0f) + 1.0f) * _865) + _809;
  float _875 = (((floor(_817) * 2.0f) + 1.0f) * _865) + _817;
  float _880 = (((floor(_810) * 2.0f) + 1.0f) * _866) + _810;
  float _881 = (((floor(_818) * 2.0f) + 1.0f) * _866) + _818;
  float _882 = (((floor(_811) * 2.0f) + 1.0f) * _867) + _811;
  float _883 = (((floor(_819) * 2.0f) + 1.0f) * _867) + _819;
  float _892 = 1.7928400039672852f - (dot(float3(_872, _873, _832), float3(_872, _873, _832)) * 0.8537350296974182f);
  float _893 = 1.7928400039672852f - (dot(float3(_874, _875, _833), float3(_874, _875, _833)) * 0.8537350296974182f);
  float _894 = 1.7928400039672852f - (dot(float3(_880, _881, _834), float3(_880, _881, _834)) * 0.8537350296974182f);
  float _895 = 1.7928400039672852f - (dot(float3(_882, _883, _835), float3(_882, _883, _835)) * 0.8537350296974182f);
  float _916 = max((0.6000000238418579f - dot(float3(_622, _623, _624), float3(_622, _623, _624))), 0.0f);
  float _917 = max((0.6000000238418579f - dot(float3(_643, _644, _645), float3(_643, _644, _645))), 0.0f);
  float _918 = max((0.6000000238418579f - dot(float3(_649, _650, _651), float3(_649, _650, _651))), 0.0f);
  float _919 = max((0.6000000238418579f - dot(float3(_652, _653, _654), float3(_652, _653, _654))), 0.0f);
  float _920 = _916 * _916;
  float _921 = _917 * _917;
  float _922 = _918 * _918;
  float _923 = _919 * _919;
  float _938 = saturate((((sin((_238 * 2.5f) - _262) * 0.15000000596046448f) + 0.050000011920928955f) + (dot(float4((_920 * _920), (_921 * _921), (_922 * _922), (_923 * _923)), float4(dot(float3((_892 * _872), (_892 * _873), (_892 * _832)), float3(_622, _623, _624)), dot(float3((_893 * _874), (_893 * _875), (_893 * _833)), float3(_643, _644, _645)), dot(float3((_894 * _880), (_894 * _881), (_894 * _834)), float3(_649, _650, _651)), dot(float3((_895 * _882), (_895 * _883), (_895 * _835)), float3(_652, _653, _654)))) * 21.0f)) * 4.0f);
  float _942 = (_938 * _938) * (3.0f - (_938 * 2.0f));
  float _944 = (_942 * 0.6499999761581421f) + 0.3499999940395355f;
  float _951 = frame_consts.time * 0.15000000596046448f;
  float _952 = (_239 * 0.04444444552063942f) - _951;
  float _953 = _266 - _951;
  float _954 = frame_consts.time * 0.02500000037252903f;
  float _955 = dot(float3(_952, _953, _954), float3(0.3333333432674408f, 0.3333333432674408f, 0.3333333432674408f));
  float _959 = floor(_952 + _955);
  float _960 = floor(_953 + _955);
  float _961 = floor(_954 + _955);
  float _965 = dot(float3(_959, _960, _961), float3(0.1666666716337204f, 0.1666666716337204f, 0.1666666716337204f));
  float _966 = _965 + (_952 - _959);
  float _967 = _965 + (_953 - _960);
  float _968 = (_954 - _961) + _965;
  float _972 = select((_966 < _967), 0.0f, 1.0f);
  float _973 = select((_967 < _968), 0.0f, 1.0f);
  float _974 = select((_968 < _966), 0.0f, 1.0f);
  float _975 = 1.0f - _972;
  float _976 = 1.0f - _973;
  float _977 = 1.0f - _974;
  float _978 = min(_972, _977);
  float _979 = min(_973, _975);
  float _980 = min(_974, _976);
  float _981 = max(_972, _977);
  float _982 = max(_973, _975);
  float _983 = max(_974, _976);
  float _987 = (_966 - _978) + 0.1666666716337204f;
  float _988 = (_967 - _979) + 0.1666666716337204f;
  float _989 = (_968 - _980) + 0.1666666716337204f;
  float _993 = (_966 - _981) + 0.3333333432674408f;
  float _994 = (_967 - _982) + 0.3333333432674408f;
  float _995 = (_968 - _983) + 0.3333333432674408f;
  float _996 = _966 + -0.5f;
  float _997 = _967 + -0.5f;
  float _998 = _968 + -0.5f;
  float _1008 = _959 - (floor(_959 * 0.0034602077212184668f) * 289.0f);
  float _1009 = _960 - (floor(_960 * 0.0034602077212184668f) * 289.0f);
  float _1010 = _961 - (floor(_961 * 0.0034602077212184668f) * 289.0f);
  float _1011 = _1010 + _980;
  float _1012 = _1010 + _983;
  float _1013 = _1010 + 1.0f;
  float _1022 = ((_1010 * 34.0f) + 1.0f) * _1010;
  float _1023 = ((_1011 * 34.0f) + 1.0f) * _1011;
  float _1024 = ((_1012 * 34.0f) + 1.0f) * _1012;
  float _1025 = ((_1013 * 34.0f) + 1.0f) * _1013;
  float _1039 = (_1022 - (floor(_1022 * 0.0034602077212184668f) * 289.0f)) + _1009;
  float _1042 = ((_1009 + _979) - (floor(_1023 * 0.0034602077212184668f) * 289.0f)) + _1023;
  float _1045 = ((_1009 + _982) - (floor(_1024 * 0.0034602077212184668f) * 289.0f)) + _1024;
  float _1048 = ((_1009 + 1.0f) - (floor(_1025 * 0.0034602077212184668f) * 289.0f)) + _1025;
  float _1057 = ((_1039 * 34.0f) + 1.0f) * _1039;
  float _1058 = ((_1042 * 34.0f) + 1.0f) * _1042;
  float _1059 = ((_1045 * 34.0f) + 1.0f) * _1045;
  float _1060 = ((_1048 * 34.0f) + 1.0f) * _1048;
  float _1074 = (_1057 - (floor(_1057 * 0.0034602077212184668f) * 289.0f)) + _1008;
  float _1077 = ((_1008 + _978) - (floor(_1058 * 0.0034602077212184668f) * 289.0f)) + _1058;
  float _1080 = ((_1008 + _981) - (floor(_1059 * 0.0034602077212184668f) * 289.0f)) + _1059;
  float _1083 = ((_1008 + 1.0f) - (floor(_1060 * 0.0034602077212184668f) * 289.0f)) + _1060;
  float _1092 = ((_1074 * 34.0f) + 1.0f) * _1074;
  float _1093 = ((_1077 * 34.0f) + 1.0f) * _1077;
  float _1094 = ((_1080 * 34.0f) + 1.0f) * _1080;
  float _1095 = ((_1083 * 34.0f) + 1.0f) * _1083;
  float _1108 = _1092 - (floor(_1092 * 0.0034602077212184668f) * 289.0f);
  float _1109 = _1093 - (floor(_1093 * 0.0034602077212184668f) * 289.0f);
  float _1110 = _1094 - (floor(_1094 * 0.0034602077212184668f) * 289.0f);
  float _1111 = _1095 - (floor(_1095 * 0.0034602077212184668f) * 289.0f);
  float _1124 = _1108 - (floor(_1108 * 0.020408164709806442f) * 49.0f);
  float _1125 = _1109 - (floor(_1109 * 0.020408164709806442f) * 49.0f);
  float _1126 = _1110 - (floor(_1110 * 0.020408164709806442f) * 49.0f);
  float _1127 = _1111 - (floor(_1111 * 0.020408164709806442f) * 49.0f);
  float _1132 = floor(_1124 * 0.1428571492433548f);
  float _1133 = floor(_1125 * 0.1428571492433548f);
  float _1134 = floor(_1126 * 0.1428571492433548f);
  float _1135 = floor(_1127 * 0.1428571492433548f);
  float _1152 = (_1132 * 0.2857142984867096f) + -0.9285714030265808f;
  float _1153 = (_1133 * 0.2857142984867096f) + -0.9285714030265808f;
  float _1154 = (_1134 * 0.2857142984867096f) + -0.9285714030265808f;
  float _1155 = (_1135 * 0.2857142984867096f) + -0.9285714030265808f;
  float _1160 = (floor(_1124 - (_1132 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _1161 = (floor(_1125 - (_1133 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _1162 = (floor(_1126 - (_1134 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _1163 = (floor(_1127 - (_1135 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _1176 = (1.0f - abs(_1152)) - abs(_1160);
  float _1177 = (1.0f - abs(_1153)) - abs(_1161);
  float _1178 = (1.0f - abs(_1154)) - abs(_1162);
  float _1179 = (1.0f - abs(_1155)) - abs(_1163);
  float _1208 = select((_1176 > 0.0f), -0.0f, -1.0f);
  float _1209 = select((_1177 > 0.0f), -0.0f, -1.0f);
  float _1210 = select((_1178 > 0.0f), -0.0f, -1.0f);
  float _1211 = select((_1179 > 0.0f), -0.0f, -1.0f);
  float _1216 = (((floor(_1152) * 2.0f) + 1.0f) * _1208) + _1152;
  float _1217 = (((floor(_1160) * 2.0f) + 1.0f) * _1208) + _1160;
  float _1218 = (((floor(_1153) * 2.0f) + 1.0f) * _1209) + _1153;
  float _1219 = (((floor(_1161) * 2.0f) + 1.0f) * _1209) + _1161;
  float _1224 = (((floor(_1154) * 2.0f) + 1.0f) * _1210) + _1154;
  float _1225 = (((floor(_1162) * 2.0f) + 1.0f) * _1210) + _1162;
  float _1226 = (((floor(_1155) * 2.0f) + 1.0f) * _1211) + _1155;
  float _1227 = (((floor(_1163) * 2.0f) + 1.0f) * _1211) + _1163;
  float _1236 = 1.7928400039672852f - (dot(float3(_1216, _1217, _1176), float3(_1216, _1217, _1176)) * 0.8537350296974182f);
  float _1237 = 1.7928400039672852f - (dot(float3(_1218, _1219, _1177), float3(_1218, _1219, _1177)) * 0.8537350296974182f);
  float _1238 = 1.7928400039672852f - (dot(float3(_1224, _1225, _1178), float3(_1224, _1225, _1178)) * 0.8537350296974182f);
  float _1239 = 1.7928400039672852f - (dot(float3(_1226, _1227, _1179), float3(_1226, _1227, _1179)) * 0.8537350296974182f);
  float _1260 = max((0.6000000238418579f - dot(float3(_966, _967, _968), float3(_966, _967, _968))), 0.0f);
  float _1261 = max((0.6000000238418579f - dot(float3(_987, _988, _989), float3(_987, _988, _989))), 0.0f);
  float _1262 = max((0.6000000238418579f - dot(float3(_993, _994, _995), float3(_993, _994, _995))), 0.0f);
  float _1263 = max((0.6000000238418579f - dot(float3(_996, _997, _998), float3(_996, _997, _998))), 0.0f);
  float _1264 = _1260 * _1260;
  float _1265 = _1261 * _1261;
  float _1266 = _1262 * _1262;
  float _1267 = _1263 * _1263;
  float _1282 = saturate((((sin(_261 - (frame_consts.time * 1.5f)) * 0.15000000596046448f) + 0.050000011920928955f) + (dot(float4((_1264 * _1264), (_1265 * _1265), (_1266 * _1266), (_1267 * _1267)), float4(dot(float3((_1236 * _1216), (_1236 * _1217), (_1236 * _1176)), float3(_966, _967, _968)), dot(float3((_1237 * _1218), (_1237 * _1219), (_1237 * _1177)), float3(_987, _988, _989)), dot(float3((_1238 * _1224), (_1238 * _1225), (_1238 * _1178)), float3(_993, _994, _995)), dot(float3((_1239 * _1226), (_1239 * _1227), (_1239 * _1179)), float3(_996, _997, _998)))) * 21.0f)) * 4.0f);
  float _1286 = (_1282 * _1282) * (3.0f - (_1282 * 2.0f));
  float _1288 = (_1286 * 0.6499999761581421f) + 0.3499999940395355f;
  float _1310 = saturate(_604);
  float _1311 = saturate(_944);
  float _1333 = (((_148 * 1.2000000476837158f) * _153) * frame_consts.params.vignette.golden_intensity) * ((((saturate(11.0f - (sqrt((_245 * _245) + (_244 * _244)) / ((_942 * 0.039000000804662704f) + 0.08100000768899918f))) * _944) + (saturate(11.0f - (sqrt((_240 * _240) + _250) / ((_602 * 0.039000000804662704f) + 0.08100000768899918f))) * _604)) + (saturate(11.0f - (sqrt((_257 * _257) + _250) / ((_1286 * 0.039000000804662704f) + 0.08100000768899918f))) * _1288)) + (((((saturate(1.0f - (abs(_241) * 0.8333333134651184f)) * _1310) + (saturate(1.0f - (abs(dot(float2(_244, _245), float2(-0.8660253882408142f, 0.5f))) * 0.8333333134651184f)) * _1311)) * saturate(_1288)) + ((_1310 * saturate(1.0f - (abs(dot(float2(_240, _241), float2(0.8660253882408142f, 0.5f))) * 0.8333333134651184f))) * _1311)) * 0.5f));
  SV_Target.x = ((_1333 * ((_200 * _200) - _162)) + _162);
  SV_Target.y = ((_1333 * ((_201 * _201) - _163)) + _163);
  SV_Target.z = ((_1333 * ((_202 * _202) - _164)) + _164);

  if (RENODX_TONE_MAP_TYPE) {
    SV_Target.rgb = renodx::draw::ToneMapPass(_25.rgb, SV_Target.rgb);
  } else {
    SV_Target.rgb = saturate(SV_Target.rgb);
  }
  SV_Target.rgb = renodx::draw::RenderIntermediatePass(SV_Target.rgb);

  SV_Target.w = 1.0f;
  return SV_Target;
}
