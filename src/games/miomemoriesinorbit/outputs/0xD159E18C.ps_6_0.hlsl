#include "../shared.h"

struct Lod_params {
  struct Lod_brush_params {
    float4 brush_uv[4];
    float base_radius;
    float radius_variation;
    float radius_random;
    float blur;
    float alpha;
    float stretch;
  } brushes;
  struct Lod_noise_params {
    float chaos;
    float freq;
    float brightness;
    float saturation;
    float hue;
  } noise;
  struct Lod_outlines_params {
    float2 thickness;
    float2 softness;
    float2 displacement;
    float2 attenuation;
    float lighting_threshold;
    float lighting_threshold_softness;
    float2 lighting_dark;
    float2 lighting_bright;
    float2 discretion;
    float2 alpha;
  } outlines;
};

struct Frame_constants {
  float3 cam_world_pos;
  float time;
  float2 inv_near_dim;
  float proj_scale;
  uint flags;
  float2 half_vp_dim;
  int2 vp_dim;
  float2 vp_texel_size;
  int2 mouse_pos;
  int2 inspected_pix;
  int2 hi_z_0_dim;
  int supersampling;
  int debug_patches;
  int use_patches;
  int emissive;
  float3 target;
  uint frame_number;
  uint shot_frame_number;
  float dt;
  float4 view_to_world[4];
  float4 world_to_view[4];
  float4 view_ndc[4];
  float4 world_ndc[4];
  float4 prev_world_ndc[4];
  float4 ndc_world[4];
  float4 ndc_to_prev_ndc[4];
  float4 prev_ndc_to_ndc[4];
  float4 view_world_z0;
  float4 pix_to_fog_eq;
  float3 mio_view;
  float3 mio_hair_outline_color;
  float mio_foliage_velocity;
  int show_wireframe;
  int ao;
  int glitch;
  int no_vertex_color;
  float paper_mult;
  int hatching;
  int mio_halo;
  int vol_temporal;
  int heart_attack_active;
  int heart_attack_secondary_target;
  int triangular_dissolve_enabled;
  int color_correct;
  float starfield_effect_amount;
  float starfield_fade_amount;
  float3 starfield_center_view;
  float starfield_glow_amount;
  float starfield_pulse_t;
  float death_anim_t;
  float3 game_plane_world_origin;
  float3 game_plane_world_normal;
  float3 game_plane_world_u;
  float3 game_plane_world_v;
  float4 game_plane_transform[4];
  float4 hatching_xf[4];
  float4 paper_xf[4];
  float2 game_plane_blend;
  float heart_attack_t;
  float heart_attack_duration;
  float heart_attack_pulse;
  float heart_attack_outline_distance;
  float heart_attack_dissolve_distance;
  float3 heart_attack_dissolve_color;
  float heart_attack_dissolve_base;
  float heart_attack_dissolve_mult;
  float3 heart_attack_dissolve_world_center;
  float heart_attack_vertical_dissolve;
  float triangular_dissolve_base_amount;
  float triangular_dissolve_amount;
  float flashback_lut;
  float evil_mio;
  float dead_mio;
  float godlike_mio;
  float khlia_pulse_t;
  float khlia__pulse_t;
  float khlia_pulse_period;
  float3 khlia_world_pos;
  float skydome_rotation_offset;
  float hatch_ambiant_mul;
  float hatch_ambiant_add;
  float glitch_scale;
  uint max_contours;
  uint max_contour_loops;
  int death_screen;
  float death_screen_t;
  int poetic_death_screen;
  float poetic_death_screen_t;
  float tremor_pulse_t;
  int invert;
  float surface_fade;
  struct Postprocess_params {
    struct AO_params {
      float3 color;
      float intensity;
    } ao;
    struct Fog_params {
      float bloom_factor;
      float space;
      float outline_density;
      float outline_attenuation;
    } fog;
    struct Ambient_light_params {
      int undercoat_grad;
      float3 color;
      float intensity;
      float gameplay_intensity;
      float gameplay_width;
      float directional_intensity;
      float directional_shadows;
      float undercoat_noise_freq;
      float undercoat_noise_amplitude;
      float undercoat_noise_threshold;
      float undercoating;
    } ambient_light;
    struct Vignette_params {
      float intensity;
      float rounded;
      float3 color;
      float golden_intensity;
      float golden_color;
    } vignette;
    struct Bloom_params {
      float intensity;
      float threshold_low;
      float threshold_high;
    } bloom;
    struct Mio_params {
      float light_intensity;
      float light_radius;
      float3 light_color;
      float spec_intensity;
      float3 halo_color;
      float halo_intensity;
    } mio;
    struct Particles_params {
      uint count;
      float cam_near;
      float cam_far;
      float fadeoff_near;
      float2 lifetime;
      float fadein_duration;
      float fadeoff_duration;
      float2 alpha;
      float2 scale;
      float2 speed;
      int gradient;
      float circle_attenuation;
    } particles;
    struct Chroma_aberration_params {
      float intensity;
    } chroma_aberration;
    struct Fade_params {
      float intensity;
      float3 color;
    } fade;
    struct Dof_params {
      float plane_01;
      float plane_01_softness;
      float plane_12;
      float plane_12_softness;
      float foreground;
      float foreground_softness;
    } dof;
    Lod_params lod_foreground;
    Lod_params lod_game;
    Lod_params lod_midground;
    Lod_params lod_background;
  } params;
};


Texture2D<float4> tex : register(t0);

Texture2D<float> depth_tex : register(t1);

Texture2D<float> paper_tex : register(t5);

Texture2D<float3> bloom_tex : register(t7);

Texture2D<float3> color_correct_lut : register(t8);

cbuffer frame_consts : register(b0) {
  Frame_constants frame_consts : packoffset(c000.x);
};

SamplerState sampler_nearest : register(s0);

SamplerState sampler_bilinear : register(s1);

SamplerState sampler_bilinear_wrap : register(s2);

float4 main(
  noperspective float4 SV_Position : SV_Position,
  linear float2 O_Uv : O_Uv
) : SV_Target {
  float4 SV_Target;
  float _15 = float((int)(frame_consts.vp_dim.x));
  float _16 = float((int)(frame_consts.vp_dim.y));
  float4 _17 = tex.SampleLevel(sampler_nearest, float2(O_Uv.x, O_Uv.y), 0.0f);
  float3 _21 = bloom_tex.SampleLevel(sampler_bilinear, float2(O_Uv.x, O_Uv.y), 0.0f);
  float _36 = max((((1.0f - (_17.y * 0.7152000069618225f)) - (_17.x * 0.2125999927520752f)) - (_17.z * 0.0722000002861023f)), 0.0010000000474974513f);
  float _40 = (_17.x / _36) + (frame_consts.params.bloom.intensity * _21.x);
  float _41 = (_17.y / _36) + (frame_consts.params.bloom.intensity * _21.y);
  float _42 = (_17.z / _36) + (frame_consts.params.bloom.intensity * _21.z);
  float _48 = (((_40 * 0.2125999927520752f) + 1.0f) + (_41 * 0.7152000069618225f)) + (_42 * 0.0722000002861023f);
  float _52 = saturate(_40 / _48);
  float _53 = saturate(_41 / _48);
  float _54 = saturate(_42 / _48);
  uint2 _55; color_correct_lut.GetDimensions(_55.x, _55.y);
  float _68;
  float _79;
  float _90;
  if (!(!(_52 <= 0.0031308000907301903f))) {
    _68 = (_52 * 12.920000076293945f);
  } else {
    _68 = (((pow(_52, 0.4166666567325592f)) * 1.0549999475479126f) + -0.054999999701976776f);
  }
  if (!(!(_53 <= 0.0031308000907301903f))) {
    _79 = (_53 * 12.920000076293945f);
  } else {
    _79 = (((pow(_53, 0.4166666567325592f)) * 1.0549999475479126f) + -0.054999999701976776f);
  }
  if (!(!(_54 <= 0.0031308000907301903f))) {
    _90 = (_54 * 12.920000076293945f);
  } else {
    _90 = (((pow(_54, 0.4166666567325592f)) * 1.0549999475479126f) + -0.054999999701976776f);
  }
  float _93 = float((uint)(_55.y + -1u));
  float _96 = _90 * _93;
  float _97 = frac(_96);
  float _99 = float((uint)_55.y);
  float _101 = (_68 * _93) + 0.5f;
  float _104 = float((uint)_55.x);
  float _106 = (lerp(_79, 1.0f, _93)) / _99;
  float3 _107 = color_correct_lut.SampleLevel(sampler_bilinear, float2((((ceil(_96) * _99) + _101) / _104), _106), 0.0f);
  float3 _115 = color_correct_lut.SampleLevel(sampler_bilinear, float2((((floor(_96) * _99) + _101) / _104), _106), 0.0f);
  float _125 = ((_107.x - _115.x) * _97) + _115.x;
  float _126 = ((_107.y - _115.y) * _97) + _115.y;
  float _127 = ((_107.z - _115.z) * _97) + _115.z;
  float _133 = depth_tex.SampleLevel(sampler_nearest, float2(O_Uv.x, O_Uv.y), 0.0f);
  float _137 = 10000.0f / ((_133.x * 19999.5f) + 0.5f);
  float _142 = (_137 * ((O_Uv.x * 2.0f) + -1.0f)) * frame_consts.inv_near_dim.x;
  float _144 = (_137 * (((1.0f - O_Uv.y) * 2.0f) + -1.0f)) * frame_consts.inv_near_dim.y;
  float _145 = -0.0f - _137;
  float _169 = mad((frame_consts.paper_xf[2].z), _145, mad((frame_consts.paper_xf[1].z), _144, (_142 * (frame_consts.paper_xf[0].z))));
  float _170 = mad((frame_consts.paper_xf[2].x), _145, mad((frame_consts.paper_xf[1].x), _144, (_142 * (frame_consts.paper_xf[0].x)))) / _169;
  float _171 = mad((frame_consts.paper_xf[2].y), _145, mad((frame_consts.paper_xf[1].y), _144, (_142 * (frame_consts.paper_xf[0].y)))) / _169;
  float _175 = 1.0f - frame_consts.game_plane_blend.y;
  float _180 = log2(max(5.0f, (-0.0f - (_169 - frame_consts.game_plane_blend.x)))) * 10.0f;
  float _181 = floor(_180);
  float _182 = _180 - _181;
  float _184 = exp2(_181 * 0.10000000149011612f);
  float _185 = 1.0f / _184;
  float _186 = min(_185, 0.20000000298023224f);
  float _188 = min((_185 * 0.9330329895019531f), 0.20000000298023224f);
  float _189 = frame_consts.game_plane_blend.x - _184;
  float _195 = frame_consts.game_plane_blend.x - (_184 * 1.0717734098434448f);
  float _207 = frame_consts.game_plane_blend.x + 10.0f;
  float _212 = log2(max(5.0f, (-0.0f - (_169 - _207)))) * 10.0f;
  float _213 = floor(_212);
  float _214 = _212 - _213;
  float _216 = exp2(_213 * 0.10000000149011612f);
  float _217 = 1.0f / _216;
  float _218 = min(_217, 0.20000000298023224f);
  float _220 = min((_217 * 0.9330329895019531f), 0.20000000298023224f);
  float _221 = _207 - _216;
  float _227 = _207 - (_216 * 1.0717734098434448f);
  float _239 = paper_tex.SampleLevel(sampler_bilinear_wrap, float2((((_189 * _170) + (frame_consts.paper_xf[3].x)) * _186), (((_189 * _171) + (frame_consts.paper_xf[3].y)) * _186)), 0.0f);
  float _242 = paper_tex.SampleLevel(sampler_bilinear_wrap, float2((((_195 * _170) + (frame_consts.paper_xf[3].x)) * _188), (((_195 * _171) + (frame_consts.paper_xf[3].y)) * _188)), 0.0f);
  float _245 = paper_tex.SampleLevel(sampler_bilinear_wrap, float2((((_221 * _170) + (frame_consts.paper_xf[3].x)) * _218), (((_221 * _171) + (frame_consts.paper_xf[3].y)) * _218)), 0.0f);
  float _248 = paper_tex.SampleLevel(sampler_bilinear_wrap, float2((((_227 * _170) + (frame_consts.paper_xf[3].x)) * _220), (((_227 * _171) + (frame_consts.paper_xf[3].y)) * _220)), 0.0f);
  float _257 = ((((1.0f - (((1.0f - _182) * _175) * _239.x)) - ((_182 * _175) * _242.x)) - (((1.0f - _214) * frame_consts.game_plane_blend.y) * _245.x)) - ((_214 * frame_consts.game_plane_blend.y) * _248.x)) * frame_consts.paper_mult;
  float _272 = _15 / _16;
  float _284 = exp2(log2(saturate((frame_consts.params.vignette.intensity * abs(O_Uv.x + -0.5f)) * (((_272 + -1.0f) * frame_consts.params.vignette.rounded) + 1.0f))) * 5.0f);
  float _285 = exp2(log2(saturate(frame_consts.params.vignette.intensity * abs(O_Uv.y + -0.5f))) * 5.0f);
  float _291 = exp2(log2(saturate(1.0f - dot(float2(_284, _285), float2(_284, _285)))) * 6.0f);
  float _296 = 1.0f - _291;
  float _298 = 1.0f - (_296 * 0.8500000238418579f);
  float _305 = (_298 * ((_125 - (_257 * _125)) - frame_consts.params.vignette.color.x)) + frame_consts.params.vignette.color.x;
  float _306 = (_298 * ((_126 - (_257 * _126)) - frame_consts.params.vignette.color.y)) + frame_consts.params.vignette.color.y;
  float _307 = (_298 * ((_127 - (_257 * _127)) - frame_consts.params.vignette.color.z)) + frame_consts.params.vignette.color.z;
  float _311 = _15 * O_Uv.x;
  float _312 = _16 * O_Uv.y;
  float _313 = _311 + _312;
  float _319 = frac(_313 * 0.0033333334140479565f) + -0.5f;
  float _320 = frac((_312 - _311) * 0.0033333334140479565f) + -0.5f;
  float _326 = saturate(sqrt((_320 * _320) + (_319 * _319)) * 2.0f);
  float _337 = saturate((sin((_313 * 0.01666666753590107f) - (frame_consts.time * 0.8500000238418579f)) * 1.2500001192092896f) + -0.25000008940696716f);
  float _342 = ((_337 * _337) * 0.2199999988079071f) * (3.0f - (_337 * 2.0f));
  float _343 = _342 + 0.9777389168739319f;
  float _344 = ((_326 * 0.13274884223937988f) + 0.7175776362419128f) + _342;
  float _345 = ((_326 * 0.3335757553577423f) + 0.30871906876564026f) + _342;
  float _350 = (O_Uv.x * 1080.0f) * _272;
  float _351 = O_Uv.y * 1080.0f;
  float _352 = _350 * 0.04444444552063942f;
  float _353 = O_Uv.y * 27.712812423706055f;
  float _355 = ceil(_352 - _353);
  float _358 = floor(O_Uv.y * 55.42562484741211f) + 1.0f;
  float _361 = ceil((-0.0f - _353) - _352);
  float _363 = (_358 + _355) + _361;
  float _365 = (_363 * 22.5f) + -33.75f;
  float _366 = _355 - _361;
  float _368 = _366 * 11.25f;
  float _374 = (((_358 * 0.5773502588272095f) - (_355 * 0.28867512941360474f)) - (_361 * 0.28867512941360474f)) * 22.5f;
  float _377 = _365 + _368;
  float _378 = _374 + (19.485570907592773f - (_363 * 12.990381240844727f));
  float _381 = ((_363 * 25.980762481689453f) + -38.97114181518555f) + _374;
  float _382 = _368 - _365;
  float _383 = _377 - _350;
  float _384 = _378 - _351;
  float _387 = _368 - _350;
  float _388 = _381 - _351;
  float _393 = _384 * _384;
  float _400 = _382 - _350;
  float _404 = _378 * 2.5f;
  float _405 = frame_consts.time * 1.5f;
  float _409 = _378 * 0.004444444552063942f;
  float _410 = frame_consts.time * 0.15000000596046448f;
  float _411 = (_377 * 0.04444444552063942f) - _410;
  float _412 = _409 - _410;
  float _413 = frame_consts.time * 0.02500000037252903f;
  float _414 = dot(float3(_411, _412, _413), float3(0.3333333432674408f, 0.3333333432674408f, 0.3333333432674408f));
  float _418 = floor(_414 + _411);
  float _419 = floor(_414 + _412);
  float _420 = floor(_414 + _413);
  float _424 = dot(float3(_418, _419, _420), float3(0.1666666716337204f, 0.1666666716337204f, 0.1666666716337204f));
  float _425 = _424 + (_411 - _418);
  float _426 = _424 + (_412 - _419);
  float _427 = (_413 - _420) + _424;
  float _431 = select((_425 < _426), 0.0f, 1.0f);
  float _432 = select((_426 < _427), 0.0f, 1.0f);
  float _433 = select((_427 < _425), 0.0f, 1.0f);
  float _434 = 1.0f - _431;
  float _435 = 1.0f - _432;
  float _436 = 1.0f - _433;
  float _437 = min(_431, _436);
  float _438 = min(_432, _434);
  float _439 = min(_433, _435);
  float _440 = max(_431, _436);
  float _441 = max(_432, _434);
  float _442 = max(_433, _435);
  float _446 = (_425 - _437) + 0.1666666716337204f;
  float _447 = (_426 - _438) + 0.1666666716337204f;
  float _448 = (_427 - _439) + 0.1666666716337204f;
  float _452 = (_425 - _440) + 0.3333333432674408f;
  float _453 = (_426 - _441) + 0.3333333432674408f;
  float _454 = (_427 - _442) + 0.3333333432674408f;
  float _455 = _425 + -0.5f;
  float _456 = _426 + -0.5f;
  float _457 = _427 + -0.5f;
  float _467 = _418 - (floor(_418 * 0.0034602077212184668f) * 289.0f);
  float _468 = _419 - (floor(_419 * 0.0034602077212184668f) * 289.0f);
  float _469 = _420 - (floor(_420 * 0.0034602077212184668f) * 289.0f);
  float _470 = _469 + _439;
  float _471 = _469 + _442;
  float _472 = _469 + 1.0f;
  float _481 = ((_469 * 34.0f) + 1.0f) * _469;
  float _482 = ((_470 * 34.0f) + 1.0f) * _470;
  float _483 = ((_471 * 34.0f) + 1.0f) * _471;
  float _484 = ((_472 * 34.0f) + 1.0f) * _472;
  float _498 = (_481 - (floor(_481 * 0.0034602077212184668f) * 289.0f)) + _468;
  float _501 = ((_468 + _438) - (floor(_482 * 0.0034602077212184668f) * 289.0f)) + _482;
  float _504 = ((_468 + _441) - (floor(_483 * 0.0034602077212184668f) * 289.0f)) + _483;
  float _507 = ((_468 + 1.0f) - (floor(_484 * 0.0034602077212184668f) * 289.0f)) + _484;
  float _516 = ((_498 * 34.0f) + 1.0f) * _498;
  float _517 = ((_501 * 34.0f) + 1.0f) * _501;
  float _518 = ((_504 * 34.0f) + 1.0f) * _504;
  float _519 = ((_507 * 34.0f) + 1.0f) * _507;
  float _533 = (_516 - (floor(_516 * 0.0034602077212184668f) * 289.0f)) + _467;
  float _536 = ((_467 + _437) - (floor(_517 * 0.0034602077212184668f) * 289.0f)) + _517;
  float _539 = ((_467 + _440) - (floor(_518 * 0.0034602077212184668f) * 289.0f)) + _518;
  float _542 = ((_467 + 1.0f) - (floor(_519 * 0.0034602077212184668f) * 289.0f)) + _519;
  float _551 = ((_533 * 34.0f) + 1.0f) * _533;
  float _552 = ((_536 * 34.0f) + 1.0f) * _536;
  float _553 = ((_539 * 34.0f) + 1.0f) * _539;
  float _554 = ((_542 * 34.0f) + 1.0f) * _542;
  float _567 = _551 - (floor(_551 * 0.0034602077212184668f) * 289.0f);
  float _568 = _552 - (floor(_552 * 0.0034602077212184668f) * 289.0f);
  float _569 = _553 - (floor(_553 * 0.0034602077212184668f) * 289.0f);
  float _570 = _554 - (floor(_554 * 0.0034602077212184668f) * 289.0f);
  float _583 = _567 - (floor(_567 * 0.020408164709806442f) * 49.0f);
  float _584 = _568 - (floor(_568 * 0.020408164709806442f) * 49.0f);
  float _585 = _569 - (floor(_569 * 0.020408164709806442f) * 49.0f);
  float _586 = _570 - (floor(_570 * 0.020408164709806442f) * 49.0f);
  float _591 = floor(_583 * 0.1428571492433548f);
  float _592 = floor(_584 * 0.1428571492433548f);
  float _593 = floor(_585 * 0.1428571492433548f);
  float _594 = floor(_586 * 0.1428571492433548f);
  float _611 = (_591 * 0.2857142984867096f) + -0.9285714030265808f;
  float _612 = (_592 * 0.2857142984867096f) + -0.9285714030265808f;
  float _613 = (_593 * 0.2857142984867096f) + -0.9285714030265808f;
  float _614 = (_594 * 0.2857142984867096f) + -0.9285714030265808f;
  float _619 = (floor(_583 - (_591 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _620 = (floor(_584 - (_592 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _621 = (floor(_585 - (_593 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _622 = (floor(_586 - (_594 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _635 = (1.0f - abs(_611)) - abs(_619);
  float _636 = (1.0f - abs(_612)) - abs(_620);
  float _637 = (1.0f - abs(_613)) - abs(_621);
  float _638 = (1.0f - abs(_614)) - abs(_622);
  float _667 = select((_635 > 0.0f), -0.0f, -1.0f);
  float _668 = select((_636 > 0.0f), -0.0f, -1.0f);
  float _669 = select((_637 > 0.0f), -0.0f, -1.0f);
  float _670 = select((_638 > 0.0f), -0.0f, -1.0f);
  float _675 = (((floor(_611) * 2.0f) + 1.0f) * _667) + _611;
  float _676 = (((floor(_619) * 2.0f) + 1.0f) * _667) + _619;
  float _677 = (((floor(_612) * 2.0f) + 1.0f) * _668) + _612;
  float _678 = (((floor(_620) * 2.0f) + 1.0f) * _668) + _620;
  float _683 = (((floor(_613) * 2.0f) + 1.0f) * _669) + _613;
  float _684 = (((floor(_621) * 2.0f) + 1.0f) * _669) + _621;
  float _685 = (((floor(_614) * 2.0f) + 1.0f) * _670) + _614;
  float _686 = (((floor(_622) * 2.0f) + 1.0f) * _670) + _622;
  float _695 = 1.7928400039672852f - (dot(float3(_675, _676, _635), float3(_675, _676, _635)) * 0.8537350296974182f);
  float _696 = 1.7928400039672852f - (dot(float3(_677, _678, _636), float3(_677, _678, _636)) * 0.8537350296974182f);
  float _697 = 1.7928400039672852f - (dot(float3(_683, _684, _637), float3(_683, _684, _637)) * 0.8537350296974182f);
  float _698 = 1.7928400039672852f - (dot(float3(_685, _686, _638), float3(_685, _686, _638)) * 0.8537350296974182f);
  float _719 = max((0.6000000238418579f - dot(float3(_425, _426, _427), float3(_425, _426, _427))), 0.0f);
  float _720 = max((0.6000000238418579f - dot(float3(_446, _447, _448), float3(_446, _447, _448))), 0.0f);
  float _721 = max((0.6000000238418579f - dot(float3(_452, _453, _454), float3(_452, _453, _454))), 0.0f);
  float _722 = max((0.6000000238418579f - dot(float3(_455, _456, _457), float3(_455, _456, _457))), 0.0f);
  float _723 = _719 * _719;
  float _724 = _720 * _720;
  float _725 = _721 * _721;
  float _726 = _722 * _722;
  float _741 = saturate((((sin(_404 - _405) * 0.15000000596046448f) + 0.050000011920928955f) + (dot(float4((_723 * _723), (_724 * _724), (_725 * _725), (_726 * _726)), float4(dot(float3((_695 * _675), (_695 * _676), (_695 * _635)), float3(_425, _426, _427)), dot(float3((_696 * _677), (_696 * _678), (_696 * _636)), float3(_446, _447, _448)), dot(float3((_697 * _683), (_697 * _684), (_697 * _637)), float3(_452, _453, _454)), dot(float3((_698 * _685), (_698 * _686), (_698 * _638)), float3(_455, _456, _457)))) * 21.0f)) * 4.0f);
  float _745 = (_741 * _741) * (3.0f - (_741 * 2.0f));
  float _747 = (_745 * 0.6499999761581421f) + 0.3499999940395355f;
  float _752 = (_366 * 0.5f) - _410;
  float _753 = (_381 * 0.004444444552063942f) - _410;
  float _754 = dot(float3(_752, _753, _413), float3(0.3333333432674408f, 0.3333333432674408f, 0.3333333432674408f));
  float _758 = floor(_754 + _752);
  float _759 = floor(_754 + _753);
  float _760 = floor(_754 + _413);
  float _764 = dot(float3(_758, _759, _760), float3(0.1666666716337204f, 0.1666666716337204f, 0.1666666716337204f));
  float _765 = _764 + (_752 - _758);
  float _766 = _764 + (_753 - _759);
  float _767 = (_413 - _760) + _764;
  float _771 = select((_765 < _766), 0.0f, 1.0f);
  float _772 = select((_766 < _767), 0.0f, 1.0f);
  float _773 = select((_767 < _765), 0.0f, 1.0f);
  float _774 = 1.0f - _771;
  float _775 = 1.0f - _772;
  float _776 = 1.0f - _773;
  float _777 = min(_771, _776);
  float _778 = min(_772, _774);
  float _779 = min(_773, _775);
  float _780 = max(_771, _776);
  float _781 = max(_772, _774);
  float _782 = max(_773, _775);
  float _786 = (_765 - _777) + 0.1666666716337204f;
  float _787 = (_766 - _778) + 0.1666666716337204f;
  float _788 = (_767 - _779) + 0.1666666716337204f;
  float _792 = (_765 - _780) + 0.3333333432674408f;
  float _793 = (_766 - _781) + 0.3333333432674408f;
  float _794 = (_767 - _782) + 0.3333333432674408f;
  float _795 = _765 + -0.5f;
  float _796 = _766 + -0.5f;
  float _797 = _767 + -0.5f;
  float _807 = _758 - (floor(_758 * 0.0034602077212184668f) * 289.0f);
  float _808 = _759 - (floor(_759 * 0.0034602077212184668f) * 289.0f);
  float _809 = _760 - (floor(_760 * 0.0034602077212184668f) * 289.0f);
  float _810 = _809 + _779;
  float _811 = _809 + _782;
  float _812 = _809 + 1.0f;
  float _821 = ((_809 * 34.0f) + 1.0f) * _809;
  float _822 = ((_810 * 34.0f) + 1.0f) * _810;
  float _823 = ((_811 * 34.0f) + 1.0f) * _811;
  float _824 = ((_812 * 34.0f) + 1.0f) * _812;
  float _838 = (_821 - (floor(_821 * 0.0034602077212184668f) * 289.0f)) + _808;
  float _841 = ((_808 + _778) - (floor(_822 * 0.0034602077212184668f) * 289.0f)) + _822;
  float _844 = ((_808 + _781) - (floor(_823 * 0.0034602077212184668f) * 289.0f)) + _823;
  float _847 = ((_808 + 1.0f) - (floor(_824 * 0.0034602077212184668f) * 289.0f)) + _824;
  float _856 = ((_838 * 34.0f) + 1.0f) * _838;
  float _857 = ((_841 * 34.0f) + 1.0f) * _841;
  float _858 = ((_844 * 34.0f) + 1.0f) * _844;
  float _859 = ((_847 * 34.0f) + 1.0f) * _847;
  float _873 = (_856 - (floor(_856 * 0.0034602077212184668f) * 289.0f)) + _807;
  float _876 = ((_807 + _777) - (floor(_857 * 0.0034602077212184668f) * 289.0f)) + _857;
  float _879 = ((_807 + _780) - (floor(_858 * 0.0034602077212184668f) * 289.0f)) + _858;
  float _882 = ((_807 + 1.0f) - (floor(_859 * 0.0034602077212184668f) * 289.0f)) + _859;
  float _891 = ((_873 * 34.0f) + 1.0f) * _873;
  float _892 = ((_876 * 34.0f) + 1.0f) * _876;
  float _893 = ((_879 * 34.0f) + 1.0f) * _879;
  float _894 = ((_882 * 34.0f) + 1.0f) * _882;
  float _907 = _891 - (floor(_891 * 0.0034602077212184668f) * 289.0f);
  float _908 = _892 - (floor(_892 * 0.0034602077212184668f) * 289.0f);
  float _909 = _893 - (floor(_893 * 0.0034602077212184668f) * 289.0f);
  float _910 = _894 - (floor(_894 * 0.0034602077212184668f) * 289.0f);
  float _923 = _907 - (floor(_907 * 0.020408164709806442f) * 49.0f);
  float _924 = _908 - (floor(_908 * 0.020408164709806442f) * 49.0f);
  float _925 = _909 - (floor(_909 * 0.020408164709806442f) * 49.0f);
  float _926 = _910 - (floor(_910 * 0.020408164709806442f) * 49.0f);
  float _931 = floor(_923 * 0.1428571492433548f);
  float _932 = floor(_924 * 0.1428571492433548f);
  float _933 = floor(_925 * 0.1428571492433548f);
  float _934 = floor(_926 * 0.1428571492433548f);
  float _951 = (_931 * 0.2857142984867096f) + -0.9285714030265808f;
  float _952 = (_932 * 0.2857142984867096f) + -0.9285714030265808f;
  float _953 = (_933 * 0.2857142984867096f) + -0.9285714030265808f;
  float _954 = (_934 * 0.2857142984867096f) + -0.9285714030265808f;
  float _959 = (floor(_923 - (_931 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _960 = (floor(_924 - (_932 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _961 = (floor(_925 - (_933 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _962 = (floor(_926 - (_934 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _975 = (1.0f - abs(_951)) - abs(_959);
  float _976 = (1.0f - abs(_952)) - abs(_960);
  float _977 = (1.0f - abs(_953)) - abs(_961);
  float _978 = (1.0f - abs(_954)) - abs(_962);
  float _1007 = select((_975 > 0.0f), -0.0f, -1.0f);
  float _1008 = select((_976 > 0.0f), -0.0f, -1.0f);
  float _1009 = select((_977 > 0.0f), -0.0f, -1.0f);
  float _1010 = select((_978 > 0.0f), -0.0f, -1.0f);
  float _1015 = (((floor(_951) * 2.0f) + 1.0f) * _1007) + _951;
  float _1016 = (((floor(_959) * 2.0f) + 1.0f) * _1007) + _959;
  float _1017 = (((floor(_952) * 2.0f) + 1.0f) * _1008) + _952;
  float _1018 = (((floor(_960) * 2.0f) + 1.0f) * _1008) + _960;
  float _1023 = (((floor(_953) * 2.0f) + 1.0f) * _1009) + _953;
  float _1024 = (((floor(_961) * 2.0f) + 1.0f) * _1009) + _961;
  float _1025 = (((floor(_954) * 2.0f) + 1.0f) * _1010) + _954;
  float _1026 = (((floor(_962) * 2.0f) + 1.0f) * _1010) + _962;
  float _1035 = 1.7928400039672852f - (dot(float3(_1015, _1016, _975), float3(_1015, _1016, _975)) * 0.8537350296974182f);
  float _1036 = 1.7928400039672852f - (dot(float3(_1017, _1018, _976), float3(_1017, _1018, _976)) * 0.8537350296974182f);
  float _1037 = 1.7928400039672852f - (dot(float3(_1023, _1024, _977), float3(_1023, _1024, _977)) * 0.8537350296974182f);
  float _1038 = 1.7928400039672852f - (dot(float3(_1025, _1026, _978), float3(_1025, _1026, _978)) * 0.8537350296974182f);
  float _1059 = max((0.6000000238418579f - dot(float3(_765, _766, _767), float3(_765, _766, _767))), 0.0f);
  float _1060 = max((0.6000000238418579f - dot(float3(_786, _787, _788), float3(_786, _787, _788))), 0.0f);
  float _1061 = max((0.6000000238418579f - dot(float3(_792, _793, _794), float3(_792, _793, _794))), 0.0f);
  float _1062 = max((0.6000000238418579f - dot(float3(_795, _796, _797), float3(_795, _796, _797))), 0.0f);
  float _1063 = _1059 * _1059;
  float _1064 = _1060 * _1060;
  float _1065 = _1061 * _1061;
  float _1066 = _1062 * _1062;
  float _1081 = saturate((((sin((_381 * 2.5f) - _405) * 0.15000000596046448f) + 0.050000011920928955f) + (dot(float4((_1063 * _1063), (_1064 * _1064), (_1065 * _1065), (_1066 * _1066)), float4(dot(float3((_1035 * _1015), (_1035 * _1016), (_1035 * _975)), float3(_765, _766, _767)), dot(float3((_1036 * _1017), (_1036 * _1018), (_1036 * _976)), float3(_786, _787, _788)), dot(float3((_1037 * _1023), (_1037 * _1024), (_1037 * _977)), float3(_792, _793, _794)), dot(float3((_1038 * _1025), (_1038 * _1026), (_1038 * _978)), float3(_795, _796, _797)))) * 21.0f)) * 4.0f);
  float _1085 = (_1081 * _1081) * (3.0f - (_1081 * 2.0f));
  float _1087 = (_1085 * 0.6499999761581421f) + 0.3499999940395355f;
  float _1094 = frame_consts.time * 0.15000000596046448f;
  float _1095 = (_382 * 0.04444444552063942f) - _1094;
  float _1096 = _409 - _1094;
  float _1097 = frame_consts.time * 0.02500000037252903f;
  float _1098 = dot(float3(_1095, _1096, _1097), float3(0.3333333432674408f, 0.3333333432674408f, 0.3333333432674408f));
  float _1102 = floor(_1095 + _1098);
  float _1103 = floor(_1096 + _1098);
  float _1104 = floor(_1097 + _1098);
  float _1108 = dot(float3(_1102, _1103, _1104), float3(0.1666666716337204f, 0.1666666716337204f, 0.1666666716337204f));
  float _1109 = _1108 + (_1095 - _1102);
  float _1110 = _1108 + (_1096 - _1103);
  float _1111 = (_1097 - _1104) + _1108;
  float _1115 = select((_1109 < _1110), 0.0f, 1.0f);
  float _1116 = select((_1110 < _1111), 0.0f, 1.0f);
  float _1117 = select((_1111 < _1109), 0.0f, 1.0f);
  float _1118 = 1.0f - _1115;
  float _1119 = 1.0f - _1116;
  float _1120 = 1.0f - _1117;
  float _1121 = min(_1115, _1120);
  float _1122 = min(_1116, _1118);
  float _1123 = min(_1117, _1119);
  float _1124 = max(_1115, _1120);
  float _1125 = max(_1116, _1118);
  float _1126 = max(_1117, _1119);
  float _1130 = (_1109 - _1121) + 0.1666666716337204f;
  float _1131 = (_1110 - _1122) + 0.1666666716337204f;
  float _1132 = (_1111 - _1123) + 0.1666666716337204f;
  float _1136 = (_1109 - _1124) + 0.3333333432674408f;
  float _1137 = (_1110 - _1125) + 0.3333333432674408f;
  float _1138 = (_1111 - _1126) + 0.3333333432674408f;
  float _1139 = _1109 + -0.5f;
  float _1140 = _1110 + -0.5f;
  float _1141 = _1111 + -0.5f;
  float _1151 = _1102 - (floor(_1102 * 0.0034602077212184668f) * 289.0f);
  float _1152 = _1103 - (floor(_1103 * 0.0034602077212184668f) * 289.0f);
  float _1153 = _1104 - (floor(_1104 * 0.0034602077212184668f) * 289.0f);
  float _1154 = _1153 + _1123;
  float _1155 = _1153 + _1126;
  float _1156 = _1153 + 1.0f;
  float _1165 = ((_1153 * 34.0f) + 1.0f) * _1153;
  float _1166 = ((_1154 * 34.0f) + 1.0f) * _1154;
  float _1167 = ((_1155 * 34.0f) + 1.0f) * _1155;
  float _1168 = ((_1156 * 34.0f) + 1.0f) * _1156;
  float _1182 = (_1165 - (floor(_1165 * 0.0034602077212184668f) * 289.0f)) + _1152;
  float _1185 = ((_1152 + _1122) - (floor(_1166 * 0.0034602077212184668f) * 289.0f)) + _1166;
  float _1188 = ((_1152 + _1125) - (floor(_1167 * 0.0034602077212184668f) * 289.0f)) + _1167;
  float _1191 = ((_1152 + 1.0f) - (floor(_1168 * 0.0034602077212184668f) * 289.0f)) + _1168;
  float _1200 = ((_1182 * 34.0f) + 1.0f) * _1182;
  float _1201 = ((_1185 * 34.0f) + 1.0f) * _1185;
  float _1202 = ((_1188 * 34.0f) + 1.0f) * _1188;
  float _1203 = ((_1191 * 34.0f) + 1.0f) * _1191;
  float _1217 = (_1200 - (floor(_1200 * 0.0034602077212184668f) * 289.0f)) + _1151;
  float _1220 = ((_1151 + _1121) - (floor(_1201 * 0.0034602077212184668f) * 289.0f)) + _1201;
  float _1223 = ((_1151 + _1124) - (floor(_1202 * 0.0034602077212184668f) * 289.0f)) + _1202;
  float _1226 = ((_1151 + 1.0f) - (floor(_1203 * 0.0034602077212184668f) * 289.0f)) + _1203;
  float _1235 = ((_1217 * 34.0f) + 1.0f) * _1217;
  float _1236 = ((_1220 * 34.0f) + 1.0f) * _1220;
  float _1237 = ((_1223 * 34.0f) + 1.0f) * _1223;
  float _1238 = ((_1226 * 34.0f) + 1.0f) * _1226;
  float _1251 = _1235 - (floor(_1235 * 0.0034602077212184668f) * 289.0f);
  float _1252 = _1236 - (floor(_1236 * 0.0034602077212184668f) * 289.0f);
  float _1253 = _1237 - (floor(_1237 * 0.0034602077212184668f) * 289.0f);
  float _1254 = _1238 - (floor(_1238 * 0.0034602077212184668f) * 289.0f);
  float _1267 = _1251 - (floor(_1251 * 0.020408164709806442f) * 49.0f);
  float _1268 = _1252 - (floor(_1252 * 0.020408164709806442f) * 49.0f);
  float _1269 = _1253 - (floor(_1253 * 0.020408164709806442f) * 49.0f);
  float _1270 = _1254 - (floor(_1254 * 0.020408164709806442f) * 49.0f);
  float _1275 = floor(_1267 * 0.1428571492433548f);
  float _1276 = floor(_1268 * 0.1428571492433548f);
  float _1277 = floor(_1269 * 0.1428571492433548f);
  float _1278 = floor(_1270 * 0.1428571492433548f);
  float _1295 = (_1275 * 0.2857142984867096f) + -0.9285714030265808f;
  float _1296 = (_1276 * 0.2857142984867096f) + -0.9285714030265808f;
  float _1297 = (_1277 * 0.2857142984867096f) + -0.9285714030265808f;
  float _1298 = (_1278 * 0.2857142984867096f) + -0.9285714030265808f;
  float _1303 = (floor(_1267 - (_1275 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _1304 = (floor(_1268 - (_1276 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _1305 = (floor(_1269 - (_1277 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _1306 = (floor(_1270 - (_1278 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _1319 = (1.0f - abs(_1295)) - abs(_1303);
  float _1320 = (1.0f - abs(_1296)) - abs(_1304);
  float _1321 = (1.0f - abs(_1297)) - abs(_1305);
  float _1322 = (1.0f - abs(_1298)) - abs(_1306);
  float _1351 = select((_1319 > 0.0f), -0.0f, -1.0f);
  float _1352 = select((_1320 > 0.0f), -0.0f, -1.0f);
  float _1353 = select((_1321 > 0.0f), -0.0f, -1.0f);
  float _1354 = select((_1322 > 0.0f), -0.0f, -1.0f);
  float _1359 = (((floor(_1295) * 2.0f) + 1.0f) * _1351) + _1295;
  float _1360 = (((floor(_1303) * 2.0f) + 1.0f) * _1351) + _1303;
  float _1361 = (((floor(_1296) * 2.0f) + 1.0f) * _1352) + _1296;
  float _1362 = (((floor(_1304) * 2.0f) + 1.0f) * _1352) + _1304;
  float _1367 = (((floor(_1297) * 2.0f) + 1.0f) * _1353) + _1297;
  float _1368 = (((floor(_1305) * 2.0f) + 1.0f) * _1353) + _1305;
  float _1369 = (((floor(_1298) * 2.0f) + 1.0f) * _1354) + _1298;
  float _1370 = (((floor(_1306) * 2.0f) + 1.0f) * _1354) + _1306;
  float _1379 = 1.7928400039672852f - (dot(float3(_1359, _1360, _1319), float3(_1359, _1360, _1319)) * 0.8537350296974182f);
  float _1380 = 1.7928400039672852f - (dot(float3(_1361, _1362, _1320), float3(_1361, _1362, _1320)) * 0.8537350296974182f);
  float _1381 = 1.7928400039672852f - (dot(float3(_1367, _1368, _1321), float3(_1367, _1368, _1321)) * 0.8537350296974182f);
  float _1382 = 1.7928400039672852f - (dot(float3(_1369, _1370, _1322), float3(_1369, _1370, _1322)) * 0.8537350296974182f);
  float _1403 = max((0.6000000238418579f - dot(float3(_1109, _1110, _1111), float3(_1109, _1110, _1111))), 0.0f);
  float _1404 = max((0.6000000238418579f - dot(float3(_1130, _1131, _1132), float3(_1130, _1131, _1132))), 0.0f);
  float _1405 = max((0.6000000238418579f - dot(float3(_1136, _1137, _1138), float3(_1136, _1137, _1138))), 0.0f);
  float _1406 = max((0.6000000238418579f - dot(float3(_1139, _1140, _1141), float3(_1139, _1140, _1141))), 0.0f);
  float _1407 = _1403 * _1403;
  float _1408 = _1404 * _1404;
  float _1409 = _1405 * _1405;
  float _1410 = _1406 * _1406;
  float _1425 = saturate((((sin(_404 - (frame_consts.time * 1.5f)) * 0.15000000596046448f) + 0.050000011920928955f) + (dot(float4((_1407 * _1407), (_1408 * _1408), (_1409 * _1409), (_1410 * _1410)), float4(dot(float3((_1379 * _1359), (_1379 * _1360), (_1379 * _1319)), float3(_1109, _1110, _1111)), dot(float3((_1380 * _1361), (_1380 * _1362), (_1380 * _1320)), float3(_1130, _1131, _1132)), dot(float3((_1381 * _1367), (_1381 * _1368), (_1381 * _1321)), float3(_1136, _1137, _1138)), dot(float3((_1382 * _1369), (_1382 * _1370), (_1382 * _1322)), float3(_1139, _1140, _1141)))) * 21.0f)) * 4.0f);
  float _1429 = (_1425 * _1425) * (3.0f - (_1425 * 2.0f));
  float _1431 = (_1429 * 0.6499999761581421f) + 0.3499999940395355f;
  float _1453 = saturate(_747);
  float _1454 = saturate(_1087);
  float _1476 = (((_291 * 1.2000000476837158f) * _296) * frame_consts.params.vignette.golden_intensity) * ((((saturate(11.0f - (sqrt((_388 * _388) + (_387 * _387)) / ((_1085 * 0.039000000804662704f) + 0.08100000768899918f))) * _1087) + (saturate(11.0f - (sqrt((_383 * _383) + _393) / ((_745 * 0.039000000804662704f) + 0.08100000768899918f))) * _747)) + (saturate(11.0f - (sqrt((_400 * _400) + _393) / ((_1429 * 0.039000000804662704f) + 0.08100000768899918f))) * _1431)) + (((((saturate(1.0f - (abs(_384) * 0.8333333134651184f)) * _1453) + (saturate(1.0f - (abs(dot(float2(_387, _388), float2(-0.8660253882408142f, 0.5f))) * 0.8333333134651184f)) * _1454)) * saturate(_1431)) + ((_1453 * saturate(1.0f - (abs(dot(float2(_383, _384), float2(0.8660253882408142f, 0.5f))) * 0.8333333134651184f))) * _1454)) * 0.5f));
  SV_Target.x = ((_1476 * ((_343 * _343) - _305)) + _305);
  SV_Target.y = ((_1476 * ((_344 * _344) - _306)) + _306);
  SV_Target.z = ((_1476 * ((_345 * _345) - _307)) + _307);
  if (RENODX_TONE_MAP_TYPE) {
    SV_Target.rgb = renodx::draw::ToneMapPass(_17.rgb, SV_Target.rgb);
  } else {
    SV_Target.rgb = saturate(SV_Target.rgb);
  }
  SV_Target.rgb = renodx::draw::RenderIntermediatePass(SV_Target.rgb);

  SV_Target.w = 1.0f;
  return SV_Target;
}
