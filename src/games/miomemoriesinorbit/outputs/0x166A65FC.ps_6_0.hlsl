#include "../shared.h"

struct Lod_params {
  struct Lod_brush_params {
    float4 brush_uv[4];
    float base_radius;
    float radius_variation;
    float radius_random;
    float blur;
    float alpha;
    float stretch;
  } brushes;
  struct Lod_noise_params {
    float chaos;
    float freq;
    float brightness;
    float saturation;
    float hue;
  } noise;
  struct Lod_outlines_params {
    float2 thickness;
    float2 softness;
    float2 displacement;
    float2 attenuation;
    float lighting_threshold;
    float lighting_threshold_softness;
    float2 lighting_dark;
    float2 lighting_bright;
    float2 discretion;
    float2 alpha;
  } outlines;
};

struct Frame_constants {
  float3 cam_world_pos;
  float time;
  float2 inv_near_dim;
  float proj_scale;
  uint flags;
  float2 half_vp_dim;
  int2 vp_dim;
  float2 vp_texel_size;
  int2 mouse_pos;
  int2 inspected_pix;
  int2 hi_z_0_dim;
  int supersampling;
  int debug_patches;
  int use_patches;
  int emissive;
  float3 target;
  uint frame_number;
  uint shot_frame_number;
  float dt;
  float4 view_to_world[4];
  float4 world_to_view[4];
  float4 view_ndc[4];
  float4 world_ndc[4];
  float4 prev_world_ndc[4];
  float4 ndc_world[4];
  float4 ndc_to_prev_ndc[4];
  float4 prev_ndc_to_ndc[4];
  float4 view_world_z0;
  float4 pix_to_fog_eq;
  float3 mio_view;
  float3 mio_hair_outline_color;
  float mio_foliage_velocity;
  int show_wireframe;
  int ao;
  int glitch;
  int no_vertex_color;
  float paper_mult;
  int hatching;
  int mio_halo;
  int vol_temporal;
  int heart_attack_active;
  int heart_attack_secondary_target;
  int triangular_dissolve_enabled;
  int color_correct;
  float starfield_effect_amount;
  float starfield_fade_amount;
  float3 starfield_center_view;
  float starfield_glow_amount;
  float starfield_pulse_t;
  float death_anim_t;
  float3 game_plane_world_origin;
  float3 game_plane_world_normal;
  float3 game_plane_world_u;
  float3 game_plane_world_v;
  float4 game_plane_transform[4];
  float4 hatching_xf[4];
  float4 paper_xf[4];
  float2 game_plane_blend;
  float heart_attack_t;
  float heart_attack_duration;
  float heart_attack_pulse;
  float heart_attack_outline_distance;
  float heart_attack_dissolve_distance;
  float3 heart_attack_dissolve_color;
  float heart_attack_dissolve_base;
  float heart_attack_dissolve_mult;
  float3 heart_attack_dissolve_world_center;
  float heart_attack_vertical_dissolve;
  float triangular_dissolve_base_amount;
  float triangular_dissolve_amount;
  float flashback_lut;
  float evil_mio;
  float dead_mio;
  float godlike_mio;
  float khlia_pulse_t;
  float khlia__pulse_t;
  float khlia_pulse_period;
  float3 khlia_world_pos;
  float skydome_rotation_offset;
  float hatch_ambiant_mul;
  float hatch_ambiant_add;
  float glitch_scale;
  uint max_contours;
  uint max_contour_loops;
  int death_screen;
  float death_screen_t;
  int poetic_death_screen;
  float poetic_death_screen_t;
  float tremor_pulse_t;
  int invert;
  float surface_fade;
  struct Postprocess_params {
    struct AO_params {
      float3 color;
      float intensity;
    } ao;
    struct Fog_params {
      float bloom_factor;
      float space;
      float outline_density;
      float outline_attenuation;
    } fog;
    struct Ambient_light_params {
      int undercoat_grad;
      float3 color;
      float intensity;
      float gameplay_intensity;
      float gameplay_width;
      float directional_intensity;
      float directional_shadows;
      float undercoat_noise_freq;
      float undercoat_noise_amplitude;
      float undercoat_noise_threshold;
      float undercoating;
    } ambient_light;
    struct Vignette_params {
      float intensity;
      float rounded;
      float3 color;
      float golden_intensity;
      float golden_color;
    } vignette;
    struct Bloom_params {
      float intensity;
      float threshold_low;
      float threshold_high;
    } bloom;
    struct Mio_params {
      float light_intensity;
      float light_radius;
      float3 light_color;
      float spec_intensity;
      float3 halo_color;
      float halo_intensity;
    } mio;
    struct Particles_params {
      uint count;
      float cam_near;
      float cam_far;
      float fadeoff_near;
      float2 lifetime;
      float fadein_duration;
      float fadeoff_duration;
      float2 alpha;
      float2 scale;
      float2 speed;
      int gradient;
      float circle_attenuation;
    } particles;
    struct Chroma_aberration_params {
      float intensity;
    } chroma_aberration;
    struct Fade_params {
      float intensity;
      float3 color;
    } fade;
    struct Dof_params {
      float plane_01;
      float plane_01_softness;
      float plane_12;
      float plane_12_softness;
      float foreground;
      float foreground_softness;
    } dof;
    Lod_params lod_foreground;
    Lod_params lod_game;
    Lod_params lod_midground;
    Lod_params lod_background;
  } params;
};


Texture2D<float4> tex : register(t0);

Texture2D<float> depth_tex : register(t1);

Texture2D<float2> distortion : register(t4);

Texture2D<float> paper_tex : register(t5);

Texture2D<float3> bloom_tex : register(t7);

Texture2D<float3> color_correct_lut : register(t8);

cbuffer frame_consts : register(b0) {
  Frame_constants frame_consts : packoffset(c000.x);
};

SamplerState sampler_nearest : register(s0);

SamplerState sampler_bilinear : register(s1);

SamplerState sampler_bilinear_wrap : register(s2);

float4 main(
  noperspective float4 SV_Position : SV_Position,
  linear float2 O_Uv : O_Uv
) : SV_Target {
  float4 SV_Target;
  float _16 = float((int)(frame_consts.vp_dim.x));
  float _17 = float((int)(frame_consts.vp_dim.y));
  float2 _18 = distortion.SampleLevel(sampler_nearest, float2(O_Uv.x, O_Uv.y), 0.0f);
  float _21 = _17 / _16;
  float _26 = saturate((_18.x * _21) + O_Uv.x);
  float _27 = saturate((_18.y * _21) + O_Uv.y);
  float4 _28 = tex.SampleLevel(sampler_nearest, float2(_26, _27), 0.0f);
  float3 _32 = bloom_tex.SampleLevel(sampler_bilinear, float2(_26, _27), 0.0f);
  float _47 = max((((1.0f - (_28.y * 0.7152000069618225f)) - (_28.x * 0.2125999927520752f)) - (_28.z * 0.0722000002861023f)), 0.0010000000474974513f);
  float _51 = (_28.x / _47) + (frame_consts.params.bloom.intensity * _32.x);
  float _52 = (_28.y / _47) + (frame_consts.params.bloom.intensity * _32.y);
  float _53 = (_28.z / _47) + (frame_consts.params.bloom.intensity * _32.z);
  float _59 = (((_51 * 0.2125999927520752f) + 1.0f) + (_52 * 0.7152000069618225f)) + (_53 * 0.0722000002861023f);
  float _63 = saturate(_51 / _59);
  float _64 = saturate(_52 / _59);
  float _65 = saturate(_53 / _59);
  uint2 _66; color_correct_lut.GetDimensions(_66.x, _66.y);
  float _79;
  float _90;
  float _101;
  if (!(!(_63 <= 0.0031308000907301903f))) {
    _79 = (_63 * 12.920000076293945f);
  } else {
    _79 = (((pow(_63, 0.4166666567325592f)) * 1.0549999475479126f) + -0.054999999701976776f);
  }
  if (!(!(_64 <= 0.0031308000907301903f))) {
    _90 = (_64 * 12.920000076293945f);
  } else {
    _90 = (((pow(_64, 0.4166666567325592f)) * 1.0549999475479126f) + -0.054999999701976776f);
  }
  if (!(!(_65 <= 0.0031308000907301903f))) {
    _101 = (_65 * 12.920000076293945f);
  } else {
    _101 = (((pow(_65, 0.4166666567325592f)) * 1.0549999475479126f) + -0.054999999701976776f);
  }
  float _104 = float((uint)(_66.y + -1u));
  float _107 = _101 * _104;
  float _108 = frac(_107);
  float _110 = float((uint)_66.y);
  float _112 = (_79 * _104) + 0.5f;
  float _115 = float((uint)_66.x);
  float _117 = (lerp(_90, 1.0f, _104)) / _110;
  float3 _118 = color_correct_lut.SampleLevel(sampler_bilinear, float2((((ceil(_107) * _110) + _112) / _115), _117), 0.0f);
  float3 _126 = color_correct_lut.SampleLevel(sampler_bilinear, float2((((floor(_107) * _110) + _112) / _115), _117), 0.0f);
  float _136 = ((_118.x - _126.x) * _108) + _126.x;
  float _137 = ((_118.y - _126.y) * _108) + _126.y;
  float _138 = ((_118.z - _126.z) * _108) + _126.z;
  float _144 = depth_tex.SampleLevel(sampler_nearest, float2(_26, _27), 0.0f);
  float _148 = 10000.0f / ((_144.x * 19999.5f) + 0.5f);
  float _153 = (_148 * ((_26 * 2.0f) + -1.0f)) * frame_consts.inv_near_dim.x;
  float _155 = (_148 * (((1.0f - _27) * 2.0f) + -1.0f)) * frame_consts.inv_near_dim.y;
  float _156 = -0.0f - _148;
  float _180 = mad((frame_consts.paper_xf[2].z), _156, mad((frame_consts.paper_xf[1].z), _155, (_153 * (frame_consts.paper_xf[0].z))));
  float _181 = mad((frame_consts.paper_xf[2].x), _156, mad((frame_consts.paper_xf[1].x), _155, (_153 * (frame_consts.paper_xf[0].x)))) / _180;
  float _182 = mad((frame_consts.paper_xf[2].y), _156, mad((frame_consts.paper_xf[1].y), _155, (_153 * (frame_consts.paper_xf[0].y)))) / _180;
  float _186 = 1.0f - frame_consts.game_plane_blend.y;
  float _191 = log2(max(5.0f, (-0.0f - (_180 - frame_consts.game_plane_blend.x)))) * 10.0f;
  float _192 = floor(_191);
  float _193 = _191 - _192;
  float _195 = exp2(_192 * 0.10000000149011612f);
  float _196 = 1.0f / _195;
  float _197 = min(_196, 0.20000000298023224f);
  float _199 = min((_196 * 0.9330329895019531f), 0.20000000298023224f);
  float _200 = frame_consts.game_plane_blend.x - _195;
  float _206 = frame_consts.game_plane_blend.x - (_195 * 1.0717734098434448f);
  float _218 = frame_consts.game_plane_blend.x + 10.0f;
  float _223 = log2(max(5.0f, (-0.0f - (_180 - _218)))) * 10.0f;
  float _224 = floor(_223);
  float _225 = _223 - _224;
  float _227 = exp2(_224 * 0.10000000149011612f);
  float _228 = 1.0f / _227;
  float _229 = min(_228, 0.20000000298023224f);
  float _231 = min((_228 * 0.9330329895019531f), 0.20000000298023224f);
  float _232 = _218 - _227;
  float _238 = _218 - (_227 * 1.0717734098434448f);
  float _250 = paper_tex.SampleLevel(sampler_bilinear_wrap, float2((((_200 * _181) + (frame_consts.paper_xf[3].x)) * _197), (((_200 * _182) + (frame_consts.paper_xf[3].y)) * _197)), 0.0f);
  float _253 = paper_tex.SampleLevel(sampler_bilinear_wrap, float2((((_206 * _181) + (frame_consts.paper_xf[3].x)) * _199), (((_206 * _182) + (frame_consts.paper_xf[3].y)) * _199)), 0.0f);
  float _256 = paper_tex.SampleLevel(sampler_bilinear_wrap, float2((((_232 * _181) + (frame_consts.paper_xf[3].x)) * _229), (((_232 * _182) + (frame_consts.paper_xf[3].y)) * _229)), 0.0f);
  float _259 = paper_tex.SampleLevel(sampler_bilinear_wrap, float2((((_238 * _181) + (frame_consts.paper_xf[3].x)) * _231), (((_238 * _182) + (frame_consts.paper_xf[3].y)) * _231)), 0.0f);
  float _268 = ((((1.0f - (((1.0f - _193) * _186) * _250.x)) - ((_193 * _186) * _253.x)) - (((1.0f - _225) * frame_consts.game_plane_blend.y) * _256.x)) - ((_225 * frame_consts.game_plane_blend.y) * _259.x)) * frame_consts.paper_mult;
  float _283 = _16 / _17;
  float _295 = exp2(log2(saturate((frame_consts.params.vignette.intensity * abs(_26 + -0.5f)) * (((_283 + -1.0f) * frame_consts.params.vignette.rounded) + 1.0f))) * 5.0f);
  float _296 = exp2(log2(saturate(frame_consts.params.vignette.intensity * abs(_27 + -0.5f))) * 5.0f);
  float _302 = exp2(log2(saturate(1.0f - dot(float2(_295, _296), float2(_295, _296)))) * 6.0f);
  float _307 = 1.0f - _302;
  float _309 = 1.0f - (_307 * 0.8500000238418579f);
  float _316 = (_309 * ((_136 - (_268 * _136)) - frame_consts.params.vignette.color.x)) + frame_consts.params.vignette.color.x;
  float _317 = (_309 * ((_137 - (_268 * _137)) - frame_consts.params.vignette.color.y)) + frame_consts.params.vignette.color.y;
  float _318 = (_309 * ((_138 - (_268 * _138)) - frame_consts.params.vignette.color.z)) + frame_consts.params.vignette.color.z;
  float _322 = _26 * _16;
  float _323 = _27 * _17;
  float _324 = _323 + _322;
  float _330 = frac(_324 * 0.0033333334140479565f) + -0.5f;
  float _331 = frac((_323 - _322) * 0.0033333334140479565f) + -0.5f;
  float _337 = saturate(sqrt((_331 * _331) + (_330 * _330)) * 2.0f);
  float _348 = saturate((sin((_324 * 0.01666666753590107f) - (frame_consts.time * 0.8500000238418579f)) * 1.2500001192092896f) + -0.25000008940696716f);
  float _353 = ((_348 * _348) * 0.2199999988079071f) * (3.0f - (_348 * 2.0f));
  float _354 = _353 + 0.9777389168739319f;
  float _355 = ((_337 * 0.13274884223937988f) + 0.7175776362419128f) + _353;
  float _356 = ((_337 * 0.3335757553577423f) + 0.30871906876564026f) + _353;
  float _361 = (_26 * 1080.0f) * _283;
  float _362 = _27 * 1080.0f;
  float _363 = _361 * 0.04444444552063942f;
  float _364 = _27 * 27.712812423706055f;
  float _366 = ceil(_363 - _364);
  float _369 = floor(_27 * 55.42562484741211f) + 1.0f;
  float _372 = ceil((-0.0f - _364) - _363);
  float _374 = (_369 + _366) + _372;
  float _376 = (_374 * 22.5f) + -33.75f;
  float _377 = _366 - _372;
  float _379 = _377 * 11.25f;
  float _385 = (((_369 * 0.5773502588272095f) - (_366 * 0.28867512941360474f)) - (_372 * 0.28867512941360474f)) * 22.5f;
  float _388 = _376 + _379;
  float _389 = _385 + (19.485570907592773f - (_374 * 12.990381240844727f));
  float _392 = ((_374 * 25.980762481689453f) + -38.97114181518555f) + _385;
  float _393 = _379 - _376;
  float _394 = _388 - _361;
  float _395 = _389 - _362;
  float _398 = _379 - _361;
  float _399 = _392 - _362;
  float _404 = _395 * _395;
  float _411 = _393 - _361;
  float _415 = _389 * 2.5f;
  float _416 = frame_consts.time * 1.5f;
  float _420 = _389 * 0.004444444552063942f;
  float _421 = frame_consts.time * 0.15000000596046448f;
  float _422 = (_388 * 0.04444444552063942f) - _421;
  float _423 = _420 - _421;
  float _424 = frame_consts.time * 0.02500000037252903f;
  float _425 = dot(float3(_422, _423, _424), float3(0.3333333432674408f, 0.3333333432674408f, 0.3333333432674408f));
  float _429 = floor(_425 + _422);
  float _430 = floor(_425 + _423);
  float _431 = floor(_425 + _424);
  float _435 = dot(float3(_429, _430, _431), float3(0.1666666716337204f, 0.1666666716337204f, 0.1666666716337204f));
  float _436 = _435 + (_422 - _429);
  float _437 = _435 + (_423 - _430);
  float _438 = (_424 - _431) + _435;
  float _442 = select((_436 < _437), 0.0f, 1.0f);
  float _443 = select((_437 < _438), 0.0f, 1.0f);
  float _444 = select((_438 < _436), 0.0f, 1.0f);
  float _445 = 1.0f - _442;
  float _446 = 1.0f - _443;
  float _447 = 1.0f - _444;
  float _448 = min(_442, _447);
  float _449 = min(_443, _445);
  float _450 = min(_444, _446);
  float _451 = max(_442, _447);
  float _452 = max(_443, _445);
  float _453 = max(_444, _446);
  float _457 = (_436 - _448) + 0.1666666716337204f;
  float _458 = (_437 - _449) + 0.1666666716337204f;
  float _459 = (_438 - _450) + 0.1666666716337204f;
  float _463 = (_436 - _451) + 0.3333333432674408f;
  float _464 = (_437 - _452) + 0.3333333432674408f;
  float _465 = (_438 - _453) + 0.3333333432674408f;
  float _466 = _436 + -0.5f;
  float _467 = _437 + -0.5f;
  float _468 = _438 + -0.5f;
  float _478 = _429 - (floor(_429 * 0.0034602077212184668f) * 289.0f);
  float _479 = _430 - (floor(_430 * 0.0034602077212184668f) * 289.0f);
  float _480 = _431 - (floor(_431 * 0.0034602077212184668f) * 289.0f);
  float _481 = _480 + _450;
  float _482 = _480 + _453;
  float _483 = _480 + 1.0f;
  float _492 = ((_480 * 34.0f) + 1.0f) * _480;
  float _493 = ((_481 * 34.0f) + 1.0f) * _481;
  float _494 = ((_482 * 34.0f) + 1.0f) * _482;
  float _495 = ((_483 * 34.0f) + 1.0f) * _483;
  float _509 = (_492 - (floor(_492 * 0.0034602077212184668f) * 289.0f)) + _479;
  float _512 = ((_479 + _449) - (floor(_493 * 0.0034602077212184668f) * 289.0f)) + _493;
  float _515 = ((_479 + _452) - (floor(_494 * 0.0034602077212184668f) * 289.0f)) + _494;
  float _518 = ((_479 + 1.0f) - (floor(_495 * 0.0034602077212184668f) * 289.0f)) + _495;
  float _527 = ((_509 * 34.0f) + 1.0f) * _509;
  float _528 = ((_512 * 34.0f) + 1.0f) * _512;
  float _529 = ((_515 * 34.0f) + 1.0f) * _515;
  float _530 = ((_518 * 34.0f) + 1.0f) * _518;
  float _544 = (_527 - (floor(_527 * 0.0034602077212184668f) * 289.0f)) + _478;
  float _547 = ((_478 + _448) - (floor(_528 * 0.0034602077212184668f) * 289.0f)) + _528;
  float _550 = ((_478 + _451) - (floor(_529 * 0.0034602077212184668f) * 289.0f)) + _529;
  float _553 = ((_478 + 1.0f) - (floor(_530 * 0.0034602077212184668f) * 289.0f)) + _530;
  float _562 = ((_544 * 34.0f) + 1.0f) * _544;
  float _563 = ((_547 * 34.0f) + 1.0f) * _547;
  float _564 = ((_550 * 34.0f) + 1.0f) * _550;
  float _565 = ((_553 * 34.0f) + 1.0f) * _553;
  float _578 = _562 - (floor(_562 * 0.0034602077212184668f) * 289.0f);
  float _579 = _563 - (floor(_563 * 0.0034602077212184668f) * 289.0f);
  float _580 = _564 - (floor(_564 * 0.0034602077212184668f) * 289.0f);
  float _581 = _565 - (floor(_565 * 0.0034602077212184668f) * 289.0f);
  float _594 = _578 - (floor(_578 * 0.020408164709806442f) * 49.0f);
  float _595 = _579 - (floor(_579 * 0.020408164709806442f) * 49.0f);
  float _596 = _580 - (floor(_580 * 0.020408164709806442f) * 49.0f);
  float _597 = _581 - (floor(_581 * 0.020408164709806442f) * 49.0f);
  float _602 = floor(_594 * 0.1428571492433548f);
  float _603 = floor(_595 * 0.1428571492433548f);
  float _604 = floor(_596 * 0.1428571492433548f);
  float _605 = floor(_597 * 0.1428571492433548f);
  float _622 = (_602 * 0.2857142984867096f) + -0.9285714030265808f;
  float _623 = (_603 * 0.2857142984867096f) + -0.9285714030265808f;
  float _624 = (_604 * 0.2857142984867096f) + -0.9285714030265808f;
  float _625 = (_605 * 0.2857142984867096f) + -0.9285714030265808f;
  float _630 = (floor(_594 - (_602 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _631 = (floor(_595 - (_603 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _632 = (floor(_596 - (_604 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _633 = (floor(_597 - (_605 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _646 = (1.0f - abs(_622)) - abs(_630);
  float _647 = (1.0f - abs(_623)) - abs(_631);
  float _648 = (1.0f - abs(_624)) - abs(_632);
  float _649 = (1.0f - abs(_625)) - abs(_633);
  float _678 = select((_646 > 0.0f), -0.0f, -1.0f);
  float _679 = select((_647 > 0.0f), -0.0f, -1.0f);
  float _680 = select((_648 > 0.0f), -0.0f, -1.0f);
  float _681 = select((_649 > 0.0f), -0.0f, -1.0f);
  float _686 = (((floor(_622) * 2.0f) + 1.0f) * _678) + _622;
  float _687 = (((floor(_630) * 2.0f) + 1.0f) * _678) + _630;
  float _688 = (((floor(_623) * 2.0f) + 1.0f) * _679) + _623;
  float _689 = (((floor(_631) * 2.0f) + 1.0f) * _679) + _631;
  float _694 = (((floor(_624) * 2.0f) + 1.0f) * _680) + _624;
  float _695 = (((floor(_632) * 2.0f) + 1.0f) * _680) + _632;
  float _696 = (((floor(_625) * 2.0f) + 1.0f) * _681) + _625;
  float _697 = (((floor(_633) * 2.0f) + 1.0f) * _681) + _633;
  float _706 = 1.7928400039672852f - (dot(float3(_686, _687, _646), float3(_686, _687, _646)) * 0.8537350296974182f);
  float _707 = 1.7928400039672852f - (dot(float3(_688, _689, _647), float3(_688, _689, _647)) * 0.8537350296974182f);
  float _708 = 1.7928400039672852f - (dot(float3(_694, _695, _648), float3(_694, _695, _648)) * 0.8537350296974182f);
  float _709 = 1.7928400039672852f - (dot(float3(_696, _697, _649), float3(_696, _697, _649)) * 0.8537350296974182f);
  float _730 = max((0.6000000238418579f - dot(float3(_436, _437, _438), float3(_436, _437, _438))), 0.0f);
  float _731 = max((0.6000000238418579f - dot(float3(_457, _458, _459), float3(_457, _458, _459))), 0.0f);
  float _732 = max((0.6000000238418579f - dot(float3(_463, _464, _465), float3(_463, _464, _465))), 0.0f);
  float _733 = max((0.6000000238418579f - dot(float3(_466, _467, _468), float3(_466, _467, _468))), 0.0f);
  float _734 = _730 * _730;
  float _735 = _731 * _731;
  float _736 = _732 * _732;
  float _737 = _733 * _733;
  float _752 = saturate((((sin(_415 - _416) * 0.15000000596046448f) + 0.050000011920928955f) + (dot(float4((_734 * _734), (_735 * _735), (_736 * _736), (_737 * _737)), float4(dot(float3((_706 * _686), (_706 * _687), (_706 * _646)), float3(_436, _437, _438)), dot(float3((_707 * _688), (_707 * _689), (_707 * _647)), float3(_457, _458, _459)), dot(float3((_708 * _694), (_708 * _695), (_708 * _648)), float3(_463, _464, _465)), dot(float3((_709 * _696), (_709 * _697), (_709 * _649)), float3(_466, _467, _468)))) * 21.0f)) * 4.0f);
  float _756 = (_752 * _752) * (3.0f - (_752 * 2.0f));
  float _758 = (_756 * 0.6499999761581421f) + 0.3499999940395355f;
  float _763 = (_377 * 0.5f) - _421;
  float _764 = (_392 * 0.004444444552063942f) - _421;
  float _765 = dot(float3(_763, _764, _424), float3(0.3333333432674408f, 0.3333333432674408f, 0.3333333432674408f));
  float _769 = floor(_765 + _763);
  float _770 = floor(_765 + _764);
  float _771 = floor(_765 + _424);
  float _775 = dot(float3(_769, _770, _771), float3(0.1666666716337204f, 0.1666666716337204f, 0.1666666716337204f));
  float _776 = _775 + (_763 - _769);
  float _777 = _775 + (_764 - _770);
  float _778 = (_424 - _771) + _775;
  float _782 = select((_776 < _777), 0.0f, 1.0f);
  float _783 = select((_777 < _778), 0.0f, 1.0f);
  float _784 = select((_778 < _776), 0.0f, 1.0f);
  float _785 = 1.0f - _782;
  float _786 = 1.0f - _783;
  float _787 = 1.0f - _784;
  float _788 = min(_782, _787);
  float _789 = min(_783, _785);
  float _790 = min(_784, _786);
  float _791 = max(_782, _787);
  float _792 = max(_783, _785);
  float _793 = max(_784, _786);
  float _797 = (_776 - _788) + 0.1666666716337204f;
  float _798 = (_777 - _789) + 0.1666666716337204f;
  float _799 = (_778 - _790) + 0.1666666716337204f;
  float _803 = (_776 - _791) + 0.3333333432674408f;
  float _804 = (_777 - _792) + 0.3333333432674408f;
  float _805 = (_778 - _793) + 0.3333333432674408f;
  float _806 = _776 + -0.5f;
  float _807 = _777 + -0.5f;
  float _808 = _778 + -0.5f;
  float _818 = _769 - (floor(_769 * 0.0034602077212184668f) * 289.0f);
  float _819 = _770 - (floor(_770 * 0.0034602077212184668f) * 289.0f);
  float _820 = _771 - (floor(_771 * 0.0034602077212184668f) * 289.0f);
  float _821 = _820 + _790;
  float _822 = _820 + _793;
  float _823 = _820 + 1.0f;
  float _832 = ((_820 * 34.0f) + 1.0f) * _820;
  float _833 = ((_821 * 34.0f) + 1.0f) * _821;
  float _834 = ((_822 * 34.0f) + 1.0f) * _822;
  float _835 = ((_823 * 34.0f) + 1.0f) * _823;
  float _849 = (_832 - (floor(_832 * 0.0034602077212184668f) * 289.0f)) + _819;
  float _852 = ((_819 + _789) - (floor(_833 * 0.0034602077212184668f) * 289.0f)) + _833;
  float _855 = ((_819 + _792) - (floor(_834 * 0.0034602077212184668f) * 289.0f)) + _834;
  float _858 = ((_819 + 1.0f) - (floor(_835 * 0.0034602077212184668f) * 289.0f)) + _835;
  float _867 = ((_849 * 34.0f) + 1.0f) * _849;
  float _868 = ((_852 * 34.0f) + 1.0f) * _852;
  float _869 = ((_855 * 34.0f) + 1.0f) * _855;
  float _870 = ((_858 * 34.0f) + 1.0f) * _858;
  float _884 = (_867 - (floor(_867 * 0.0034602077212184668f) * 289.0f)) + _818;
  float _887 = ((_818 + _788) - (floor(_868 * 0.0034602077212184668f) * 289.0f)) + _868;
  float _890 = ((_818 + _791) - (floor(_869 * 0.0034602077212184668f) * 289.0f)) + _869;
  float _893 = ((_818 + 1.0f) - (floor(_870 * 0.0034602077212184668f) * 289.0f)) + _870;
  float _902 = ((_884 * 34.0f) + 1.0f) * _884;
  float _903 = ((_887 * 34.0f) + 1.0f) * _887;
  float _904 = ((_890 * 34.0f) + 1.0f) * _890;
  float _905 = ((_893 * 34.0f) + 1.0f) * _893;
  float _918 = _902 - (floor(_902 * 0.0034602077212184668f) * 289.0f);
  float _919 = _903 - (floor(_903 * 0.0034602077212184668f) * 289.0f);
  float _920 = _904 - (floor(_904 * 0.0034602077212184668f) * 289.0f);
  float _921 = _905 - (floor(_905 * 0.0034602077212184668f) * 289.0f);
  float _934 = _918 - (floor(_918 * 0.020408164709806442f) * 49.0f);
  float _935 = _919 - (floor(_919 * 0.020408164709806442f) * 49.0f);
  float _936 = _920 - (floor(_920 * 0.020408164709806442f) * 49.0f);
  float _937 = _921 - (floor(_921 * 0.020408164709806442f) * 49.0f);
  float _942 = floor(_934 * 0.1428571492433548f);
  float _943 = floor(_935 * 0.1428571492433548f);
  float _944 = floor(_936 * 0.1428571492433548f);
  float _945 = floor(_937 * 0.1428571492433548f);
  float _962 = (_942 * 0.2857142984867096f) + -0.9285714030265808f;
  float _963 = (_943 * 0.2857142984867096f) + -0.9285714030265808f;
  float _964 = (_944 * 0.2857142984867096f) + -0.9285714030265808f;
  float _965 = (_945 * 0.2857142984867096f) + -0.9285714030265808f;
  float _970 = (floor(_934 - (_942 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _971 = (floor(_935 - (_943 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _972 = (floor(_936 - (_944 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _973 = (floor(_937 - (_945 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _986 = (1.0f - abs(_962)) - abs(_970);
  float _987 = (1.0f - abs(_963)) - abs(_971);
  float _988 = (1.0f - abs(_964)) - abs(_972);
  float _989 = (1.0f - abs(_965)) - abs(_973);
  float _1018 = select((_986 > 0.0f), -0.0f, -1.0f);
  float _1019 = select((_987 > 0.0f), -0.0f, -1.0f);
  float _1020 = select((_988 > 0.0f), -0.0f, -1.0f);
  float _1021 = select((_989 > 0.0f), -0.0f, -1.0f);
  float _1026 = (((floor(_962) * 2.0f) + 1.0f) * _1018) + _962;
  float _1027 = (((floor(_970) * 2.0f) + 1.0f) * _1018) + _970;
  float _1028 = (((floor(_963) * 2.0f) + 1.0f) * _1019) + _963;
  float _1029 = (((floor(_971) * 2.0f) + 1.0f) * _1019) + _971;
  float _1034 = (((floor(_964) * 2.0f) + 1.0f) * _1020) + _964;
  float _1035 = (((floor(_972) * 2.0f) + 1.0f) * _1020) + _972;
  float _1036 = (((floor(_965) * 2.0f) + 1.0f) * _1021) + _965;
  float _1037 = (((floor(_973) * 2.0f) + 1.0f) * _1021) + _973;
  float _1046 = 1.7928400039672852f - (dot(float3(_1026, _1027, _986), float3(_1026, _1027, _986)) * 0.8537350296974182f);
  float _1047 = 1.7928400039672852f - (dot(float3(_1028, _1029, _987), float3(_1028, _1029, _987)) * 0.8537350296974182f);
  float _1048 = 1.7928400039672852f - (dot(float3(_1034, _1035, _988), float3(_1034, _1035, _988)) * 0.8537350296974182f);
  float _1049 = 1.7928400039672852f - (dot(float3(_1036, _1037, _989), float3(_1036, _1037, _989)) * 0.8537350296974182f);
  float _1070 = max((0.6000000238418579f - dot(float3(_776, _777, _778), float3(_776, _777, _778))), 0.0f);
  float _1071 = max((0.6000000238418579f - dot(float3(_797, _798, _799), float3(_797, _798, _799))), 0.0f);
  float _1072 = max((0.6000000238418579f - dot(float3(_803, _804, _805), float3(_803, _804, _805))), 0.0f);
  float _1073 = max((0.6000000238418579f - dot(float3(_806, _807, _808), float3(_806, _807, _808))), 0.0f);
  float _1074 = _1070 * _1070;
  float _1075 = _1071 * _1071;
  float _1076 = _1072 * _1072;
  float _1077 = _1073 * _1073;
  float _1092 = saturate((((sin((_392 * 2.5f) - _416) * 0.15000000596046448f) + 0.050000011920928955f) + (dot(float4((_1074 * _1074), (_1075 * _1075), (_1076 * _1076), (_1077 * _1077)), float4(dot(float3((_1046 * _1026), (_1046 * _1027), (_1046 * _986)), float3(_776, _777, _778)), dot(float3((_1047 * _1028), (_1047 * _1029), (_1047 * _987)), float3(_797, _798, _799)), dot(float3((_1048 * _1034), (_1048 * _1035), (_1048 * _988)), float3(_803, _804, _805)), dot(float3((_1049 * _1036), (_1049 * _1037), (_1049 * _989)), float3(_806, _807, _808)))) * 21.0f)) * 4.0f);
  float _1096 = (_1092 * _1092) * (3.0f - (_1092 * 2.0f));
  float _1098 = (_1096 * 0.6499999761581421f) + 0.3499999940395355f;
  float _1105 = frame_consts.time * 0.15000000596046448f;
  float _1106 = (_393 * 0.04444444552063942f) - _1105;
  float _1107 = _420 - _1105;
  float _1108 = frame_consts.time * 0.02500000037252903f;
  float _1109 = dot(float3(_1106, _1107, _1108), float3(0.3333333432674408f, 0.3333333432674408f, 0.3333333432674408f));
  float _1113 = floor(_1106 + _1109);
  float _1114 = floor(_1107 + _1109);
  float _1115 = floor(_1108 + _1109);
  float _1119 = dot(float3(_1113, _1114, _1115), float3(0.1666666716337204f, 0.1666666716337204f, 0.1666666716337204f));
  float _1120 = _1119 + (_1106 - _1113);
  float _1121 = _1119 + (_1107 - _1114);
  float _1122 = (_1108 - _1115) + _1119;
  float _1126 = select((_1120 < _1121), 0.0f, 1.0f);
  float _1127 = select((_1121 < _1122), 0.0f, 1.0f);
  float _1128 = select((_1122 < _1120), 0.0f, 1.0f);
  float _1129 = 1.0f - _1126;
  float _1130 = 1.0f - _1127;
  float _1131 = 1.0f - _1128;
  float _1132 = min(_1126, _1131);
  float _1133 = min(_1127, _1129);
  float _1134 = min(_1128, _1130);
  float _1135 = max(_1126, _1131);
  float _1136 = max(_1127, _1129);
  float _1137 = max(_1128, _1130);
  float _1141 = (_1120 - _1132) + 0.1666666716337204f;
  float _1142 = (_1121 - _1133) + 0.1666666716337204f;
  float _1143 = (_1122 - _1134) + 0.1666666716337204f;
  float _1147 = (_1120 - _1135) + 0.3333333432674408f;
  float _1148 = (_1121 - _1136) + 0.3333333432674408f;
  float _1149 = (_1122 - _1137) + 0.3333333432674408f;
  float _1150 = _1120 + -0.5f;
  float _1151 = _1121 + -0.5f;
  float _1152 = _1122 + -0.5f;
  float _1162 = _1113 - (floor(_1113 * 0.0034602077212184668f) * 289.0f);
  float _1163 = _1114 - (floor(_1114 * 0.0034602077212184668f) * 289.0f);
  float _1164 = _1115 - (floor(_1115 * 0.0034602077212184668f) * 289.0f);
  float _1165 = _1164 + _1134;
  float _1166 = _1164 + _1137;
  float _1167 = _1164 + 1.0f;
  float _1176 = ((_1164 * 34.0f) + 1.0f) * _1164;
  float _1177 = ((_1165 * 34.0f) + 1.0f) * _1165;
  float _1178 = ((_1166 * 34.0f) + 1.0f) * _1166;
  float _1179 = ((_1167 * 34.0f) + 1.0f) * _1167;
  float _1193 = (_1176 - (floor(_1176 * 0.0034602077212184668f) * 289.0f)) + _1163;
  float _1196 = ((_1163 + _1133) - (floor(_1177 * 0.0034602077212184668f) * 289.0f)) + _1177;
  float _1199 = ((_1163 + _1136) - (floor(_1178 * 0.0034602077212184668f) * 289.0f)) + _1178;
  float _1202 = ((_1163 + 1.0f) - (floor(_1179 * 0.0034602077212184668f) * 289.0f)) + _1179;
  float _1211 = ((_1193 * 34.0f) + 1.0f) * _1193;
  float _1212 = ((_1196 * 34.0f) + 1.0f) * _1196;
  float _1213 = ((_1199 * 34.0f) + 1.0f) * _1199;
  float _1214 = ((_1202 * 34.0f) + 1.0f) * _1202;
  float _1228 = (_1211 - (floor(_1211 * 0.0034602077212184668f) * 289.0f)) + _1162;
  float _1231 = ((_1162 + _1132) - (floor(_1212 * 0.0034602077212184668f) * 289.0f)) + _1212;
  float _1234 = ((_1162 + _1135) - (floor(_1213 * 0.0034602077212184668f) * 289.0f)) + _1213;
  float _1237 = ((_1162 + 1.0f) - (floor(_1214 * 0.0034602077212184668f) * 289.0f)) + _1214;
  float _1246 = ((_1228 * 34.0f) + 1.0f) * _1228;
  float _1247 = ((_1231 * 34.0f) + 1.0f) * _1231;
  float _1248 = ((_1234 * 34.0f) + 1.0f) * _1234;
  float _1249 = ((_1237 * 34.0f) + 1.0f) * _1237;
  float _1262 = _1246 - (floor(_1246 * 0.0034602077212184668f) * 289.0f);
  float _1263 = _1247 - (floor(_1247 * 0.0034602077212184668f) * 289.0f);
  float _1264 = _1248 - (floor(_1248 * 0.0034602077212184668f) * 289.0f);
  float _1265 = _1249 - (floor(_1249 * 0.0034602077212184668f) * 289.0f);
  float _1278 = _1262 - (floor(_1262 * 0.020408164709806442f) * 49.0f);
  float _1279 = _1263 - (floor(_1263 * 0.020408164709806442f) * 49.0f);
  float _1280 = _1264 - (floor(_1264 * 0.020408164709806442f) * 49.0f);
  float _1281 = _1265 - (floor(_1265 * 0.020408164709806442f) * 49.0f);
  float _1286 = floor(_1278 * 0.1428571492433548f);
  float _1287 = floor(_1279 * 0.1428571492433548f);
  float _1288 = floor(_1280 * 0.1428571492433548f);
  float _1289 = floor(_1281 * 0.1428571492433548f);
  float _1306 = (_1286 * 0.2857142984867096f) + -0.9285714030265808f;
  float _1307 = (_1287 * 0.2857142984867096f) + -0.9285714030265808f;
  float _1308 = (_1288 * 0.2857142984867096f) + -0.9285714030265808f;
  float _1309 = (_1289 * 0.2857142984867096f) + -0.9285714030265808f;
  float _1314 = (floor(_1278 - (_1286 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _1315 = (floor(_1279 - (_1287 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _1316 = (floor(_1280 - (_1288 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _1317 = (floor(_1281 - (_1289 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _1330 = (1.0f - abs(_1306)) - abs(_1314);
  float _1331 = (1.0f - abs(_1307)) - abs(_1315);
  float _1332 = (1.0f - abs(_1308)) - abs(_1316);
  float _1333 = (1.0f - abs(_1309)) - abs(_1317);
  float _1362 = select((_1330 > 0.0f), -0.0f, -1.0f);
  float _1363 = select((_1331 > 0.0f), -0.0f, -1.0f);
  float _1364 = select((_1332 > 0.0f), -0.0f, -1.0f);
  float _1365 = select((_1333 > 0.0f), -0.0f, -1.0f);
  float _1370 = (((floor(_1306) * 2.0f) + 1.0f) * _1362) + _1306;
  float _1371 = (((floor(_1314) * 2.0f) + 1.0f) * _1362) + _1314;
  float _1372 = (((floor(_1307) * 2.0f) + 1.0f) * _1363) + _1307;
  float _1373 = (((floor(_1315) * 2.0f) + 1.0f) * _1363) + _1315;
  float _1378 = (((floor(_1308) * 2.0f) + 1.0f) * _1364) + _1308;
  float _1379 = (((floor(_1316) * 2.0f) + 1.0f) * _1364) + _1316;
  float _1380 = (((floor(_1309) * 2.0f) + 1.0f) * _1365) + _1309;
  float _1381 = (((floor(_1317) * 2.0f) + 1.0f) * _1365) + _1317;
  float _1390 = 1.7928400039672852f - (dot(float3(_1370, _1371, _1330), float3(_1370, _1371, _1330)) * 0.8537350296974182f);
  float _1391 = 1.7928400039672852f - (dot(float3(_1372, _1373, _1331), float3(_1372, _1373, _1331)) * 0.8537350296974182f);
  float _1392 = 1.7928400039672852f - (dot(float3(_1378, _1379, _1332), float3(_1378, _1379, _1332)) * 0.8537350296974182f);
  float _1393 = 1.7928400039672852f - (dot(float3(_1380, _1381, _1333), float3(_1380, _1381, _1333)) * 0.8537350296974182f);
  float _1414 = max((0.6000000238418579f - dot(float3(_1120, _1121, _1122), float3(_1120, _1121, _1122))), 0.0f);
  float _1415 = max((0.6000000238418579f - dot(float3(_1141, _1142, _1143), float3(_1141, _1142, _1143))), 0.0f);
  float _1416 = max((0.6000000238418579f - dot(float3(_1147, _1148, _1149), float3(_1147, _1148, _1149))), 0.0f);
  float _1417 = max((0.6000000238418579f - dot(float3(_1150, _1151, _1152), float3(_1150, _1151, _1152))), 0.0f);
  float _1418 = _1414 * _1414;
  float _1419 = _1415 * _1415;
  float _1420 = _1416 * _1416;
  float _1421 = _1417 * _1417;
  float _1436 = saturate((((sin(_415 - (frame_consts.time * 1.5f)) * 0.15000000596046448f) + 0.050000011920928955f) + (dot(float4((_1418 * _1418), (_1419 * _1419), (_1420 * _1420), (_1421 * _1421)), float4(dot(float3((_1390 * _1370), (_1390 * _1371), (_1390 * _1330)), float3(_1120, _1121, _1122)), dot(float3((_1391 * _1372), (_1391 * _1373), (_1391 * _1331)), float3(_1141, _1142, _1143)), dot(float3((_1392 * _1378), (_1392 * _1379), (_1392 * _1332)), float3(_1147, _1148, _1149)), dot(float3((_1393 * _1380), (_1393 * _1381), (_1393 * _1333)), float3(_1150, _1151, _1152)))) * 21.0f)) * 4.0f);
  float _1440 = (_1436 * _1436) * (3.0f - (_1436 * 2.0f));
  float _1442 = (_1440 * 0.6499999761581421f) + 0.3499999940395355f;
  float _1464 = saturate(_758);
  float _1465 = saturate(_1098);
  float _1487 = (((_302 * 1.2000000476837158f) * _307) * frame_consts.params.vignette.golden_intensity) * ((((saturate(11.0f - (sqrt((_399 * _399) + (_398 * _398)) / ((_1096 * 0.039000000804662704f) + 0.08100000768899918f))) * _1098) + (saturate(11.0f - (sqrt((_394 * _394) + _404) / ((_756 * 0.039000000804662704f) + 0.08100000768899918f))) * _758)) + (saturate(11.0f - (sqrt((_411 * _411) + _404) / ((_1440 * 0.039000000804662704f) + 0.08100000768899918f))) * _1442)) + (((((saturate(1.0f - (abs(_395) * 0.8333333134651184f)) * _1464) + (saturate(1.0f - (abs(dot(float2(_398, _399), float2(-0.8660253882408142f, 0.5f))) * 0.8333333134651184f)) * _1465)) * saturate(_1442)) + ((_1464 * saturate(1.0f - (abs(dot(float2(_394, _395), float2(0.8660253882408142f, 0.5f))) * 0.8333333134651184f))) * _1465)) * 0.5f));
  SV_Target.x = ((_1487 * ((_354 * _354) - _316)) + _316);
  SV_Target.y = ((_1487 * ((_355 * _355) - _317)) + _317);
  SV_Target.z = ((_1487 * ((_356 * _356) - _318)) + _318);
  if (RENODX_TONE_MAP_TYPE) {
    SV_Target.rgb = renodx::draw::ToneMapPass(_28.rgb, SV_Target.rgb);
  } else {
    SV_Target.rgb = saturate(SV_Target.rgb);
  }
  SV_Target.rgb = renodx::draw::RenderIntermediatePass(SV_Target.rgb);

  SV_Target.w = 1.0f;
  return SV_Target;
}
