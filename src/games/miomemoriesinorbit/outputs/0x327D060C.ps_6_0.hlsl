#include "../shared.h"

struct Lod_params {
  struct Lod_brush_params {
    float4 brush_uv[4];
    float base_radius;
    float radius_variation;
    float radius_random;
    float blur;
    float alpha;
    float stretch;
  } brushes;
  struct Lod_noise_params {
    float chaos;
    float freq;
    float brightness;
    float saturation;
    float hue;
  } noise;
  struct Lod_outlines_params {
    float2 thickness;
    float2 softness;
    float2 displacement;
    float2 attenuation;
    float lighting_threshold;
    float lighting_threshold_softness;
    float2 lighting_dark;
    float2 lighting_bright;
    float2 discretion;
    float2 alpha;
  } outlines;
};

struct Frame_constants {
  float3 cam_world_pos;
  float time;
  float2 inv_near_dim;
  float proj_scale;
  uint flags;
  float2 half_vp_dim;
  int2 vp_dim;
  float2 vp_texel_size;
  int2 mouse_pos;
  int2 inspected_pix;
  int2 hi_z_0_dim;
  int supersampling;
  int debug_patches;
  int use_patches;
  int emissive;
  float3 target;
  uint frame_number;
  uint shot_frame_number;
  float dt;
  float4 view_to_world[4];
  float4 world_to_view[4];
  float4 view_ndc[4];
  float4 world_ndc[4];
  float4 prev_world_ndc[4];
  float4 ndc_world[4];
  float4 ndc_to_prev_ndc[4];
  float4 prev_ndc_to_ndc[4];
  float4 view_world_z0;
  float4 pix_to_fog_eq;
  float3 mio_view;
  float3 mio_hair_outline_color;
  float mio_foliage_velocity;
  int show_wireframe;
  int ao;
  int glitch;
  int no_vertex_color;
  float paper_mult;
  int hatching;
  int mio_halo;
  int vol_temporal;
  int heart_attack_active;
  int heart_attack_secondary_target;
  int triangular_dissolve_enabled;
  int color_correct;
  float starfield_effect_amount;
  float starfield_fade_amount;
  float3 starfield_center_view;
  float starfield_glow_amount;
  float starfield_pulse_t;
  float death_anim_t;
  float3 game_plane_world_origin;
  float3 game_plane_world_normal;
  float3 game_plane_world_u;
  float3 game_plane_world_v;
  float4 game_plane_transform[4];
  float4 hatching_xf[4];
  float4 paper_xf[4];
  float2 game_plane_blend;
  float heart_attack_t;
  float heart_attack_duration;
  float heart_attack_pulse;
  float heart_attack_outline_distance;
  float heart_attack_dissolve_distance;
  float3 heart_attack_dissolve_color;
  float heart_attack_dissolve_base;
  float heart_attack_dissolve_mult;
  float3 heart_attack_dissolve_world_center;
  float heart_attack_vertical_dissolve;
  float triangular_dissolve_base_amount;
  float triangular_dissolve_amount;
  float flashback_lut;
  float evil_mio;
  float dead_mio;
  float godlike_mio;
  float khlia_pulse_t;
  float khlia__pulse_t;
  float khlia_pulse_period;
  float3 khlia_world_pos;
  float skydome_rotation_offset;
  float hatch_ambiant_mul;
  float hatch_ambiant_add;
  float glitch_scale;
  uint max_contours;
  uint max_contour_loops;
  int death_screen;
  float death_screen_t;
  int poetic_death_screen;
  float poetic_death_screen_t;
  float tremor_pulse_t;
  int invert;
  float surface_fade;
  struct Postprocess_params {
    struct AO_params {
      float3 color;
      float intensity;
    } ao;
    struct Fog_params {
      float bloom_factor;
      float space;
      float outline_density;
      float outline_attenuation;
    } fog;
    struct Ambient_light_params {
      int undercoat_grad;
      float3 color;
      float intensity;
      float gameplay_intensity;
      float gameplay_width;
      float directional_intensity;
      float directional_shadows;
      float undercoat_noise_freq;
      float undercoat_noise_amplitude;
      float undercoat_noise_threshold;
      float undercoating;
    } ambient_light;
    struct Vignette_params {
      float intensity;
      float rounded;
      float3 color;
      float golden_intensity;
      float golden_color;
    } vignette;
    struct Bloom_params {
      float intensity;
      float threshold_low;
      float threshold_high;
    } bloom;
    struct Mio_params {
      float light_intensity;
      float light_radius;
      float3 light_color;
      float spec_intensity;
      float3 halo_color;
      float halo_intensity;
    } mio;
    struct Particles_params {
      uint count;
      float cam_near;
      float cam_far;
      float fadeoff_near;
      float2 lifetime;
      float fadein_duration;
      float fadeoff_duration;
      float2 alpha;
      float2 scale;
      float2 speed;
      int gradient;
      float circle_attenuation;
    } particles;
    struct Chroma_aberration_params {
      float intensity;
    } chroma_aberration;
    struct Fade_params {
      float intensity;
      float3 color;
    } fade;
    struct Dof_params {
      float plane_01;
      float plane_01_softness;
      float plane_12;
      float plane_12_softness;
      float foreground;
      float foreground_softness;
    } dof;
    Lod_params lod_foreground;
    Lod_params lod_game;
    Lod_params lod_midground;
    Lod_params lod_background;
  } params;
};


Texture2D<float4> tex : register(t0);

Texture2D<float> depth_tex : register(t1);

Texture2D<float2> distortion : register(t4);

Texture2D<float> paper_tex : register(t5);

Texture2D<float3> bloom_tex : register(t7);

cbuffer frame_consts : register(b0) {
  Frame_constants frame_consts : packoffset(c000.x);
};

SamplerState sampler_nearest : register(s0);

SamplerState sampler_bilinear : register(s1);

SamplerState sampler_bilinear_wrap : register(s2);

float4 main(
  noperspective float4 SV_Position : SV_Position,
  linear float2 O_Uv : O_Uv
) : SV_Target {
  float4 SV_Target;
  float _15 = float((int)(frame_consts.vp_dim.x));
  float _16 = float((int)(frame_consts.vp_dim.y));
  float2 _17 = distortion.SampleLevel(sampler_nearest, float2(O_Uv.x, O_Uv.y), 0.0f);
  float _20 = _16 / _15;
  float _25 = saturate((_17.x * _20) + O_Uv.x);
  float _26 = saturate((_17.y * _20) + O_Uv.y);
  float4 _27 = tex.SampleLevel(sampler_nearest, float2(_25, _26), 0.0f);
  float3 _31 = bloom_tex.SampleLevel(sampler_bilinear, float2(_25, _26), 0.0f);
  float _46 = max((((1.0f - (_27.y * 0.7152000069618225f)) - (_27.x * 0.2125999927520752f)) - (_27.z * 0.0722000002861023f)), 0.0010000000474974513f);
  float _50 = (_27.x / _46) + (frame_consts.params.bloom.intensity * _31.x);
  float _51 = (_27.y / _46) + (frame_consts.params.bloom.intensity * _31.y);
  float _52 = (_27.z / _46) + (frame_consts.params.bloom.intensity * _31.z);
  float _58 = (((_50 * 0.2125999927520752f) + 1.0f) + (_51 * 0.7152000069618225f)) + (_52 * 0.0722000002861023f);
  float _62 = saturate(_50 / _58);
  float _63 = saturate(_51 / _58);
  float _64 = saturate(_52 / _58);
  float _70 = depth_tex.SampleLevel(sampler_nearest, float2(_25, _26), 0.0f);
  float _74 = 10000.0f / ((_70.x * 19999.5f) + 0.5f);
  float _79 = (_74 * ((_25 * 2.0f) + -1.0f)) * frame_consts.inv_near_dim.x;
  float _81 = (_74 * (((1.0f - _26) * 2.0f) + -1.0f)) * frame_consts.inv_near_dim.y;
  float _82 = -0.0f - _74;
  float _106 = mad((frame_consts.paper_xf[2].z), _82, mad((frame_consts.paper_xf[1].z), _81, (_79 * (frame_consts.paper_xf[0].z))));
  float _107 = mad((frame_consts.paper_xf[2].x), _82, mad((frame_consts.paper_xf[1].x), _81, (_79 * (frame_consts.paper_xf[0].x)))) / _106;
  float _108 = mad((frame_consts.paper_xf[2].y), _82, mad((frame_consts.paper_xf[1].y), _81, (_79 * (frame_consts.paper_xf[0].y)))) / _106;
  float _112 = 1.0f - frame_consts.game_plane_blend.y;
  float _117 = log2(max(5.0f, (-0.0f - (_106 - frame_consts.game_plane_blend.x)))) * 10.0f;
  float _118 = floor(_117);
  float _119 = _117 - _118;
  float _121 = exp2(_118 * 0.10000000149011612f);
  float _122 = 1.0f / _121;
  float _123 = min(_122, 0.20000000298023224f);
  float _125 = min((_122 * 0.9330329895019531f), 0.20000000298023224f);
  float _126 = frame_consts.game_plane_blend.x - _121;
  float _132 = frame_consts.game_plane_blend.x - (_121 * 1.0717734098434448f);
  float _144 = frame_consts.game_plane_blend.x + 10.0f;
  float _149 = log2(max(5.0f, (-0.0f - (_106 - _144)))) * 10.0f;
  float _150 = floor(_149);
  float _151 = _149 - _150;
  float _153 = exp2(_150 * 0.10000000149011612f);
  float _154 = 1.0f / _153;
  float _155 = min(_154, 0.20000000298023224f);
  float _157 = min((_154 * 0.9330329895019531f), 0.20000000298023224f);
  float _158 = _144 - _153;
  float _164 = _144 - (_153 * 1.0717734098434448f);
  float _176 = paper_tex.SampleLevel(sampler_bilinear_wrap, float2((((_126 * _107) + (frame_consts.paper_xf[3].x)) * _123), (((_126 * _108) + (frame_consts.paper_xf[3].y)) * _123)), 0.0f);
  float _179 = paper_tex.SampleLevel(sampler_bilinear_wrap, float2((((_132 * _107) + (frame_consts.paper_xf[3].x)) * _125), (((_132 * _108) + (frame_consts.paper_xf[3].y)) * _125)), 0.0f);
  float _182 = paper_tex.SampleLevel(sampler_bilinear_wrap, float2((((_158 * _107) + (frame_consts.paper_xf[3].x)) * _155), (((_158 * _108) + (frame_consts.paper_xf[3].y)) * _155)), 0.0f);
  float _185 = paper_tex.SampleLevel(sampler_bilinear_wrap, float2((((_164 * _107) + (frame_consts.paper_xf[3].x)) * _157), (((_164 * _108) + (frame_consts.paper_xf[3].y)) * _157)), 0.0f);
  float _194 = ((((1.0f - (((1.0f - _119) * _112) * _176.x)) - ((_119 * _112) * _179.x)) - (((1.0f - _151) * frame_consts.game_plane_blend.y) * _182.x)) - ((_151 * frame_consts.game_plane_blend.y) * _185.x)) * frame_consts.paper_mult;
  float _209 = _15 / _16;
  float _221 = exp2(log2(saturate((frame_consts.params.vignette.intensity * abs(_25 + -0.5f)) * (((_209 + -1.0f) * frame_consts.params.vignette.rounded) + 1.0f))) * 5.0f);
  float _222 = exp2(log2(saturate(frame_consts.params.vignette.intensity * abs(_26 + -0.5f))) * 5.0f);
  float _228 = exp2(log2(saturate(1.0f - dot(float2(_221, _222), float2(_221, _222)))) * 6.0f);
  float _233 = 1.0f - _228;
  float _235 = 1.0f - (_233 * 0.8500000238418579f);
  float _242 = (_235 * ((_62 - (_194 * _62)) - frame_consts.params.vignette.color.x)) + frame_consts.params.vignette.color.x;
  float _243 = (_235 * ((_63 - (_194 * _63)) - frame_consts.params.vignette.color.y)) + frame_consts.params.vignette.color.y;
  float _244 = (_235 * ((_64 - (_194 * _64)) - frame_consts.params.vignette.color.z)) + frame_consts.params.vignette.color.z;
  float _248 = _25 * _15;
  float _249 = _26 * _16;
  float _250 = _249 + _248;
  float _256 = frac(_250 * 0.0033333334140479565f) + -0.5f;
  float _257 = frac((_249 - _248) * 0.0033333334140479565f) + -0.5f;
  float _263 = saturate(sqrt((_257 * _257) + (_256 * _256)) * 2.0f);
  float _274 = saturate((sin((_250 * 0.01666666753590107f) - (frame_consts.time * 0.8500000238418579f)) * 1.2500001192092896f) + -0.25000008940696716f);
  float _279 = ((_274 * _274) * 0.2199999988079071f) * (3.0f - (_274 * 2.0f));
  float _280 = _279 + 0.9777389168739319f;
  float _281 = ((_263 * 0.13274884223937988f) + 0.7175776362419128f) + _279;
  float _282 = ((_263 * 0.3335757553577423f) + 0.30871906876564026f) + _279;
  float _287 = (_25 * 1080.0f) * _209;
  float _288 = _26 * 1080.0f;
  float _289 = _287 * 0.04444444552063942f;
  float _290 = _26 * 27.712812423706055f;
  float _292 = ceil(_289 - _290);
  float _295 = floor(_26 * 55.42562484741211f) + 1.0f;
  float _298 = ceil((-0.0f - _290) - _289);
  float _300 = (_295 + _292) + _298;
  float _302 = (_300 * 22.5f) + -33.75f;
  float _303 = _292 - _298;
  float _305 = _303 * 11.25f;
  float _311 = (((_295 * 0.5773502588272095f) - (_292 * 0.28867512941360474f)) - (_298 * 0.28867512941360474f)) * 22.5f;
  float _314 = _302 + _305;
  float _315 = _311 + (19.485570907592773f - (_300 * 12.990381240844727f));
  float _318 = ((_300 * 25.980762481689453f) + -38.97114181518555f) + _311;
  float _319 = _305 - _302;
  float _320 = _314 - _287;
  float _321 = _315 - _288;
  float _324 = _305 - _287;
  float _325 = _318 - _288;
  float _330 = _321 * _321;
  float _337 = _319 - _287;
  float _341 = _315 * 2.5f;
  float _342 = frame_consts.time * 1.5f;
  float _346 = _315 * 0.004444444552063942f;
  float _347 = frame_consts.time * 0.15000000596046448f;
  float _348 = (_314 * 0.04444444552063942f) - _347;
  float _349 = _346 - _347;
  float _350 = frame_consts.time * 0.02500000037252903f;
  float _351 = dot(float3(_348, _349, _350), float3(0.3333333432674408f, 0.3333333432674408f, 0.3333333432674408f));
  float _355 = floor(_351 + _348);
  float _356 = floor(_351 + _349);
  float _357 = floor(_351 + _350);
  float _361 = dot(float3(_355, _356, _357), float3(0.1666666716337204f, 0.1666666716337204f, 0.1666666716337204f));
  float _362 = _361 + (_348 - _355);
  float _363 = _361 + (_349 - _356);
  float _364 = (_350 - _357) + _361;
  float _368 = select((_362 < _363), 0.0f, 1.0f);
  float _369 = select((_363 < _364), 0.0f, 1.0f);
  float _370 = select((_364 < _362), 0.0f, 1.0f);
  float _371 = 1.0f - _368;
  float _372 = 1.0f - _369;
  float _373 = 1.0f - _370;
  float _374 = min(_368, _373);
  float _375 = min(_369, _371);
  float _376 = min(_370, _372);
  float _377 = max(_368, _373);
  float _378 = max(_369, _371);
  float _379 = max(_370, _372);
  float _383 = (_362 - _374) + 0.1666666716337204f;
  float _384 = (_363 - _375) + 0.1666666716337204f;
  float _385 = (_364 - _376) + 0.1666666716337204f;
  float _389 = (_362 - _377) + 0.3333333432674408f;
  float _390 = (_363 - _378) + 0.3333333432674408f;
  float _391 = (_364 - _379) + 0.3333333432674408f;
  float _392 = _362 + -0.5f;
  float _393 = _363 + -0.5f;
  float _394 = _364 + -0.5f;
  float _404 = _355 - (floor(_355 * 0.0034602077212184668f) * 289.0f);
  float _405 = _356 - (floor(_356 * 0.0034602077212184668f) * 289.0f);
  float _406 = _357 - (floor(_357 * 0.0034602077212184668f) * 289.0f);
  float _407 = _406 + _376;
  float _408 = _406 + _379;
  float _409 = _406 + 1.0f;
  float _418 = ((_406 * 34.0f) + 1.0f) * _406;
  float _419 = ((_407 * 34.0f) + 1.0f) * _407;
  float _420 = ((_408 * 34.0f) + 1.0f) * _408;
  float _421 = ((_409 * 34.0f) + 1.0f) * _409;
  float _435 = (_418 - (floor(_418 * 0.0034602077212184668f) * 289.0f)) + _405;
  float _438 = ((_405 + _375) - (floor(_419 * 0.0034602077212184668f) * 289.0f)) + _419;
  float _441 = ((_405 + _378) - (floor(_420 * 0.0034602077212184668f) * 289.0f)) + _420;
  float _444 = ((_405 + 1.0f) - (floor(_421 * 0.0034602077212184668f) * 289.0f)) + _421;
  float _453 = ((_435 * 34.0f) + 1.0f) * _435;
  float _454 = ((_438 * 34.0f) + 1.0f) * _438;
  float _455 = ((_441 * 34.0f) + 1.0f) * _441;
  float _456 = ((_444 * 34.0f) + 1.0f) * _444;
  float _470 = (_453 - (floor(_453 * 0.0034602077212184668f) * 289.0f)) + _404;
  float _473 = ((_404 + _374) - (floor(_454 * 0.0034602077212184668f) * 289.0f)) + _454;
  float _476 = ((_404 + _377) - (floor(_455 * 0.0034602077212184668f) * 289.0f)) + _455;
  float _479 = ((_404 + 1.0f) - (floor(_456 * 0.0034602077212184668f) * 289.0f)) + _456;
  float _488 = ((_470 * 34.0f) + 1.0f) * _470;
  float _489 = ((_473 * 34.0f) + 1.0f) * _473;
  float _490 = ((_476 * 34.0f) + 1.0f) * _476;
  float _491 = ((_479 * 34.0f) + 1.0f) * _479;
  float _504 = _488 - (floor(_488 * 0.0034602077212184668f) * 289.0f);
  float _505 = _489 - (floor(_489 * 0.0034602077212184668f) * 289.0f);
  float _506 = _490 - (floor(_490 * 0.0034602077212184668f) * 289.0f);
  float _507 = _491 - (floor(_491 * 0.0034602077212184668f) * 289.0f);
  float _520 = _504 - (floor(_504 * 0.020408164709806442f) * 49.0f);
  float _521 = _505 - (floor(_505 * 0.020408164709806442f) * 49.0f);
  float _522 = _506 - (floor(_506 * 0.020408164709806442f) * 49.0f);
  float _523 = _507 - (floor(_507 * 0.020408164709806442f) * 49.0f);
  float _528 = floor(_520 * 0.1428571492433548f);
  float _529 = floor(_521 * 0.1428571492433548f);
  float _530 = floor(_522 * 0.1428571492433548f);
  float _531 = floor(_523 * 0.1428571492433548f);
  float _548 = (_528 * 0.2857142984867096f) + -0.9285714030265808f;
  float _549 = (_529 * 0.2857142984867096f) + -0.9285714030265808f;
  float _550 = (_530 * 0.2857142984867096f) + -0.9285714030265808f;
  float _551 = (_531 * 0.2857142984867096f) + -0.9285714030265808f;
  float _556 = (floor(_520 - (_528 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _557 = (floor(_521 - (_529 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _558 = (floor(_522 - (_530 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _559 = (floor(_523 - (_531 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _572 = (1.0f - abs(_548)) - abs(_556);
  float _573 = (1.0f - abs(_549)) - abs(_557);
  float _574 = (1.0f - abs(_550)) - abs(_558);
  float _575 = (1.0f - abs(_551)) - abs(_559);
  float _604 = select((_572 > 0.0f), -0.0f, -1.0f);
  float _605 = select((_573 > 0.0f), -0.0f, -1.0f);
  float _606 = select((_574 > 0.0f), -0.0f, -1.0f);
  float _607 = select((_575 > 0.0f), -0.0f, -1.0f);
  float _612 = (((floor(_548) * 2.0f) + 1.0f) * _604) + _548;
  float _613 = (((floor(_556) * 2.0f) + 1.0f) * _604) + _556;
  float _614 = (((floor(_549) * 2.0f) + 1.0f) * _605) + _549;
  float _615 = (((floor(_557) * 2.0f) + 1.0f) * _605) + _557;
  float _620 = (((floor(_550) * 2.0f) + 1.0f) * _606) + _550;
  float _621 = (((floor(_558) * 2.0f) + 1.0f) * _606) + _558;
  float _622 = (((floor(_551) * 2.0f) + 1.0f) * _607) + _551;
  float _623 = (((floor(_559) * 2.0f) + 1.0f) * _607) + _559;
  float _632 = 1.7928400039672852f - (dot(float3(_612, _613, _572), float3(_612, _613, _572)) * 0.8537350296974182f);
  float _633 = 1.7928400039672852f - (dot(float3(_614, _615, _573), float3(_614, _615, _573)) * 0.8537350296974182f);
  float _634 = 1.7928400039672852f - (dot(float3(_620, _621, _574), float3(_620, _621, _574)) * 0.8537350296974182f);
  float _635 = 1.7928400039672852f - (dot(float3(_622, _623, _575), float3(_622, _623, _575)) * 0.8537350296974182f);
  float _656 = max((0.6000000238418579f - dot(float3(_362, _363, _364), float3(_362, _363, _364))), 0.0f);
  float _657 = max((0.6000000238418579f - dot(float3(_383, _384, _385), float3(_383, _384, _385))), 0.0f);
  float _658 = max((0.6000000238418579f - dot(float3(_389, _390, _391), float3(_389, _390, _391))), 0.0f);
  float _659 = max((0.6000000238418579f - dot(float3(_392, _393, _394), float3(_392, _393, _394))), 0.0f);
  float _660 = _656 * _656;
  float _661 = _657 * _657;
  float _662 = _658 * _658;
  float _663 = _659 * _659;
  float _678 = saturate((((sin(_341 - _342) * 0.15000000596046448f) + 0.050000011920928955f) + (dot(float4((_660 * _660), (_661 * _661), (_662 * _662), (_663 * _663)), float4(dot(float3((_632 * _612), (_632 * _613), (_632 * _572)), float3(_362, _363, _364)), dot(float3((_633 * _614), (_633 * _615), (_633 * _573)), float3(_383, _384, _385)), dot(float3((_634 * _620), (_634 * _621), (_634 * _574)), float3(_389, _390, _391)), dot(float3((_635 * _622), (_635 * _623), (_635 * _575)), float3(_392, _393, _394)))) * 21.0f)) * 4.0f);
  float _682 = (_678 * _678) * (3.0f - (_678 * 2.0f));
  float _684 = (_682 * 0.6499999761581421f) + 0.3499999940395355f;
  float _689 = (_303 * 0.5f) - _347;
  float _690 = (_318 * 0.004444444552063942f) - _347;
  float _691 = dot(float3(_689, _690, _350), float3(0.3333333432674408f, 0.3333333432674408f, 0.3333333432674408f));
  float _695 = floor(_691 + _689);
  float _696 = floor(_691 + _690);
  float _697 = floor(_691 + _350);
  float _701 = dot(float3(_695, _696, _697), float3(0.1666666716337204f, 0.1666666716337204f, 0.1666666716337204f));
  float _702 = _701 + (_689 - _695);
  float _703 = _701 + (_690 - _696);
  float _704 = (_350 - _697) + _701;
  float _708 = select((_702 < _703), 0.0f, 1.0f);
  float _709 = select((_703 < _704), 0.0f, 1.0f);
  float _710 = select((_704 < _702), 0.0f, 1.0f);
  float _711 = 1.0f - _708;
  float _712 = 1.0f - _709;
  float _713 = 1.0f - _710;
  float _714 = min(_708, _713);
  float _715 = min(_709, _711);
  float _716 = min(_710, _712);
  float _717 = max(_708, _713);
  float _718 = max(_709, _711);
  float _719 = max(_710, _712);
  float _723 = (_702 - _714) + 0.1666666716337204f;
  float _724 = (_703 - _715) + 0.1666666716337204f;
  float _725 = (_704 - _716) + 0.1666666716337204f;
  float _729 = (_702 - _717) + 0.3333333432674408f;
  float _730 = (_703 - _718) + 0.3333333432674408f;
  float _731 = (_704 - _719) + 0.3333333432674408f;
  float _732 = _702 + -0.5f;
  float _733 = _703 + -0.5f;
  float _734 = _704 + -0.5f;
  float _744 = _695 - (floor(_695 * 0.0034602077212184668f) * 289.0f);
  float _745 = _696 - (floor(_696 * 0.0034602077212184668f) * 289.0f);
  float _746 = _697 - (floor(_697 * 0.0034602077212184668f) * 289.0f);
  float _747 = _746 + _716;
  float _748 = _746 + _719;
  float _749 = _746 + 1.0f;
  float _758 = ((_746 * 34.0f) + 1.0f) * _746;
  float _759 = ((_747 * 34.0f) + 1.0f) * _747;
  float _760 = ((_748 * 34.0f) + 1.0f) * _748;
  float _761 = ((_749 * 34.0f) + 1.0f) * _749;
  float _775 = (_758 - (floor(_758 * 0.0034602077212184668f) * 289.0f)) + _745;
  float _778 = ((_745 + _715) - (floor(_759 * 0.0034602077212184668f) * 289.0f)) + _759;
  float _781 = ((_745 + _718) - (floor(_760 * 0.0034602077212184668f) * 289.0f)) + _760;
  float _784 = ((_745 + 1.0f) - (floor(_761 * 0.0034602077212184668f) * 289.0f)) + _761;
  float _793 = ((_775 * 34.0f) + 1.0f) * _775;
  float _794 = ((_778 * 34.0f) + 1.0f) * _778;
  float _795 = ((_781 * 34.0f) + 1.0f) * _781;
  float _796 = ((_784 * 34.0f) + 1.0f) * _784;
  float _810 = (_793 - (floor(_793 * 0.0034602077212184668f) * 289.0f)) + _744;
  float _813 = ((_744 + _714) - (floor(_794 * 0.0034602077212184668f) * 289.0f)) + _794;
  float _816 = ((_744 + _717) - (floor(_795 * 0.0034602077212184668f) * 289.0f)) + _795;
  float _819 = ((_744 + 1.0f) - (floor(_796 * 0.0034602077212184668f) * 289.0f)) + _796;
  float _828 = ((_810 * 34.0f) + 1.0f) * _810;
  float _829 = ((_813 * 34.0f) + 1.0f) * _813;
  float _830 = ((_816 * 34.0f) + 1.0f) * _816;
  float _831 = ((_819 * 34.0f) + 1.0f) * _819;
  float _844 = _828 - (floor(_828 * 0.0034602077212184668f) * 289.0f);
  float _845 = _829 - (floor(_829 * 0.0034602077212184668f) * 289.0f);
  float _846 = _830 - (floor(_830 * 0.0034602077212184668f) * 289.0f);
  float _847 = _831 - (floor(_831 * 0.0034602077212184668f) * 289.0f);
  float _860 = _844 - (floor(_844 * 0.020408164709806442f) * 49.0f);
  float _861 = _845 - (floor(_845 * 0.020408164709806442f) * 49.0f);
  float _862 = _846 - (floor(_846 * 0.020408164709806442f) * 49.0f);
  float _863 = _847 - (floor(_847 * 0.020408164709806442f) * 49.0f);
  float _868 = floor(_860 * 0.1428571492433548f);
  float _869 = floor(_861 * 0.1428571492433548f);
  float _870 = floor(_862 * 0.1428571492433548f);
  float _871 = floor(_863 * 0.1428571492433548f);
  float _888 = (_868 * 0.2857142984867096f) + -0.9285714030265808f;
  float _889 = (_869 * 0.2857142984867096f) + -0.9285714030265808f;
  float _890 = (_870 * 0.2857142984867096f) + -0.9285714030265808f;
  float _891 = (_871 * 0.2857142984867096f) + -0.9285714030265808f;
  float _896 = (floor(_860 - (_868 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _897 = (floor(_861 - (_869 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _898 = (floor(_862 - (_870 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _899 = (floor(_863 - (_871 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _912 = (1.0f - abs(_888)) - abs(_896);
  float _913 = (1.0f - abs(_889)) - abs(_897);
  float _914 = (1.0f - abs(_890)) - abs(_898);
  float _915 = (1.0f - abs(_891)) - abs(_899);
  float _944 = select((_912 > 0.0f), -0.0f, -1.0f);
  float _945 = select((_913 > 0.0f), -0.0f, -1.0f);
  float _946 = select((_914 > 0.0f), -0.0f, -1.0f);
  float _947 = select((_915 > 0.0f), -0.0f, -1.0f);
  float _952 = (((floor(_888) * 2.0f) + 1.0f) * _944) + _888;
  float _953 = (((floor(_896) * 2.0f) + 1.0f) * _944) + _896;
  float _954 = (((floor(_889) * 2.0f) + 1.0f) * _945) + _889;
  float _955 = (((floor(_897) * 2.0f) + 1.0f) * _945) + _897;
  float _960 = (((floor(_890) * 2.0f) + 1.0f) * _946) + _890;
  float _961 = (((floor(_898) * 2.0f) + 1.0f) * _946) + _898;
  float _962 = (((floor(_891) * 2.0f) + 1.0f) * _947) + _891;
  float _963 = (((floor(_899) * 2.0f) + 1.0f) * _947) + _899;
  float _972 = 1.7928400039672852f - (dot(float3(_952, _953, _912), float3(_952, _953, _912)) * 0.8537350296974182f);
  float _973 = 1.7928400039672852f - (dot(float3(_954, _955, _913), float3(_954, _955, _913)) * 0.8537350296974182f);
  float _974 = 1.7928400039672852f - (dot(float3(_960, _961, _914), float3(_960, _961, _914)) * 0.8537350296974182f);
  float _975 = 1.7928400039672852f - (dot(float3(_962, _963, _915), float3(_962, _963, _915)) * 0.8537350296974182f);
  float _996 = max((0.6000000238418579f - dot(float3(_702, _703, _704), float3(_702, _703, _704))), 0.0f);
  float _997 = max((0.6000000238418579f - dot(float3(_723, _724, _725), float3(_723, _724, _725))), 0.0f);
  float _998 = max((0.6000000238418579f - dot(float3(_729, _730, _731), float3(_729, _730, _731))), 0.0f);
  float _999 = max((0.6000000238418579f - dot(float3(_732, _733, _734), float3(_732, _733, _734))), 0.0f);
  float _1000 = _996 * _996;
  float _1001 = _997 * _997;
  float _1002 = _998 * _998;
  float _1003 = _999 * _999;
  float _1018 = saturate((((sin((_318 * 2.5f) - _342) * 0.15000000596046448f) + 0.050000011920928955f) + (dot(float4((_1000 * _1000), (_1001 * _1001), (_1002 * _1002), (_1003 * _1003)), float4(dot(float3((_972 * _952), (_972 * _953), (_972 * _912)), float3(_702, _703, _704)), dot(float3((_973 * _954), (_973 * _955), (_973 * _913)), float3(_723, _724, _725)), dot(float3((_974 * _960), (_974 * _961), (_974 * _914)), float3(_729, _730, _731)), dot(float3((_975 * _962), (_975 * _963), (_975 * _915)), float3(_732, _733, _734)))) * 21.0f)) * 4.0f);
  float _1022 = (_1018 * _1018) * (3.0f - (_1018 * 2.0f));
  float _1024 = (_1022 * 0.6499999761581421f) + 0.3499999940395355f;
  float _1031 = frame_consts.time * 0.15000000596046448f;
  float _1032 = (_319 * 0.04444444552063942f) - _1031;
  float _1033 = _346 - _1031;
  float _1034 = frame_consts.time * 0.02500000037252903f;
  float _1035 = dot(float3(_1032, _1033, _1034), float3(0.3333333432674408f, 0.3333333432674408f, 0.3333333432674408f));
  float _1039 = floor(_1032 + _1035);
  float _1040 = floor(_1033 + _1035);
  float _1041 = floor(_1034 + _1035);
  float _1045 = dot(float3(_1039, _1040, _1041), float3(0.1666666716337204f, 0.1666666716337204f, 0.1666666716337204f));
  float _1046 = _1045 + (_1032 - _1039);
  float _1047 = _1045 + (_1033 - _1040);
  float _1048 = (_1034 - _1041) + _1045;
  float _1052 = select((_1046 < _1047), 0.0f, 1.0f);
  float _1053 = select((_1047 < _1048), 0.0f, 1.0f);
  float _1054 = select((_1048 < _1046), 0.0f, 1.0f);
  float _1055 = 1.0f - _1052;
  float _1056 = 1.0f - _1053;
  float _1057 = 1.0f - _1054;
  float _1058 = min(_1052, _1057);
  float _1059 = min(_1053, _1055);
  float _1060 = min(_1054, _1056);
  float _1061 = max(_1052, _1057);
  float _1062 = max(_1053, _1055);
  float _1063 = max(_1054, _1056);
  float _1067 = (_1046 - _1058) + 0.1666666716337204f;
  float _1068 = (_1047 - _1059) + 0.1666666716337204f;
  float _1069 = (_1048 - _1060) + 0.1666666716337204f;
  float _1073 = (_1046 - _1061) + 0.3333333432674408f;
  float _1074 = (_1047 - _1062) + 0.3333333432674408f;
  float _1075 = (_1048 - _1063) + 0.3333333432674408f;
  float _1076 = _1046 + -0.5f;
  float _1077 = _1047 + -0.5f;
  float _1078 = _1048 + -0.5f;
  float _1088 = _1039 - (floor(_1039 * 0.0034602077212184668f) * 289.0f);
  float _1089 = _1040 - (floor(_1040 * 0.0034602077212184668f) * 289.0f);
  float _1090 = _1041 - (floor(_1041 * 0.0034602077212184668f) * 289.0f);
  float _1091 = _1090 + _1060;
  float _1092 = _1090 + _1063;
  float _1093 = _1090 + 1.0f;
  float _1102 = ((_1090 * 34.0f) + 1.0f) * _1090;
  float _1103 = ((_1091 * 34.0f) + 1.0f) * _1091;
  float _1104 = ((_1092 * 34.0f) + 1.0f) * _1092;
  float _1105 = ((_1093 * 34.0f) + 1.0f) * _1093;
  float _1119 = (_1102 - (floor(_1102 * 0.0034602077212184668f) * 289.0f)) + _1089;
  float _1122 = ((_1089 + _1059) - (floor(_1103 * 0.0034602077212184668f) * 289.0f)) + _1103;
  float _1125 = ((_1089 + _1062) - (floor(_1104 * 0.0034602077212184668f) * 289.0f)) + _1104;
  float _1128 = ((_1089 + 1.0f) - (floor(_1105 * 0.0034602077212184668f) * 289.0f)) + _1105;
  float _1137 = ((_1119 * 34.0f) + 1.0f) * _1119;
  float _1138 = ((_1122 * 34.0f) + 1.0f) * _1122;
  float _1139 = ((_1125 * 34.0f) + 1.0f) * _1125;
  float _1140 = ((_1128 * 34.0f) + 1.0f) * _1128;
  float _1154 = (_1137 - (floor(_1137 * 0.0034602077212184668f) * 289.0f)) + _1088;
  float _1157 = ((_1088 + _1058) - (floor(_1138 * 0.0034602077212184668f) * 289.0f)) + _1138;
  float _1160 = ((_1088 + _1061) - (floor(_1139 * 0.0034602077212184668f) * 289.0f)) + _1139;
  float _1163 = ((_1088 + 1.0f) - (floor(_1140 * 0.0034602077212184668f) * 289.0f)) + _1140;
  float _1172 = ((_1154 * 34.0f) + 1.0f) * _1154;
  float _1173 = ((_1157 * 34.0f) + 1.0f) * _1157;
  float _1174 = ((_1160 * 34.0f) + 1.0f) * _1160;
  float _1175 = ((_1163 * 34.0f) + 1.0f) * _1163;
  float _1188 = _1172 - (floor(_1172 * 0.0034602077212184668f) * 289.0f);
  float _1189 = _1173 - (floor(_1173 * 0.0034602077212184668f) * 289.0f);
  float _1190 = _1174 - (floor(_1174 * 0.0034602077212184668f) * 289.0f);
  float _1191 = _1175 - (floor(_1175 * 0.0034602077212184668f) * 289.0f);
  float _1204 = _1188 - (floor(_1188 * 0.020408164709806442f) * 49.0f);
  float _1205 = _1189 - (floor(_1189 * 0.020408164709806442f) * 49.0f);
  float _1206 = _1190 - (floor(_1190 * 0.020408164709806442f) * 49.0f);
  float _1207 = _1191 - (floor(_1191 * 0.020408164709806442f) * 49.0f);
  float _1212 = floor(_1204 * 0.1428571492433548f);
  float _1213 = floor(_1205 * 0.1428571492433548f);
  float _1214 = floor(_1206 * 0.1428571492433548f);
  float _1215 = floor(_1207 * 0.1428571492433548f);
  float _1232 = (_1212 * 0.2857142984867096f) + -0.9285714030265808f;
  float _1233 = (_1213 * 0.2857142984867096f) + -0.9285714030265808f;
  float _1234 = (_1214 * 0.2857142984867096f) + -0.9285714030265808f;
  float _1235 = (_1215 * 0.2857142984867096f) + -0.9285714030265808f;
  float _1240 = (floor(_1204 - (_1212 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _1241 = (floor(_1205 - (_1213 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _1242 = (floor(_1206 - (_1214 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _1243 = (floor(_1207 - (_1215 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _1256 = (1.0f - abs(_1232)) - abs(_1240);
  float _1257 = (1.0f - abs(_1233)) - abs(_1241);
  float _1258 = (1.0f - abs(_1234)) - abs(_1242);
  float _1259 = (1.0f - abs(_1235)) - abs(_1243);
  float _1288 = select((_1256 > 0.0f), -0.0f, -1.0f);
  float _1289 = select((_1257 > 0.0f), -0.0f, -1.0f);
  float _1290 = select((_1258 > 0.0f), -0.0f, -1.0f);
  float _1291 = select((_1259 > 0.0f), -0.0f, -1.0f);
  float _1296 = (((floor(_1232) * 2.0f) + 1.0f) * _1288) + _1232;
  float _1297 = (((floor(_1240) * 2.0f) + 1.0f) * _1288) + _1240;
  float _1298 = (((floor(_1233) * 2.0f) + 1.0f) * _1289) + _1233;
  float _1299 = (((floor(_1241) * 2.0f) + 1.0f) * _1289) + _1241;
  float _1304 = (((floor(_1234) * 2.0f) + 1.0f) * _1290) + _1234;
  float _1305 = (((floor(_1242) * 2.0f) + 1.0f) * _1290) + _1242;
  float _1306 = (((floor(_1235) * 2.0f) + 1.0f) * _1291) + _1235;
  float _1307 = (((floor(_1243) * 2.0f) + 1.0f) * _1291) + _1243;
  float _1316 = 1.7928400039672852f - (dot(float3(_1296, _1297, _1256), float3(_1296, _1297, _1256)) * 0.8537350296974182f);
  float _1317 = 1.7928400039672852f - (dot(float3(_1298, _1299, _1257), float3(_1298, _1299, _1257)) * 0.8537350296974182f);
  float _1318 = 1.7928400039672852f - (dot(float3(_1304, _1305, _1258), float3(_1304, _1305, _1258)) * 0.8537350296974182f);
  float _1319 = 1.7928400039672852f - (dot(float3(_1306, _1307, _1259), float3(_1306, _1307, _1259)) * 0.8537350296974182f);
  float _1340 = max((0.6000000238418579f - dot(float3(_1046, _1047, _1048), float3(_1046, _1047, _1048))), 0.0f);
  float _1341 = max((0.6000000238418579f - dot(float3(_1067, _1068, _1069), float3(_1067, _1068, _1069))), 0.0f);
  float _1342 = max((0.6000000238418579f - dot(float3(_1073, _1074, _1075), float3(_1073, _1074, _1075))), 0.0f);
  float _1343 = max((0.6000000238418579f - dot(float3(_1076, _1077, _1078), float3(_1076, _1077, _1078))), 0.0f);
  float _1344 = _1340 * _1340;
  float _1345 = _1341 * _1341;
  float _1346 = _1342 * _1342;
  float _1347 = _1343 * _1343;
  float _1362 = saturate((((sin(_341 - (frame_consts.time * 1.5f)) * 0.15000000596046448f) + 0.050000011920928955f) + (dot(float4((_1344 * _1344), (_1345 * _1345), (_1346 * _1346), (_1347 * _1347)), float4(dot(float3((_1316 * _1296), (_1316 * _1297), (_1316 * _1256)), float3(_1046, _1047, _1048)), dot(float3((_1317 * _1298), (_1317 * _1299), (_1317 * _1257)), float3(_1067, _1068, _1069)), dot(float3((_1318 * _1304), (_1318 * _1305), (_1318 * _1258)), float3(_1073, _1074, _1075)), dot(float3((_1319 * _1306), (_1319 * _1307), (_1319 * _1259)), float3(_1076, _1077, _1078)))) * 21.0f)) * 4.0f);
  float _1366 = (_1362 * _1362) * (3.0f - (_1362 * 2.0f));
  float _1368 = (_1366 * 0.6499999761581421f) + 0.3499999940395355f;
  float _1390 = saturate(_684);
  float _1391 = saturate(_1024);
  float _1413 = (((_228 * 1.2000000476837158f) * _233) * frame_consts.params.vignette.golden_intensity) * ((((saturate(11.0f - (sqrt((_325 * _325) + (_324 * _324)) / ((_1022 * 0.039000000804662704f) + 0.08100000768899918f))) * _1024) + (saturate(11.0f - (sqrt((_320 * _320) + _330) / ((_682 * 0.039000000804662704f) + 0.08100000768899918f))) * _684)) + (saturate(11.0f - (sqrt((_337 * _337) + _330) / ((_1366 * 0.039000000804662704f) + 0.08100000768899918f))) * _1368)) + (((((saturate(1.0f - (abs(_321) * 0.8333333134651184f)) * _1390) + (saturate(1.0f - (abs(dot(float2(_324, _325), float2(-0.8660253882408142f, 0.5f))) * 0.8333333134651184f)) * _1391)) * saturate(_1368)) + ((_1390 * saturate(1.0f - (abs(dot(float2(_320, _321), float2(0.8660253882408142f, 0.5f))) * 0.8333333134651184f))) * _1391)) * 0.5f));
  SV_Target.x = ((_1413 * ((_280 * _280) - _242)) + _242);
  SV_Target.y = ((_1413 * ((_281 * _281) - _243)) + _243);
  SV_Target.z = ((_1413 * ((_282 * _282) - _244)) + _244);
  if (RENODX_TONE_MAP_TYPE) {
    SV_Target.rgb = renodx::draw::ToneMapPass(_27.rgb, SV_Target.rgb);
  } else {
    SV_Target.rgb = saturate(SV_Target.rgb);
  }
  SV_Target.rgb = renodx::draw::RenderIntermediatePass(SV_Target.rgb);

  SV_Target.w = 1.0f;
  return SV_Target;
}
