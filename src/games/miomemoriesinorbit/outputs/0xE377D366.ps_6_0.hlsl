#include "../shared.h"

struct Lod_params {
  struct Lod_brush_params {
    float4 brush_uv[4];
    float base_radius;
    float radius_variation;
    float radius_random;
    float blur;
    float alpha;
    float stretch;
  } brushes;
  struct Lod_noise_params {
    float chaos;
    float freq;
    float brightness;
    float saturation;
    float hue;
  } noise;
  struct Lod_outlines_params {
    float2 thickness;
    float2 softness;
    float2 displacement;
    float2 attenuation;
    float lighting_threshold;
    float lighting_threshold_softness;
    float2 lighting_dark;
    float2 lighting_bright;
    float2 discretion;
    float2 alpha;
  } outlines;
};

struct Frame_constants {
  float3 cam_world_pos;
  float time;
  float2 inv_near_dim;
  float proj_scale;
  uint flags;
  float2 half_vp_dim;
  int2 vp_dim;
  float2 vp_texel_size;
  int2 mouse_pos;
  int2 inspected_pix;
  int2 hi_z_0_dim;
  int supersampling;
  int debug_patches;
  int use_patches;
  int emissive;
  float3 target;
  uint frame_number;
  uint shot_frame_number;
  float dt;
  float4 view_to_world[4];
  float4 world_to_view[4];
  float4 view_ndc[4];
  float4 world_ndc[4];
  float4 prev_world_ndc[4];
  float4 ndc_world[4];
  float4 ndc_to_prev_ndc[4];
  float4 prev_ndc_to_ndc[4];
  float4 view_world_z0;
  float4 pix_to_fog_eq;
  float3 mio_view;
  float3 mio_hair_outline_color;
  float mio_foliage_velocity;
  int show_wireframe;
  int ao;
  int glitch;
  int no_vertex_color;
  float paper_mult;
  int hatching;
  int mio_halo;
  int vol_temporal;
  int heart_attack_active;
  int heart_attack_secondary_target;
  int triangular_dissolve_enabled;
  int color_correct;
  float starfield_effect_amount;
  float starfield_fade_amount;
  float3 starfield_center_view;
  float starfield_glow_amount;
  float starfield_pulse_t;
  float death_anim_t;
  float3 game_plane_world_origin;
  float3 game_plane_world_normal;
  float3 game_plane_world_u;
  float3 game_plane_world_v;
  float4 game_plane_transform[4];
  float4 hatching_xf[4];
  float4 paper_xf[4];
  float2 game_plane_blend;
  float heart_attack_t;
  float heart_attack_duration;
  float heart_attack_pulse;
  float heart_attack_outline_distance;
  float heart_attack_dissolve_distance;
  float3 heart_attack_dissolve_color;
  float heart_attack_dissolve_base;
  float heart_attack_dissolve_mult;
  float3 heart_attack_dissolve_world_center;
  float heart_attack_vertical_dissolve;
  float triangular_dissolve_base_amount;
  float triangular_dissolve_amount;
  float flashback_lut;
  float evil_mio;
  float dead_mio;
  float godlike_mio;
  float khlia_pulse_t;
  float khlia__pulse_t;
  float khlia_pulse_period;
  float3 khlia_world_pos;
  float skydome_rotation_offset;
  float hatch_ambiant_mul;
  float hatch_ambiant_add;
  float glitch_scale;
  uint max_contours;
  uint max_contour_loops;
  int death_screen;
  float death_screen_t;
  int poetic_death_screen;
  float poetic_death_screen_t;
  float tremor_pulse_t;
  int invert;
  float surface_fade;
  struct Postprocess_params {
    struct AO_params {
      float3 color;
      float intensity;
    } ao;
    struct Fog_params {
      float bloom_factor;
      float space;
      float outline_density;
      float outline_attenuation;
    } fog;
    struct Ambient_light_params {
      int undercoat_grad;
      float3 color;
      float intensity;
      float gameplay_intensity;
      float gameplay_width;
      float directional_intensity;
      float directional_shadows;
      float undercoat_noise_freq;
      float undercoat_noise_amplitude;
      float undercoat_noise_threshold;
      float undercoating;
    } ambient_light;
    struct Vignette_params {
      float intensity;
      float rounded;
      float3 color;
      float golden_intensity;
      float golden_color;
    } vignette;
    struct Bloom_params {
      float intensity;
      float threshold_low;
      float threshold_high;
    } bloom;
    struct Mio_params {
      float light_intensity;
      float light_radius;
      float3 light_color;
      float spec_intensity;
      float3 halo_color;
      float halo_intensity;
    } mio;
    struct Particles_params {
      uint count;
      float cam_near;
      float cam_far;
      float fadeoff_near;
      float2 lifetime;
      float fadein_duration;
      float fadeoff_duration;
      float2 alpha;
      float2 scale;
      float2 speed;
      int gradient;
      float circle_attenuation;
    } particles;
    struct Chroma_aberration_params {
      float intensity;
    } chroma_aberration;
    struct Fade_params {
      float intensity;
      float3 color;
    } fade;
    struct Dof_params {
      float plane_01;
      float plane_01_softness;
      float plane_12;
      float plane_12_softness;
      float foreground;
      float foreground_softness;
    } dof;
    Lod_params lod_foreground;
    Lod_params lod_game;
    Lod_params lod_midground;
    Lod_params lod_background;
  } params;
};


Texture2D<float4> tex : register(t0);

Texture2D<float> depth_tex : register(t1);

Texture2D<float> paper_tex : register(t5);

Texture2D<float3> bloom_tex : register(t7);

cbuffer frame_consts : register(b0) {
  Frame_constants frame_consts : packoffset(c000.x);
};

SamplerState sampler_nearest : register(s0);

SamplerState sampler_bilinear : register(s1);

SamplerState sampler_bilinear_wrap : register(s2);

float4 main(
  noperspective float4 SV_Position : SV_Position,
  linear float2 O_Uv : O_Uv
) : SV_Target {
  float4 SV_Target;
  float _14 = float((int)(frame_consts.vp_dim.x));
  float _15 = float((int)(frame_consts.vp_dim.y));
  float4 _16 = tex.SampleLevel(sampler_nearest, float2(O_Uv.x, O_Uv.y), 0.0f);
  float3 _20 = bloom_tex.SampleLevel(sampler_bilinear, float2(O_Uv.x, O_Uv.y), 0.0f);
  float _35 = max((((1.0f - (_16.y * 0.7152000069618225f)) - (_16.x * 0.2125999927520752f)) - (_16.z * 0.0722000002861023f)), 0.0010000000474974513f);
  float _39 = (_16.x / _35) + (frame_consts.params.bloom.intensity * _20.x);
  float _40 = (_16.y / _35) + (frame_consts.params.bloom.intensity * _20.y);
  float _41 = (_16.z / _35) + (frame_consts.params.bloom.intensity * _20.z);
  float _47 = (((_39 * 0.2125999927520752f) + 1.0f) + (_40 * 0.7152000069618225f)) + (_41 * 0.0722000002861023f);
  float _51 = saturate(_39 / _47);
  float _52 = saturate(_40 / _47);
  float _53 = saturate(_41 / _47);
  float _59 = depth_tex.SampleLevel(sampler_nearest, float2(O_Uv.x, O_Uv.y), 0.0f);
  float _63 = 10000.0f / ((_59.x * 19999.5f) + 0.5f);
  float _68 = (_63 * ((O_Uv.x * 2.0f) + -1.0f)) * frame_consts.inv_near_dim.x;
  float _70 = (_63 * (((1.0f - O_Uv.y) * 2.0f) + -1.0f)) * frame_consts.inv_near_dim.y;
  float _71 = -0.0f - _63;
  float _95 = mad((frame_consts.paper_xf[2].z), _71, mad((frame_consts.paper_xf[1].z), _70, (_68 * (frame_consts.paper_xf[0].z))));
  float _96 = mad((frame_consts.paper_xf[2].x), _71, mad((frame_consts.paper_xf[1].x), _70, (_68 * (frame_consts.paper_xf[0].x)))) / _95;
  float _97 = mad((frame_consts.paper_xf[2].y), _71, mad((frame_consts.paper_xf[1].y), _70, (_68 * (frame_consts.paper_xf[0].y)))) / _95;
  float _104 = log2(max(5.0f, (-0.0f - (_95 - frame_consts.game_plane_blend.x)))) * 10.0f;
  float _105 = floor(_104);
  float _106 = _104 - _105;
  float _108 = exp2(_105 * 0.10000000149011612f);
  float _109 = 1.0f / _108;
  float _110 = min(_109, 0.20000000298023224f);
  float _112 = min((_109 * 0.9330329895019531f), 0.20000000298023224f);
  float _113 = frame_consts.game_plane_blend.x - _108;
  float _119 = frame_consts.game_plane_blend.x - (_108 * 1.0717734098434448f);
  float _129 = paper_tex.SampleLevel(sampler_bilinear_wrap, float2((((_113 * _96) + (frame_consts.paper_xf[3].x)) * _110), (((_113 * _97) + (frame_consts.paper_xf[3].y)) * _110)), 0.0f);
  float _132 = paper_tex.SampleLevel(sampler_bilinear_wrap, float2((((_119 * _96) + (frame_consts.paper_xf[3].x)) * _112), (((_119 * _97) + (frame_consts.paper_xf[3].y)) * _112)), 0.0f);
  float _139 = ((1.0f - (_129.x * (1.0f - _106))) - (_132.x * _106)) * frame_consts.paper_mult;
  float _154 = _14 / _15;
  float _166 = exp2(log2(saturate((frame_consts.params.vignette.intensity * abs(O_Uv.x + -0.5f)) * (((_154 + -1.0f) * frame_consts.params.vignette.rounded) + 1.0f))) * 5.0f);
  float _167 = exp2(log2(saturate(frame_consts.params.vignette.intensity * abs(O_Uv.y + -0.5f))) * 5.0f);
  float _173 = exp2(log2(saturate(1.0f - dot(float2(_166, _167), float2(_166, _167)))) * 6.0f);
  float _178 = 1.0f - _173;
  float _180 = 1.0f - (_178 * 0.8500000238418579f);
  float _187 = (_180 * ((_51 - (_139 * _51)) - frame_consts.params.vignette.color.x)) + frame_consts.params.vignette.color.x;
  float _188 = (_180 * ((_52 - (_139 * _52)) - frame_consts.params.vignette.color.y)) + frame_consts.params.vignette.color.y;
  float _189 = (_180 * ((_53 - (_139 * _53)) - frame_consts.params.vignette.color.z)) + frame_consts.params.vignette.color.z;
  float _193 = _14 * O_Uv.x;
  float _194 = _15 * O_Uv.y;
  float _195 = _193 + _194;
  float _201 = frac(_195 * 0.0033333334140479565f) + -0.5f;
  float _202 = frac((_194 - _193) * 0.0033333334140479565f) + -0.5f;
  float _208 = saturate(sqrt((_202 * _202) + (_201 * _201)) * 2.0f);
  float _219 = saturate((sin((_195 * 0.01666666753590107f) - (frame_consts.time * 0.8500000238418579f)) * 1.2500001192092896f) + -0.25000008940696716f);
  float _224 = ((_219 * _219) * 0.2199999988079071f) * (3.0f - (_219 * 2.0f));
  float _225 = _224 + 0.9777389168739319f;
  float _226 = ((_208 * 0.13274884223937988f) + 0.7175776362419128f) + _224;
  float _227 = ((_208 * 0.3335757553577423f) + 0.30871906876564026f) + _224;
  float _232 = (O_Uv.x * 1080.0f) * _154;
  float _233 = O_Uv.y * 1080.0f;
  float _234 = _232 * 0.04444444552063942f;
  float _235 = O_Uv.y * 27.712812423706055f;
  float _237 = ceil(_234 - _235);
  float _240 = floor(O_Uv.y * 55.42562484741211f) + 1.0f;
  float _243 = ceil((-0.0f - _235) - _234);
  float _245 = (_240 + _237) + _243;
  float _247 = (_245 * 22.5f) + -33.75f;
  float _248 = _237 - _243;
  float _250 = _248 * 11.25f;
  float _256 = (((_240 * 0.5773502588272095f) - (_237 * 0.28867512941360474f)) - (_243 * 0.28867512941360474f)) * 22.5f;
  float _259 = _247 + _250;
  float _260 = _256 + (19.485570907592773f - (_245 * 12.990381240844727f));
  float _263 = ((_245 * 25.980762481689453f) + -38.97114181518555f) + _256;
  float _264 = _250 - _247;
  float _265 = _259 - _232;
  float _266 = _260 - _233;
  float _269 = _250 - _232;
  float _270 = _263 - _233;
  float _275 = _266 * _266;
  float _282 = _264 - _232;
  float _286 = _260 * 2.5f;
  float _287 = frame_consts.time * 1.5f;
  float _291 = _260 * 0.004444444552063942f;
  float _292 = frame_consts.time * 0.15000000596046448f;
  float _293 = (_259 * 0.04444444552063942f) - _292;
  float _294 = _291 - _292;
  float _295 = frame_consts.time * 0.02500000037252903f;
  float _296 = dot(float3(_293, _294, _295), float3(0.3333333432674408f, 0.3333333432674408f, 0.3333333432674408f));
  float _300 = floor(_296 + _293);
  float _301 = floor(_296 + _294);
  float _302 = floor(_296 + _295);
  float _306 = dot(float3(_300, _301, _302), float3(0.1666666716337204f, 0.1666666716337204f, 0.1666666716337204f));
  float _307 = _306 + (_293 - _300);
  float _308 = _306 + (_294 - _301);
  float _309 = (_295 - _302) + _306;
  float _313 = select((_307 < _308), 0.0f, 1.0f);
  float _314 = select((_308 < _309), 0.0f, 1.0f);
  float _315 = select((_309 < _307), 0.0f, 1.0f);
  float _316 = 1.0f - _313;
  float _317 = 1.0f - _314;
  float _318 = 1.0f - _315;
  float _319 = min(_313, _318);
  float _320 = min(_314, _316);
  float _321 = min(_315, _317);
  float _322 = max(_313, _318);
  float _323 = max(_314, _316);
  float _324 = max(_315, _317);
  float _328 = (_307 - _319) + 0.1666666716337204f;
  float _329 = (_308 - _320) + 0.1666666716337204f;
  float _330 = (_309 - _321) + 0.1666666716337204f;
  float _334 = (_307 - _322) + 0.3333333432674408f;
  float _335 = (_308 - _323) + 0.3333333432674408f;
  float _336 = (_309 - _324) + 0.3333333432674408f;
  float _337 = _307 + -0.5f;
  float _338 = _308 + -0.5f;
  float _339 = _309 + -0.5f;
  float _349 = _300 - (floor(_300 * 0.0034602077212184668f) * 289.0f);
  float _350 = _301 - (floor(_301 * 0.0034602077212184668f) * 289.0f);
  float _351 = _302 - (floor(_302 * 0.0034602077212184668f) * 289.0f);
  float _352 = _351 + _321;
  float _353 = _351 + _324;
  float _354 = _351 + 1.0f;
  float _363 = ((_351 * 34.0f) + 1.0f) * _351;
  float _364 = ((_352 * 34.0f) + 1.0f) * _352;
  float _365 = ((_353 * 34.0f) + 1.0f) * _353;
  float _366 = ((_354 * 34.0f) + 1.0f) * _354;
  float _380 = (_363 - (floor(_363 * 0.0034602077212184668f) * 289.0f)) + _350;
  float _383 = ((_350 + _320) - (floor(_364 * 0.0034602077212184668f) * 289.0f)) + _364;
  float _386 = ((_350 + _323) - (floor(_365 * 0.0034602077212184668f) * 289.0f)) + _365;
  float _389 = ((_350 + 1.0f) - (floor(_366 * 0.0034602077212184668f) * 289.0f)) + _366;
  float _398 = ((_380 * 34.0f) + 1.0f) * _380;
  float _399 = ((_383 * 34.0f) + 1.0f) * _383;
  float _400 = ((_386 * 34.0f) + 1.0f) * _386;
  float _401 = ((_389 * 34.0f) + 1.0f) * _389;
  float _415 = (_398 - (floor(_398 * 0.0034602077212184668f) * 289.0f)) + _349;
  float _418 = ((_349 + _319) - (floor(_399 * 0.0034602077212184668f) * 289.0f)) + _399;
  float _421 = ((_349 + _322) - (floor(_400 * 0.0034602077212184668f) * 289.0f)) + _400;
  float _424 = ((_349 + 1.0f) - (floor(_401 * 0.0034602077212184668f) * 289.0f)) + _401;
  float _433 = ((_415 * 34.0f) + 1.0f) * _415;
  float _434 = ((_418 * 34.0f) + 1.0f) * _418;
  float _435 = ((_421 * 34.0f) + 1.0f) * _421;
  float _436 = ((_424 * 34.0f) + 1.0f) * _424;
  float _449 = _433 - (floor(_433 * 0.0034602077212184668f) * 289.0f);
  float _450 = _434 - (floor(_434 * 0.0034602077212184668f) * 289.0f);
  float _451 = _435 - (floor(_435 * 0.0034602077212184668f) * 289.0f);
  float _452 = _436 - (floor(_436 * 0.0034602077212184668f) * 289.0f);
  float _465 = _449 - (floor(_449 * 0.020408164709806442f) * 49.0f);
  float _466 = _450 - (floor(_450 * 0.020408164709806442f) * 49.0f);
  float _467 = _451 - (floor(_451 * 0.020408164709806442f) * 49.0f);
  float _468 = _452 - (floor(_452 * 0.020408164709806442f) * 49.0f);
  float _473 = floor(_465 * 0.1428571492433548f);
  float _474 = floor(_466 * 0.1428571492433548f);
  float _475 = floor(_467 * 0.1428571492433548f);
  float _476 = floor(_468 * 0.1428571492433548f);
  float _493 = (_473 * 0.2857142984867096f) + -0.9285714030265808f;
  float _494 = (_474 * 0.2857142984867096f) + -0.9285714030265808f;
  float _495 = (_475 * 0.2857142984867096f) + -0.9285714030265808f;
  float _496 = (_476 * 0.2857142984867096f) + -0.9285714030265808f;
  float _501 = (floor(_465 - (_473 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _502 = (floor(_466 - (_474 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _503 = (floor(_467 - (_475 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _504 = (floor(_468 - (_476 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _517 = (1.0f - abs(_493)) - abs(_501);
  float _518 = (1.0f - abs(_494)) - abs(_502);
  float _519 = (1.0f - abs(_495)) - abs(_503);
  float _520 = (1.0f - abs(_496)) - abs(_504);
  float _549 = select((_517 > 0.0f), -0.0f, -1.0f);
  float _550 = select((_518 > 0.0f), -0.0f, -1.0f);
  float _551 = select((_519 > 0.0f), -0.0f, -1.0f);
  float _552 = select((_520 > 0.0f), -0.0f, -1.0f);
  float _557 = (((floor(_493) * 2.0f) + 1.0f) * _549) + _493;
  float _558 = (((floor(_501) * 2.0f) + 1.0f) * _549) + _501;
  float _559 = (((floor(_494) * 2.0f) + 1.0f) * _550) + _494;
  float _560 = (((floor(_502) * 2.0f) + 1.0f) * _550) + _502;
  float _565 = (((floor(_495) * 2.0f) + 1.0f) * _551) + _495;
  float _566 = (((floor(_503) * 2.0f) + 1.0f) * _551) + _503;
  float _567 = (((floor(_496) * 2.0f) + 1.0f) * _552) + _496;
  float _568 = (((floor(_504) * 2.0f) + 1.0f) * _552) + _504;
  float _577 = 1.7928400039672852f - (dot(float3(_557, _558, _517), float3(_557, _558, _517)) * 0.8537350296974182f);
  float _578 = 1.7928400039672852f - (dot(float3(_559, _560, _518), float3(_559, _560, _518)) * 0.8537350296974182f);
  float _579 = 1.7928400039672852f - (dot(float3(_565, _566, _519), float3(_565, _566, _519)) * 0.8537350296974182f);
  float _580 = 1.7928400039672852f - (dot(float3(_567, _568, _520), float3(_567, _568, _520)) * 0.8537350296974182f);
  float _601 = max((0.6000000238418579f - dot(float3(_307, _308, _309), float3(_307, _308, _309))), 0.0f);
  float _602 = max((0.6000000238418579f - dot(float3(_328, _329, _330), float3(_328, _329, _330))), 0.0f);
  float _603 = max((0.6000000238418579f - dot(float3(_334, _335, _336), float3(_334, _335, _336))), 0.0f);
  float _604 = max((0.6000000238418579f - dot(float3(_337, _338, _339), float3(_337, _338, _339))), 0.0f);
  float _605 = _601 * _601;
  float _606 = _602 * _602;
  float _607 = _603 * _603;
  float _608 = _604 * _604;
  float _623 = saturate((((sin(_286 - _287) * 0.15000000596046448f) + 0.050000011920928955f) + (dot(float4((_605 * _605), (_606 * _606), (_607 * _607), (_608 * _608)), float4(dot(float3((_577 * _557), (_577 * _558), (_577 * _517)), float3(_307, _308, _309)), dot(float3((_578 * _559), (_578 * _560), (_578 * _518)), float3(_328, _329, _330)), dot(float3((_579 * _565), (_579 * _566), (_579 * _519)), float3(_334, _335, _336)), dot(float3((_580 * _567), (_580 * _568), (_580 * _520)), float3(_337, _338, _339)))) * 21.0f)) * 4.0f);
  float _627 = (_623 * _623) * (3.0f - (_623 * 2.0f));
  float _629 = (_627 * 0.6499999761581421f) + 0.3499999940395355f;
  float _634 = (_248 * 0.5f) - _292;
  float _635 = (_263 * 0.004444444552063942f) - _292;
  float _636 = dot(float3(_634, _635, _295), float3(0.3333333432674408f, 0.3333333432674408f, 0.3333333432674408f));
  float _640 = floor(_636 + _634);
  float _641 = floor(_636 + _635);
  float _642 = floor(_636 + _295);
  float _646 = dot(float3(_640, _641, _642), float3(0.1666666716337204f, 0.1666666716337204f, 0.1666666716337204f));
  float _647 = _646 + (_634 - _640);
  float _648 = _646 + (_635 - _641);
  float _649 = (_295 - _642) + _646;
  float _653 = select((_647 < _648), 0.0f, 1.0f);
  float _654 = select((_648 < _649), 0.0f, 1.0f);
  float _655 = select((_649 < _647), 0.0f, 1.0f);
  float _656 = 1.0f - _653;
  float _657 = 1.0f - _654;
  float _658 = 1.0f - _655;
  float _659 = min(_653, _658);
  float _660 = min(_654, _656);
  float _661 = min(_655, _657);
  float _662 = max(_653, _658);
  float _663 = max(_654, _656);
  float _664 = max(_655, _657);
  float _668 = (_647 - _659) + 0.1666666716337204f;
  float _669 = (_648 - _660) + 0.1666666716337204f;
  float _670 = (_649 - _661) + 0.1666666716337204f;
  float _674 = (_647 - _662) + 0.3333333432674408f;
  float _675 = (_648 - _663) + 0.3333333432674408f;
  float _676 = (_649 - _664) + 0.3333333432674408f;
  float _677 = _647 + -0.5f;
  float _678 = _648 + -0.5f;
  float _679 = _649 + -0.5f;
  float _689 = _640 - (floor(_640 * 0.0034602077212184668f) * 289.0f);
  float _690 = _641 - (floor(_641 * 0.0034602077212184668f) * 289.0f);
  float _691 = _642 - (floor(_642 * 0.0034602077212184668f) * 289.0f);
  float _692 = _691 + _661;
  float _693 = _691 + _664;
  float _694 = _691 + 1.0f;
  float _703 = ((_691 * 34.0f) + 1.0f) * _691;
  float _704 = ((_692 * 34.0f) + 1.0f) * _692;
  float _705 = ((_693 * 34.0f) + 1.0f) * _693;
  float _706 = ((_694 * 34.0f) + 1.0f) * _694;
  float _720 = (_703 - (floor(_703 * 0.0034602077212184668f) * 289.0f)) + _690;
  float _723 = ((_690 + _660) - (floor(_704 * 0.0034602077212184668f) * 289.0f)) + _704;
  float _726 = ((_690 + _663) - (floor(_705 * 0.0034602077212184668f) * 289.0f)) + _705;
  float _729 = ((_690 + 1.0f) - (floor(_706 * 0.0034602077212184668f) * 289.0f)) + _706;
  float _738 = ((_720 * 34.0f) + 1.0f) * _720;
  float _739 = ((_723 * 34.0f) + 1.0f) * _723;
  float _740 = ((_726 * 34.0f) + 1.0f) * _726;
  float _741 = ((_729 * 34.0f) + 1.0f) * _729;
  float _755 = (_738 - (floor(_738 * 0.0034602077212184668f) * 289.0f)) + _689;
  float _758 = ((_689 + _659) - (floor(_739 * 0.0034602077212184668f) * 289.0f)) + _739;
  float _761 = ((_689 + _662) - (floor(_740 * 0.0034602077212184668f) * 289.0f)) + _740;
  float _764 = ((_689 + 1.0f) - (floor(_741 * 0.0034602077212184668f) * 289.0f)) + _741;
  float _773 = ((_755 * 34.0f) + 1.0f) * _755;
  float _774 = ((_758 * 34.0f) + 1.0f) * _758;
  float _775 = ((_761 * 34.0f) + 1.0f) * _761;
  float _776 = ((_764 * 34.0f) + 1.0f) * _764;
  float _789 = _773 - (floor(_773 * 0.0034602077212184668f) * 289.0f);
  float _790 = _774 - (floor(_774 * 0.0034602077212184668f) * 289.0f);
  float _791 = _775 - (floor(_775 * 0.0034602077212184668f) * 289.0f);
  float _792 = _776 - (floor(_776 * 0.0034602077212184668f) * 289.0f);
  float _805 = _789 - (floor(_789 * 0.020408164709806442f) * 49.0f);
  float _806 = _790 - (floor(_790 * 0.020408164709806442f) * 49.0f);
  float _807 = _791 - (floor(_791 * 0.020408164709806442f) * 49.0f);
  float _808 = _792 - (floor(_792 * 0.020408164709806442f) * 49.0f);
  float _813 = floor(_805 * 0.1428571492433548f);
  float _814 = floor(_806 * 0.1428571492433548f);
  float _815 = floor(_807 * 0.1428571492433548f);
  float _816 = floor(_808 * 0.1428571492433548f);
  float _833 = (_813 * 0.2857142984867096f) + -0.9285714030265808f;
  float _834 = (_814 * 0.2857142984867096f) + -0.9285714030265808f;
  float _835 = (_815 * 0.2857142984867096f) + -0.9285714030265808f;
  float _836 = (_816 * 0.2857142984867096f) + -0.9285714030265808f;
  float _841 = (floor(_805 - (_813 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _842 = (floor(_806 - (_814 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _843 = (floor(_807 - (_815 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _844 = (floor(_808 - (_816 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _857 = (1.0f - abs(_833)) - abs(_841);
  float _858 = (1.0f - abs(_834)) - abs(_842);
  float _859 = (1.0f - abs(_835)) - abs(_843);
  float _860 = (1.0f - abs(_836)) - abs(_844);
  float _889 = select((_857 > 0.0f), -0.0f, -1.0f);
  float _890 = select((_858 > 0.0f), -0.0f, -1.0f);
  float _891 = select((_859 > 0.0f), -0.0f, -1.0f);
  float _892 = select((_860 > 0.0f), -0.0f, -1.0f);
  float _897 = (((floor(_833) * 2.0f) + 1.0f) * _889) + _833;
  float _898 = (((floor(_841) * 2.0f) + 1.0f) * _889) + _841;
  float _899 = (((floor(_834) * 2.0f) + 1.0f) * _890) + _834;
  float _900 = (((floor(_842) * 2.0f) + 1.0f) * _890) + _842;
  float _905 = (((floor(_835) * 2.0f) + 1.0f) * _891) + _835;
  float _906 = (((floor(_843) * 2.0f) + 1.0f) * _891) + _843;
  float _907 = (((floor(_836) * 2.0f) + 1.0f) * _892) + _836;
  float _908 = (((floor(_844) * 2.0f) + 1.0f) * _892) + _844;
  float _917 = 1.7928400039672852f - (dot(float3(_897, _898, _857), float3(_897, _898, _857)) * 0.8537350296974182f);
  float _918 = 1.7928400039672852f - (dot(float3(_899, _900, _858), float3(_899, _900, _858)) * 0.8537350296974182f);
  float _919 = 1.7928400039672852f - (dot(float3(_905, _906, _859), float3(_905, _906, _859)) * 0.8537350296974182f);
  float _920 = 1.7928400039672852f - (dot(float3(_907, _908, _860), float3(_907, _908, _860)) * 0.8537350296974182f);
  float _941 = max((0.6000000238418579f - dot(float3(_647, _648, _649), float3(_647, _648, _649))), 0.0f);
  float _942 = max((0.6000000238418579f - dot(float3(_668, _669, _670), float3(_668, _669, _670))), 0.0f);
  float _943 = max((0.6000000238418579f - dot(float3(_674, _675, _676), float3(_674, _675, _676))), 0.0f);
  float _944 = max((0.6000000238418579f - dot(float3(_677, _678, _679), float3(_677, _678, _679))), 0.0f);
  float _945 = _941 * _941;
  float _946 = _942 * _942;
  float _947 = _943 * _943;
  float _948 = _944 * _944;
  float _963 = saturate((((sin((_263 * 2.5f) - _287) * 0.15000000596046448f) + 0.050000011920928955f) + (dot(float4((_945 * _945), (_946 * _946), (_947 * _947), (_948 * _948)), float4(dot(float3((_917 * _897), (_917 * _898), (_917 * _857)), float3(_647, _648, _649)), dot(float3((_918 * _899), (_918 * _900), (_918 * _858)), float3(_668, _669, _670)), dot(float3((_919 * _905), (_919 * _906), (_919 * _859)), float3(_674, _675, _676)), dot(float3((_920 * _907), (_920 * _908), (_920 * _860)), float3(_677, _678, _679)))) * 21.0f)) * 4.0f);
  float _967 = (_963 * _963) * (3.0f - (_963 * 2.0f));
  float _969 = (_967 * 0.6499999761581421f) + 0.3499999940395355f;
  float _976 = frame_consts.time * 0.15000000596046448f;
  float _977 = (_264 * 0.04444444552063942f) - _976;
  float _978 = _291 - _976;
  float _979 = frame_consts.time * 0.02500000037252903f;
  float _980 = dot(float3(_977, _978, _979), float3(0.3333333432674408f, 0.3333333432674408f, 0.3333333432674408f));
  float _984 = floor(_977 + _980);
  float _985 = floor(_978 + _980);
  float _986 = floor(_979 + _980);
  float _990 = dot(float3(_984, _985, _986), float3(0.1666666716337204f, 0.1666666716337204f, 0.1666666716337204f));
  float _991 = _990 + (_977 - _984);
  float _992 = _990 + (_978 - _985);
  float _993 = (_979 - _986) + _990;
  float _997 = select((_991 < _992), 0.0f, 1.0f);
  float _998 = select((_992 < _993), 0.0f, 1.0f);
  float _999 = select((_993 < _991), 0.0f, 1.0f);
  float _1000 = 1.0f - _997;
  float _1001 = 1.0f - _998;
  float _1002 = 1.0f - _999;
  float _1003 = min(_997, _1002);
  float _1004 = min(_998, _1000);
  float _1005 = min(_999, _1001);
  float _1006 = max(_997, _1002);
  float _1007 = max(_998, _1000);
  float _1008 = max(_999, _1001);
  float _1012 = (_991 - _1003) + 0.1666666716337204f;
  float _1013 = (_992 - _1004) + 0.1666666716337204f;
  float _1014 = (_993 - _1005) + 0.1666666716337204f;
  float _1018 = (_991 - _1006) + 0.3333333432674408f;
  float _1019 = (_992 - _1007) + 0.3333333432674408f;
  float _1020 = (_993 - _1008) + 0.3333333432674408f;
  float _1021 = _991 + -0.5f;
  float _1022 = _992 + -0.5f;
  float _1023 = _993 + -0.5f;
  float _1033 = _984 - (floor(_984 * 0.0034602077212184668f) * 289.0f);
  float _1034 = _985 - (floor(_985 * 0.0034602077212184668f) * 289.0f);
  float _1035 = _986 - (floor(_986 * 0.0034602077212184668f) * 289.0f);
  float _1036 = _1035 + _1005;
  float _1037 = _1035 + _1008;
  float _1038 = _1035 + 1.0f;
  float _1047 = ((_1035 * 34.0f) + 1.0f) * _1035;
  float _1048 = ((_1036 * 34.0f) + 1.0f) * _1036;
  float _1049 = ((_1037 * 34.0f) + 1.0f) * _1037;
  float _1050 = ((_1038 * 34.0f) + 1.0f) * _1038;
  float _1064 = (_1047 - (floor(_1047 * 0.0034602077212184668f) * 289.0f)) + _1034;
  float _1067 = ((_1034 + _1004) - (floor(_1048 * 0.0034602077212184668f) * 289.0f)) + _1048;
  float _1070 = ((_1034 + _1007) - (floor(_1049 * 0.0034602077212184668f) * 289.0f)) + _1049;
  float _1073 = ((_1034 + 1.0f) - (floor(_1050 * 0.0034602077212184668f) * 289.0f)) + _1050;
  float _1082 = ((_1064 * 34.0f) + 1.0f) * _1064;
  float _1083 = ((_1067 * 34.0f) + 1.0f) * _1067;
  float _1084 = ((_1070 * 34.0f) + 1.0f) * _1070;
  float _1085 = ((_1073 * 34.0f) + 1.0f) * _1073;
  float _1099 = (_1082 - (floor(_1082 * 0.0034602077212184668f) * 289.0f)) + _1033;
  float _1102 = ((_1033 + _1003) - (floor(_1083 * 0.0034602077212184668f) * 289.0f)) + _1083;
  float _1105 = ((_1033 + _1006) - (floor(_1084 * 0.0034602077212184668f) * 289.0f)) + _1084;
  float _1108 = ((_1033 + 1.0f) - (floor(_1085 * 0.0034602077212184668f) * 289.0f)) + _1085;
  float _1117 = ((_1099 * 34.0f) + 1.0f) * _1099;
  float _1118 = ((_1102 * 34.0f) + 1.0f) * _1102;
  float _1119 = ((_1105 * 34.0f) + 1.0f) * _1105;
  float _1120 = ((_1108 * 34.0f) + 1.0f) * _1108;
  float _1133 = _1117 - (floor(_1117 * 0.0034602077212184668f) * 289.0f);
  float _1134 = _1118 - (floor(_1118 * 0.0034602077212184668f) * 289.0f);
  float _1135 = _1119 - (floor(_1119 * 0.0034602077212184668f) * 289.0f);
  float _1136 = _1120 - (floor(_1120 * 0.0034602077212184668f) * 289.0f);
  float _1149 = _1133 - (floor(_1133 * 0.020408164709806442f) * 49.0f);
  float _1150 = _1134 - (floor(_1134 * 0.020408164709806442f) * 49.0f);
  float _1151 = _1135 - (floor(_1135 * 0.020408164709806442f) * 49.0f);
  float _1152 = _1136 - (floor(_1136 * 0.020408164709806442f) * 49.0f);
  float _1157 = floor(_1149 * 0.1428571492433548f);
  float _1158 = floor(_1150 * 0.1428571492433548f);
  float _1159 = floor(_1151 * 0.1428571492433548f);
  float _1160 = floor(_1152 * 0.1428571492433548f);
  float _1177 = (_1157 * 0.2857142984867096f) + -0.9285714030265808f;
  float _1178 = (_1158 * 0.2857142984867096f) + -0.9285714030265808f;
  float _1179 = (_1159 * 0.2857142984867096f) + -0.9285714030265808f;
  float _1180 = (_1160 * 0.2857142984867096f) + -0.9285714030265808f;
  float _1185 = (floor(_1149 - (_1157 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _1186 = (floor(_1150 - (_1158 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _1187 = (floor(_1151 - (_1159 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _1188 = (floor(_1152 - (_1160 * 7.0f)) * 0.2857142984867096f) + -0.9285714030265808f;
  float _1201 = (1.0f - abs(_1177)) - abs(_1185);
  float _1202 = (1.0f - abs(_1178)) - abs(_1186);
  float _1203 = (1.0f - abs(_1179)) - abs(_1187);
  float _1204 = (1.0f - abs(_1180)) - abs(_1188);
  float _1233 = select((_1201 > 0.0f), -0.0f, -1.0f);
  float _1234 = select((_1202 > 0.0f), -0.0f, -1.0f);
  float _1235 = select((_1203 > 0.0f), -0.0f, -1.0f);
  float _1236 = select((_1204 > 0.0f), -0.0f, -1.0f);
  float _1241 = (((floor(_1177) * 2.0f) + 1.0f) * _1233) + _1177;
  float _1242 = (((floor(_1185) * 2.0f) + 1.0f) * _1233) + _1185;
  float _1243 = (((floor(_1178) * 2.0f) + 1.0f) * _1234) + _1178;
  float _1244 = (((floor(_1186) * 2.0f) + 1.0f) * _1234) + _1186;
  float _1249 = (((floor(_1179) * 2.0f) + 1.0f) * _1235) + _1179;
  float _1250 = (((floor(_1187) * 2.0f) + 1.0f) * _1235) + _1187;
  float _1251 = (((floor(_1180) * 2.0f) + 1.0f) * _1236) + _1180;
  float _1252 = (((floor(_1188) * 2.0f) + 1.0f) * _1236) + _1188;
  float _1261 = 1.7928400039672852f - (dot(float3(_1241, _1242, _1201), float3(_1241, _1242, _1201)) * 0.8537350296974182f);
  float _1262 = 1.7928400039672852f - (dot(float3(_1243, _1244, _1202), float3(_1243, _1244, _1202)) * 0.8537350296974182f);
  float _1263 = 1.7928400039672852f - (dot(float3(_1249, _1250, _1203), float3(_1249, _1250, _1203)) * 0.8537350296974182f);
  float _1264 = 1.7928400039672852f - (dot(float3(_1251, _1252, _1204), float3(_1251, _1252, _1204)) * 0.8537350296974182f);
  float _1285 = max((0.6000000238418579f - dot(float3(_991, _992, _993), float3(_991, _992, _993))), 0.0f);
  float _1286 = max((0.6000000238418579f - dot(float3(_1012, _1013, _1014), float3(_1012, _1013, _1014))), 0.0f);
  float _1287 = max((0.6000000238418579f - dot(float3(_1018, _1019, _1020), float3(_1018, _1019, _1020))), 0.0f);
  float _1288 = max((0.6000000238418579f - dot(float3(_1021, _1022, _1023), float3(_1021, _1022, _1023))), 0.0f);
  float _1289 = _1285 * _1285;
  float _1290 = _1286 * _1286;
  float _1291 = _1287 * _1287;
  float _1292 = _1288 * _1288;
  float _1307 = saturate((((sin(_286 - (frame_consts.time * 1.5f)) * 0.15000000596046448f) + 0.050000011920928955f) + (dot(float4((_1289 * _1289), (_1290 * _1290), (_1291 * _1291), (_1292 * _1292)), float4(dot(float3((_1261 * _1241), (_1261 * _1242), (_1261 * _1201)), float3(_991, _992, _993)), dot(float3((_1262 * _1243), (_1262 * _1244), (_1262 * _1202)), float3(_1012, _1013, _1014)), dot(float3((_1263 * _1249), (_1263 * _1250), (_1263 * _1203)), float3(_1018, _1019, _1020)), dot(float3((_1264 * _1251), (_1264 * _1252), (_1264 * _1204)), float3(_1021, _1022, _1023)))) * 21.0f)) * 4.0f);
  float _1311 = (_1307 * _1307) * (3.0f - (_1307 * 2.0f));
  float _1313 = (_1311 * 0.6499999761581421f) + 0.3499999940395355f;
  float _1335 = saturate(_629);
  float _1336 = saturate(_969);
  float _1358 = (((_173 * 1.2000000476837158f) * _178) * frame_consts.params.vignette.golden_intensity) * ((((saturate(11.0f - (sqrt((_270 * _270) + (_269 * _269)) / ((_967 * 0.039000000804662704f) + 0.08100000768899918f))) * _969) + (saturate(11.0f - (sqrt((_265 * _265) + _275) / ((_627 * 0.039000000804662704f) + 0.08100000768899918f))) * _629)) + (saturate(11.0f - (sqrt((_282 * _282) + _275) / ((_1311 * 0.039000000804662704f) + 0.08100000768899918f))) * _1313)) + (((((saturate(1.0f - (abs(_266) * 0.8333333134651184f)) * _1335) + (saturate(1.0f - (abs(dot(float2(_269, _270), float2(-0.8660253882408142f, 0.5f))) * 0.8333333134651184f)) * _1336)) * saturate(_1313)) + ((_1335 * saturate(1.0f - (abs(dot(float2(_265, _266), float2(0.8660253882408142f, 0.5f))) * 0.8333333134651184f))) * _1336)) * 0.5f));
  SV_Target.x = ((_1358 * ((_225 * _225) - _187)) + _187);
  SV_Target.y = ((_1358 * ((_226 * _226) - _188)) + _188);
  SV_Target.z = ((_1358 * ((_227 * _227) - _189)) + _189);
  if (RENODX_TONE_MAP_TYPE) {
    SV_Target.rgb = renodx::draw::ToneMapPass(_16.rgb, SV_Target.rgb);
  } else {
    SV_Target.rgb = saturate(SV_Target.rgb);
  }
  SV_Target.rgb = renodx::draw::RenderIntermediatePass(SV_Target.rgb);

  SV_Target.w = 1.0f;
  return SV_Target;
}
